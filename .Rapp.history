ntipisout <- list()#
for(i in 1:1000){#
	nmaanss <- maanss[,sample(1:ncol(maanss),repl=F)]#
	ntipisout[[i]] <-  tipxout(nmaanss,subbalphy,hier.phy)#
}#
reord <- lapply(1:ncol(tipisout), function(prd) sapply(1:length(ntipisout), function(n) ntipisout[[n]][,prd]) )#
#
int <- sapply(1:ncol(tipisout), function(p) sapply(1:nrow(tipisout),function(T) findInterval(tipisout[T,p],sort(reord[[p]][T,]) ,left.open=T )/length(reord[[p]][T,]) ) )
head(int)
tail(int)
rotodfpn <- int >= 0.95
head(rotodfpn)
sum(rotodfpn)
416/(614*16)
rotodfpn <- int >= 0.9
sum(rotodfpn)
845/(614*16)
dim(tipisout)
0.05*(614*16)
rotodfpn <- int >= 0.975
sum(rotodfpn)
0.025*(614*16)
0.025*(614*16)rotodfpn <- int >= 0.95
rotodfpn <- int >= 0.95
reorderTO <- tipisout[,c(1,9,2,10,3,11,4,12,5,13,6,14,7,15,8,16)] #first is salt then without salt#
row.names(reorderTO)<- hier.phy3$tip.label#
reorderTOpn <- tipisoutpernode[,c(1,9,2,10,3,11,4,12,5,13,6,14,7,15,8,16)]#
row.names(reorderTOpn)<- hier.phy3$tip.label#
rotodf <- as.data.frame(reorderTO)#
rotodfpn <- as.data.frame(reorderTOpn)#
transfnames <- c("BZT","gly.BZT","BZTa+aa","aniline","amino3ph","phenanzine","mBZT","moxyBZT")#
colnames(rotodf) <- c("BZT"," ","gly.BZT"," ","BZTa+aa"," ","aniline","aniline","amino3ph"," ","phenanzine"," ","mBZT"," ","moxyBZT"," ")#
colnames(rotodfpn) <- c("BZT"," ","gly.BZT"," ","BZTa+aa"," ","aniline","aniline","amino3ph"," ","phenanzine"," ","mBZT"," ","moxyBZT"," ")
gtree <- ggtree(hier.phynodenams,ladderize=F,color="gray") + geom_hilight(data=filldat, mapping=aes(node=id, fill=type,extend=5),show.legend=FALSE)  + geom_nodelab()#
p <- gtree + new_scale_fill()#
p1 <- gheatmap(p, rotodfpn[,c(3:4)],  high=rgb(1,0,0),low="gray",offset=0, width=.1,#)#. , #,#
              colnames_angle=90, colnames_offset_y = 17)#
p2 <-gheatmap(p1, rotodfpn[,c(5:6)], offset=0.075, width=.1,#
         colnames_angle=90, colnames_offset_y = 20 ,  high=rgb(0.75,0,0),low="gray",legend_title="interval") #
p3 <- p2 + new_scale_fill()#
p3 <-gheatmap(p3, rotodfpn[,c(13:14)], offset=0.15, width=.1,#
         colnames_angle=90, colnames_offset_y = 13)#
p4 <-gheatmap(p3, rotodfpn[,c(15:16)], offset=0.225, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0.75,0,0.75),low="gray",legend_title="interval") #
p5 <- p4 + new_scale_fill()#
p5 <- gheatmap(p5, rotodfpn[,c(9:10)], offset=0.30, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0,0,1),low="gray") #
p6 <- gheatmap(p5, rotodfpn[,c(11:12)], offset=0.375, width=.1,#
         colnames_angle=90, colnames_offset_y = 25,  high=rgb(0,0,0.75),low="gray",legend_title="interval")
head(rotodfpn)
tipisoutpernode <- int >= 0.95#
#
#transformation products balance analysis#
# mixAAsaltcor <- sapply(1:nrow(mixAAsalt), function(z) cor(mixAAsalt[z,],t(subbalphy)))#
# colnames(mixAAsaltcor) <- colnames(mixAA)#
# mixAAnosaltcor <- sapply(1:nrow(mixAAnosalt), function(z) cor(mixAAnosalt[z,],t(subbalphy)))#
# colnames(mixAAnosaltcor) <- colnames(mixAA)#
# togmixAAcor <- cbind(mixAAsaltcor,mixAAnosaltcor)#
# row.names(togmixAAcor) <- row.names(subbalphy)#
# #
#
# togmixAAcor <- sapply(1:nrow(maanss), function(z) cor(maanss[z,],t(subbalphy)) )#
# colnames(togmixAAcor) <- c( colnames(mixAA), paste(colnames(mixAA),"_S",sep="")  )#
# row.names(togmixAAcor) <- row.names(subbalphy)#
# #
# balphycorprods99 <- lapply(1:ncol(togmixAAcor), function(corcol) #
# 						which(abs(togmixAAcor[,corcol])>quantile(abs(togmixAAcor[,corcol]),0.95)))#
# balphycorprods99tips <- lapply(1:ncol(togmixAAcor), function(corcol) #
# 							lapply(names(balphycorprods99[[corcol]]), #
# 								function(name) Descendants(hier.phy,node=614+ which(hier.phy$node.label==name),type="tips") ))#
# plotnodebalcorprods99 <- lapply(balphycorprods99, function(corlist) #
# 		sapply(names(corlist) , function(z) which(hier.phy$node.label==z)+614)	)#
# nodeindexbalcorprods99 <- lapply(plotnodebalcorprods99,names)#
# # transfnodelabs <- lapply(1:6, function(l) sapply(nodeindexbalcorprods99[[l]], function(z) which(hier.phy$node.label==z)) )#
# baltreeorder <- sapply(1:613, function(z) which(rownames(subbalphy)==hier.phy$node.label[z]))#
# nodesout <- sapply(1:ncol(togmixAAcor), function(z)  abs(togmixAAcor[,z]) > quantile(abs(togmixAAcor[,z]),0.95)) #
# #how often is a taxa in #
# tipsout <- lapply(1:ncol(nodesout), function(z) sapply(row.names(togmixAAcor)[which(nodesout[,z])],#
# 										 function(name)  Descendants(hier.phy, node=614+ which(hier.phy$node.label==name),type="tips" ) )  )#
# tipisout <- sapply(1:length(tipsout), function(l) sapply(1:614, function(T) sum(unlist(tipsout[[l]]) ==T) ) )#
# tipisoutpernode <- tipisout/sapply(1:614,function(z) length(Ancestors(hier.phy,z)))#
#
reorderTO <- tipisout[,c(1,9,2,10,3,11,4,12,5,13,6,14,7,15,8,16)] #first is salt then without salt#
row.names(reorderTO)<- hier.phy3$tip.label#
reorderTOpn <- tipisoutpernode[,c(1,9,2,10,3,11,4,12,5,13,6,14,7,15,8,16)]#
row.names(reorderTOpn)<- hier.phy3$tip.label#
rotodf <- as.data.frame(reorderTO)#
rotodfpn <- as.data.frame(reorderTOpn)#
transfnames <- c("BZT","gly.BZT","BZTa+aa","aniline","amino3ph","phenanzine","mBZT","moxyBZT")#
colnames(rotodf) <- c("BZT"," ","gly.BZT"," ","BZTa+aa"," ","aniline","aniline","amino3ph"," ","phenanzine"," ","mBZT"," ","moxyBZT"," ")#
colnames(rotodfpn) <- c("BZT"," ","gly.BZT"," ","BZTa+aa"," ","aniline","aniline","amino3ph"," ","phenanzine"," ","mBZT"," ","moxyBZT"," ")
head(rotodfpn)
gtree <- ggtree(hier.phynodenams,ladderize=F,color="gray") + geom_hilight(data=filldat, mapping=aes(node=id, fill=type,extend=5),show.legend=FALSE)  + geom_nodelab()#
p <- gtree + new_scale_fill()#
p1 <- gheatmap(p, rotodfpn[,c(3:4)],  high=rgb(1,0,0),low="gray",offset=0, width=.1,#)#. , #,#
              colnames_angle=90, colnames_offset_y = 17)#
p2 <-gheatmap(p1, rotodfpn[,c(5:6)], offset=0.075, width=.1,#
         colnames_angle=90, colnames_offset_y = 20 ,  high=rgb(0.75,0,0),low="gray",legend_title="interval") #
p3 <- p2 + new_scale_fill()#
p3 <-gheatmap(p3, rotodfpn[,c(13:14)], offset=0.15, width=.1,#
         colnames_angle=90, colnames_offset_y = 13)#
p4 <-gheatmap(p3, rotodfpn[,c(15:16)], offset=0.225, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0.75,0,0.75),low="gray",legend_title="interval") #
p5 <- p4 + new_scale_fill()#
p5 <- gheatmap(p5, rotodfpn[,c(9:10)], offset=0.30, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0,0,1),low="gray") #
p6 <- gheatmap(p5, rotodfpn[,c(11:12)], offset=0.375, width=.1,#
         colnames_angle=90, colnames_offset_y = 25,  high=rgb(0,0,0.75),low="gray",legend_title="interval")
p6
tipisoutpernode <- as.numric(int >= 0.95)
tipisoutpernode <- as.numeric(int >= 0.95)
reorderTO <- tipisout[,c(1,9,2,10,3,11,4,12,5,13,6,14,7,15,8,16)] #first is salt then without salt#
row.names(reorderTO)<- hier.phy3$tip.label#
reorderTOpn <- tipisoutpernode[,c(1,9,2,10,3,11,4,12,5,13,6,14,7,15,8,16)]#
row.names(reorderTOpn)<- hier.phy3$tip.label#
rotodf <- as.data.frame(reorderTO)#
rotodfpn <- as.data.frame(reorderTOpn)#
transfnames <- c("BZT","gly.BZT","BZTa+aa","aniline","amino3ph","phenanzine","mBZT","moxyBZT")#
colnames(rotodf) <- c("BZT"," ","gly.BZT"," ","BZTa+aa"," ","aniline","aniline","amino3ph"," ","phenanzine"," ","mBZT"," ","moxyBZT"," ")#
colnames(rotodfpn) <- c("BZT"," ","gly.BZT"," ","BZTa+aa"," ","aniline","aniline","amino3ph"," ","phenanzine"," ","mBZT"," ","moxyBZT"," ")
head(tipisoutpernode)
tipisoutpernode <- int
reorderTO <- tipisout[,c(1,9,2,10,3,11,4,12,5,13,6,14,7,15,8,16)] #first is salt then without salt#
row.names(reorderTO)<- hier.phy3$tip.label#
reorderTOpn <- tipisoutpernode[,c(1,9,2,10,3,11,4,12,5,13,6,14,7,15,8,16)]#
row.names(reorderTOpn)<- hier.phy3$tip.label#
rotodf <- as.data.frame(reorderTO)#
rotodfpn <- as.data.frame(reorderTOpn)#
transfnames <- c("BZT","gly.BZT","BZTa+aa","aniline","amino3ph","phenanzine","mBZT","moxyBZT")#
colnames(rotodf) <- c("BZT"," ","gly.BZT"," ","BZTa+aa"," ","aniline","aniline","amino3ph"," ","phenanzine"," ","mBZT"," ","moxyBZT"," ")#
colnames(rotodfpn) <- c("BZT"," ","gly.BZT"," ","BZTa+aa"," ","aniline","aniline","amino3ph"," ","phenanzine"," ","mBZT"," ","moxyBZT"," ")
gtree <- ggtree(hier.phynodenams,ladderize=F,color="gray") + geom_hilight(data=filldat, mapping=aes(node=id, fill=type,extend=5),show.legend=FALSE)  + geom_nodelab()#
p <- gtree + new_scale_fill()#
p1 <- gheatmap(p, rotodfpn[,c(3:4)],  high=rgb(1,0,0),low="gray",offset=0, width=.1,#)#. , #,#
              colnames_angle=90, colnames_offset_y = 17)#
p2 <-gheatmap(p1, rotodfpn[,c(5:6)], offset=0.075, width=.1,#
         colnames_angle=90, colnames_offset_y = 20 ,  high=rgb(0.75,0,0),low="gray",legend_title="interval") #
p3 <- p2 + new_scale_fill()#
p3 <-gheatmap(p3, rotodfpn[,c(13:14)], offset=0.15, width=.1,#
         colnames_angle=90, colnames_offset_y = 13)#
p4 <-gheatmap(p3, rotodfpn[,c(15:16)], offset=0.225, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0.75,0,0.75),low="gray",legend_title="interval") #
p5 <- p4 + new_scale_fill()#
p5 <- gheatmap(p5, rotodfpn[,c(9:10)], offset=0.30, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0,0,1),low="gray") #
p6 <- gheatmap(p5, rotodfpn[,c(11:12)], offset=0.375, width=.1,#
         colnames_angle=90, colnames_offset_y = 25,  high=rgb(0,0,0.75),low="gray",legend_title="interval") #
p6
tipisoutpernode <- int#
tipisoutpernode [tipisoutpernode<0.95] <- 0
head(tipisoutpernode)
reorderTO <- tipisout[,c(1,9,2,10,3,11,4,12,5,13,6,14,7,15,8,16)] #first is salt then without salt#
row.names(reorderTO)<- hier.phy3$tip.label#
reorderTOpn <- tipisoutpernode[,c(1,9,2,10,3,11,4,12,5,13,6,14,7,15,8,16)]#
row.names(reorderTOpn)<- hier.phy3$tip.label#
rotodf <- as.data.frame(reorderTO)#
rotodfpn <- as.data.frame(reorderTOpn)#
transfnames <- c("BZT","gly.BZT","BZTa+aa","aniline","amino3ph","phenanzine","mBZT","moxyBZT")#
colnames(rotodf) <- c("BZT"," ","gly.BZT"," ","BZTa+aa"," ","aniline","aniline","amino3ph"," ","phenanzine"," ","mBZT"," ","moxyBZT"," ")#
colnames(rotodfpn) <- c("BZT"," ","gly.BZT"," ","BZTa+aa"," ","aniline","aniline","amino3ph"," ","phenanzine"," ","mBZT"," ","moxyBZT"," ")
gtree <- ggtree(hier.phynodenams,ladderize=F,color="gray") + geom_hilight(data=filldat, mapping=aes(node=id, fill=type,extend=5),show.legend=FALSE)  + geom_nodelab()#
p <- gtree + new_scale_fill()#
p1 <- gheatmap(p, rotodfpn[,c(3:4)],  high=rgb(1,0,0),low="gray",offset=0, width=.1,#)#. , #,#
              colnames_angle=90, colnames_offset_y = 17)#
p2 <-gheatmap(p1, rotodfpn[,c(5:6)], offset=0.075, width=.1,#
         colnames_angle=90, colnames_offset_y = 20 ,  high=rgb(0.75,0,0),low="gray",legend_title="interval") #
p3 <- p2 + new_scale_fill()#
p3 <-gheatmap(p3, rotodfpn[,c(13:14)], offset=0.15, width=.1,#
         colnames_angle=90, colnames_offset_y = 13)#
p4 <-gheatmap(p3, rotodfpn[,c(15:16)], offset=0.225, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0.75,0,0.75),low="gray",legend_title="interval") #
p5 <- p4 + new_scale_fill()#
p5 <- gheatmap(p5, rotodfpn[,c(9:10)], offset=0.30, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0,0,1),low="gray") #
p6 <- gheatmap(p5, rotodfpn[,c(11:12)], offset=0.375, width=.1,#
         colnames_angle=90, colnames_offset_y = 25,  high=rgb(0,0,0.75),low="gray",legend_title="interval") #
p6
pdf("~/testggtreeheatv3.pdf",width=8,height=10)#
# gtree <- ggtree(hier.phy3,ladderize=F) #,yscale=c(0,615))#
# gtree <- ggtree(treegroup3,ladderize=F, aes(color=group)) + #,layout="circular") #,yscale=c(0,615))#
# 		scale_color_manual(values=c("black", rgb(1,0,0), rgb(1,0.5,0), rgb(0.75,0.75,0), rgb(0.5,1,0),  rgb(0,0.75,0), rgb(0,1,1) , rgb(0,0,1), rgb(0.25,0,0.75),rgb(1,0,1), rgb(0.5,0,0.5) )) +#
# gtree <- ggtree(hier.phy3,ladderize=F) #,layout="circular") #,yscale=c(0,615))#
# gtree <- ggtree(hier.phynodenams,ladderize=F) + geom_nodelab()#
gtree <- ggtree(hier.phynodenams,ladderize=F,color="gray") + geom_hilight(data=filldat, mapping=aes(node=id, fill=type,extend=5),show.legend=FALSE)  + geom_nodelab()#
p <- gtree + new_scale_fill()#
p1 <- gheatmap(p, rotodf[,c(3:4)],  high=rgb(1,0,0),low="gray",offset=0, width=.1,#)#. , #,#
              colnames_angle=90, colnames_offset_y = 17)#
p2 <-gheatmap(p1, rotodf[,c(5:6)], offset=0.075, width=.1,#
         colnames_angle=90, colnames_offset_y = 20 ,  high=rgb(0.75,0,0),low="gray",legend_title="times outlier") #
p3 <- p2 + new_scale_fill()#
p3 <-gheatmap(p3, rotodf[,c(13:14)], offset=0.15, width=.1,#
         colnames_angle=90, colnames_offset_y = 13)#
p4 <-gheatmap(p3, rotodf[,c(15:16)], offset=0.225, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0.75,0,0.75),low="gray",legend_title="times outlier") #
p5 <- p4 + new_scale_fill()#
p5 <- gheatmap(p5, rotodf[,c(9:10)], offset=0.30, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0,0,1),low="gray") #
p6 <- gheatmap(p5, rotodf[,c(11:12)], offset=0.375, width=.1,#
         colnames_angle=90, colnames_offset_y = 25,  high=rgb(0,0,0.75),low="gray",legend_title="times outlier") #
p6#
dev.off()
pdf("~/testggtreeheatv3interval.pdf",width=8,height=10)#
gtree <- ggtree(hier.phynodenams,ladderize=F,color="gray") + geom_hilight(data=filldat, mapping=aes(node=id, fill=type,extend=5),show.legend=FALSE)  + geom_nodelab()#
p <- gtree + new_scale_fill()#
p1 <- gheatmap(p, rotodfpn[,c(3:4)],  high=rgb(1,0,0),low="gray",offset=0, width=.1,#)#. , #,#
              colnames_angle=90, colnames_offset_y = 17)#
p2 <-gheatmap(p1, rotodfpn[,c(5:6)], offset=0.075, width=.1,#
         colnames_angle=90, colnames_offset_y = 20 ,  high=rgb(0.75,0,0),low="gray",legend_title="interval") #
p3 <- p2 + new_scale_fill()#
p3 <-gheatmap(p3, rotodfpn[,c(13:14)], offset=0.15, width=.1,#
         colnames_angle=90, colnames_offset_y = 13)#
p4 <-gheatmap(p3, rotodfpn[,c(15:16)], offset=0.225, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0.75,0,0.75),low="gray",legend_title="interval") #
p5 <- p4 + new_scale_fill()#
p5 <- gheatmap(p5, rotodfpn[,c(9:10)], offset=0.30, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0,0,1),low="gray") #
p6 <- gheatmap(p5, rotodfpn[,c(11:12)], offset=0.375, width=.1,#
         colnames_angle=90, colnames_offset_y = 25,  high=rgb(0,0,0.75),low="gray",legend_title="interval") #
p6#
dev.off()
str(biogenotrt)
head(biogenotrt)
head(biodat)
write.csv(biodat,"~/Dropbox/salt BT round 2/biodat",row.names=F)
dim(biodat)
head(biodat)
biodat <- read.csv("~/Dropbox/salt BT round 2/biodat",header=T)
dim(biodat)
head(biodat)
head(genoslptrtnm)
genoslptrtnm <- t(sapply(1:length(unique(biodat$genotype)), function(geno) tapply(#
		slopes[ biodat$genotype == sort(unique(biodat$genotype))[geno] ],paste( biodat$BZT,biodat$Salt )[biodat$genotype == sort(unique(biodat$genotype))[geno] ],mean )
))
slopes <- sapply(1:nrow(biodat), function(z) lm(unlist(biodat[z,9:14])~as.vector(c(0,2,4,6,8,10)))$coef[2] )#
genoslptrtnm <- t(sapply(1:length(unique(biodat$genotype)), function(geno) tapply(#
		slopes[ biodat$genotype == sort(unique(biodat$genotype))[geno] ],paste( biodat$BZT,biodat$Salt )[biodat$genotype == sort(unique(biodat$genotype))[geno] ],mean )#
	)) #the genotype mean is probably still useful for plotting, because there are too many individuals?
head(genoslptrtnm)
head(biodat)
head(transf)
strsplit(biodat$plate[1],"[.]")
strsplit(biodat$plate[1],"[.]")[[1]][1]
arabicplate <- as.numeric(sapply(1:nrow(biodat), function(z) strsplit(biodat$plate[z],"[.]")[[1]][1]))#
splitpair <- sapply(1:nrow(biodat), function(z) strsplit(biodat$plate[z],"[.]")[[1]][2]) #
arabicpair <- ifelse(splitpair=="I",1,2)#
same_sampleid2 <- paste(arabicplate,arabicpair,paste(biodat$row,biodat$col,sep=""),sep=".")
length(sampe_sampleid)
length(same_sampleid)
length(same_sampleid2)
sum(same_sampleid2==same_sampleid)
head(same_sampleid2)
head(same_sampleid)
same_sampleid2 <- paste(arabicplate,arabicpair,paste(biodat$row,biodat$column,sep=""),sep=".")
sum(same_sampleid2==same_sampleid)
length(c(9:16,18:28,42))
dim(biogenotrt)
160/20
biogeno4corM <- t(biogenotrt[c(42,44,46,50,74,76,78,80,52,48,54,56),])
head(biogeno4corM)
colnames(biogeno4corM) <- c("F10.00","F10.0S","F10.B0","F10.BS","epix.00","epix.0S","epix.B0","epix.BS","od600.00","od600.0S","od600.B0","od600.BS")
###microbes and plant growth & balances analysis#
biogeno4corM <- t(biogenotrt[c(42,44,46,50,74,76,78,80,52,48,54,56),])#
colnames(biogeno4corM) <- c("F10.00","F10.0S","F10.B0","F10.BS","epix.00","epix.0S","epix.B0","epix.BS","od600.00","od600.0S","od600.B0","od600.BS")#
#
tipisoutbio <- tipxout(biogeno4corM,subbalphy,hier.phy)
dim(biogeno4corM)
dim(maanss)
dim(subbalphy)
dim(balphy)
biogeno4corM <- (biogenotrt[c(42,44,46,50,74,76,78,80,52,48,54,56),])#
row.names(biogeno4corM) <- c("F10.00","F10.0S","F10.B0","F10.BS","epix.00","epix.0S","epix.B0","epix.BS","od600.00","od600.0S","od600.B0","od600.BS")
dim(biogeno4corM)
head(biogeno4corM)
dim(bal.phy)
dim(biogeno4corM)
dim(subbalphy)
dim(maanss)
tipisoutbio <- tipxout(biogeno4corM,bal.phy,hier.phy)
head(tipisoutbio)
nBtipisout <- list()#
for(i in 1:1000){#
	nbiogeno4corM <- biogeno4corM[,sample(1:ncol(biogeno4corM),repl=F)]#
	nBtipisout[[i]] <-  tipxout(nbiogeno4corM,bal.phy,hier.phy)#
}#
Breord <- lapply(1:ncol(nBtipisout), function(prd) sapply(1:length(nBtipisout), function(n) nBtipisout[[n]][,prd]) )#
#
Bint <- sapply(1:ncol(tipisoutbio), function(p) sapply(1:nrow(tipisoutbio),function(T) findInterval(tipisoutbio[T,p],sort(Breord[[p]][T,]) ,left.open=T )/length(Breord[[p]][T,]) ) )#
Btipisoutpernode <- Bint#
Btipisoutpernode [Btipisoutpernode<0.95] <- 0
layout(matrix(1:4,ncol=2,byrow=T))#
par(mar=c(2,2,2,1))#
par(oma=c(2,2,1,1))#
	plot(subbzswM[lower.tri(subbzswM)], as.vector(distProdGenoTrtnSnM),ylab="",xlab="",ylim=c(0,0.18),xlim=c(0.0,0.8))#
		mtext("0 Salt, Microbes -",side=3,line=0.25)#
		text(0.3,0.17 ,paste("r=",round(cor(subbzswM[lower.tri(subbzswM)], as.vector(distProdGenoTrtnSnM)) ,digits=2 ) ,sep=""))#
	plot(subbzswM[lower.tri(subbzswM)], as.vector(distProdGenoTrtnSyM),ylab="",xlab="",ylim=c(0,0.18),xlim=c(0,0.8))#
		mtext("0 Salt, Microbes +",side=3,line=0.25)#
		text(0.3,0.17 ,paste("r=",round(  cor(subbzswM[lower.tri(subbzswM)], as.vector(distProdGenoTrtnSyM))    ,digits=2 ) ,sep=""))#
	plot(subbzswM[lower.tri(subbzswM)], as.vector(distProdGenoTrtySnM),ylab="",xlab="",ylim=c(0,0.18),xlim=c(0,0.8))#
		mtext("0.8 g/L Salt, Microbes -",side=3,line=0.25)#
		mtext("Genotype euclidean distance of Products",side=2,adj=-0.25,line=2)#
		text(0.3,0.17 ,paste("r=",round(  cor(subbzswM[lower.tri(subbzswM)], as.vector(distProdGenoTrtySnM))   ,digits=2 ) ,sep=""))#
	plot(subbzswM[lower.tri(subbzswM)], as.vector(distProdGenoTrtySyM),ylab="",xlab="",ylim=c(0,0.18),xlim=c(0,0.8))#
		mtext("Weighted Unifrac Distance of genotypes",side=1,adj=1.5,line=2)#
		mtext("0.8 g/L Salt, Microbes +",side=3,line=0.25)#
		text(0.3,0.17 ,paste("r=",round(  cor(subbzswM[lower.tri(subbzswM)], as.vector(distProdGenoTrtySyM))  ,digits=2 ) ,sep=""))
str(nBtipisout)
Breord <- lapply(1:ncol(nBtipisout), function(prd) sapply(1:length(nBtipisout), function(n) nBtipisout[[n]][,prd]) )
Breord <- lapply(1:ncol(tipisoutbio), function(prd) sapply(1:length(nBtipisout), function(n) nBtipisout[[n]][,prd]) )
Bint <- sapply(1:ncol(tipisoutbio), function(p) sapply(1:nrow(tipisoutbio),function(T) findInterval(tipisoutbio[T,p],sort(Breord[[p]][T,]) ,left.open=T )/length(Breord[[p]][T,]) ) )#
Btipisoutpernode <- Bint#
Btipisoutpernode [Btipisoutpernode<0.95] <- 0
gtree <- ggtree(hier.phynodenams,ladderize=F,color="gray") + geom_hilight(data=filldat, mapping=aes(node=id, fill=type,extend=5),show.legend=FALSE)  + geom_nodelab()#
p <- gtree + new_scale_fill()#
p1 <- gheatmap(p, biotodfpn[,c(1:4)],  high=rgb(1,0,0),low="gray",offset=0, width=.1,#)#. , #,#
              colnames_angle=90, colnames_offset_y = 17)#
p2 <-gheatmap(p1, biotodfpn[,c(5:8)], offset=0.075, width=.1,#
         colnames_angle=90, colnames_offset_y = 20 ,  high=rgb(0.75,0,0),low="gray",legend_title="times outlier") #
p3 <- p2 + new_scale_fill()#
p3 <-gheatmap(p3, biotodfpn[,c(9:12)], offset=0.15, width=.1,#
         colnames_angle=90, colnames_offset_y = 20, high=rgb(0,0,1),low="gray",legend_title="times outlier")#
p3
row.names(tipisoutbio)<- hier.phy3$tip.label#
row.names(Btipisoutpernode)<- hier.phy3$tip.label#
biotodf <- as.data.frame(tipisoutbio)#
biotodfpn <- as.data.frame(Btipisoutpernode)#
colnames(biotodf) <-  c("F10"," ","F10BZT","  ","epix"," ","epixBZT","  ","od600"," ","od600BZT","  ")#
colnames(biotodfpn) <- c("F10"," ","F10BZT","  ","epix"," ","epixBZT","  ","od600"," ","od600BZT","  ")
gtree <- ggtree(hier.phynodenams,ladderize=F,color="gray") + geom_hilight(data=filldat, mapping=aes(node=id, fill=type,extend=5),show.legend=FALSE)  + geom_nodelab()#
p <- gtree + new_scale_fill()#
p1 <- gheatmap(p, biotodfpn[,c(1:4)],  high=rgb(1,0,0),low="gray",offset=0, width=.1,#)#. , #,#
              colnames_angle=90, colnames_offset_y = 17)#
p2 <-gheatmap(p1, biotodfpn[,c(5:8)], offset=0.075, width=.1,#
         colnames_angle=90, colnames_offset_y = 20 ,  high=rgb(0.75,0,0),low="gray",legend_title="times outlier") #
p3 <- p2 + new_scale_fill()#
p3 <-gheatmap(p3, biotodfpn[,c(9:12)], offset=0.15, width=.1,#
         colnames_angle=90, colnames_offset_y = 20, high=rgb(0,0,1),low="gray",legend_title="times outlier")#
p3
pdf("~/Dropbox/salt BT round 2/ggtreeheatv3bio.pdf",width=8,height=10)#
gtree <- ggtree(hier.phynodenams,ladderize=F,color="gray") + geom_hilight(data=filldat, mapping=aes(node=id, fill=type,extend=5),show.legend=FALSE)  + geom_nodelab()#
p <- gtree + new_scale_fill()#
p1 <- gheatmap(p, biotodf[,c(1:4)],  high=rgb(1,0,0),low="gray",offset=0, width=.1,#)#. , #,#
              colnames_angle=90, colnames_offset_y = 17)#
p2 <-gheatmap(p1, biotodf[,c(5:8)], offset=0.075, width=.1,#
         colnames_angle=90, colnames_offset_y = 20 ,  high=rgb(0.75,0,0),low="gray",legend_title="times outlier") #
p3 <- p2 + new_scale_fill()#
p3 <-gheatmap(p3, biotodf[,c(9:12)], offset=0.15, width=.1,#
         colnames_angle=90, colnames_offset_y = 20, high=rgb(0,0,1),low="gray",legend_title="times outlier")#
p3#
dev.off()#
#
pdf("~/Dropbox/salt BT round 2/ggtreeheatv3interval.pdf",width=8,height=10)#
gtree <- ggtree(hier.phynodenams,ladderize=F,color="gray") + geom_hilight(data=filldat, mapping=aes(node=id, fill=type,extend=5),show.legend=FALSE)  + geom_nodelab()#
p <- gtree + new_scale_fill()#
p1 <- gheatmap(p, biotodfpn[,c(1:4)],  high=rgb(1,0,0),low="gray",offset=0, width=.1,#)#. , #,#
              colnames_angle=90, colnames_offset_y = 17)#
p2 <-gheatmap(p1, biotodfpn[,c(5:8)], offset=0.075, width=.1,#
         colnames_angle=90, colnames_offset_y = 20 ,  high=rgb(0.75,0,0),low="gray",legend_title="times outlier") #
p3 <- p2 + new_scale_fill()#
p3 <-gheatmap(p3, biotodfpn[,c(9:12)], offset=0.15, width=.1,#
         colnames_angle=90, colnames_offset_y = 20, high=rgb(0,0,1),low="gray",legend_title="times outlier")#
p3#
dev.off()
mixAAsaltm <- sapply(sort(unique(transf$Genotype)), function(g) sapply(1:ncol(mixAA), function(p) mean(mixAA[transf$Genotype==g & transf$Salt=="0.8" &  transf$Microbes=="+",p],na.rm=T) ))#
mixAAnosaltm <- sapply(sort(unique(transf$Genotype)), function(g) sapply(1:ncol(mixAA), function(p) mean(mixAA[transf$Genotype==g & transf$Salt=="0" &  transf$Microbes=="+",p],na.rm=T)))#
mixAAsaltn <- sapply(sort(unique(transf$Genotype)), function(g) sapply(1:ncol(mixAA), function(p) mean(mixAA[transf$Genotype==g & transf$Salt=="0.8" &  transf$Microbes=="-",p],na.rm=T) ))#
mixAAnosaltn <- sapply(sort(unique(transf$Genotype)), function(g) sapply(1:ncol(mixAA), function(p) mean(mixAA[transf$Genotype==g & transf$Salt=="0" &  transf$Microbes=="-",p],na.rm=T)))#
#
cor(mixAAsaltm,mixAAsaltn)#
cor(mixAAnosaltm,mixAAnosaltn)
cor(mixAAsaltm,mixAAsaltn,use="complete.obs")#
cor(mixAAnosaltm,mixAAnosaltn,use="complete.obs")
head(mixAAsaltm)
head(transf)
mixAAsaltm <- sapply(sort(unique(transf$Genotype)), function(g) sapply(1:ncol(mixAA), function(p) mean(mixAA[transf$Genotype==g & transf$Salt=="0.8" &  transf$Microbes=="Yes",p],na.rm=T) ))#
mixAAnosaltm <- sapply(sort(unique(transf$Genotype)), function(g) sapply(1:ncol(mixAA), function(p) mean(mixAA[transf$Genotype==g & transf$Salt=="0" &  transf$Microbes=="Yes",p],na.rm=T)))#
mixAAsaltn <- sapply(sort(unique(transf$Genotype)), function(g) sapply(1:ncol(mixAA), function(p) mean(mixAA[transf$Genotype==g & transf$Salt=="0.8" &  transf$Microbes=="No",p],na.rm=T) ))#
mixAAnosaltn <- sapply(sort(unique(transf$Genotype)), function(g) sapply(1:ncol(mixAA), function(p) mean(mixAA[transf$Genotype==g & transf$Salt=="0" &  transf$Microbes=="No",p],na.rm=T)))#
#
cor(mixAAsaltm,mixAAsaltn,use="complete.obs")#
cor(mixAAnosaltm,mixAAnosaltn,use="complete.obs")
dim(mixAA)
dim(products)
cor(mixAAnosaltm[1,], mixAAnosaltn[1,])
cor(t(mixAAsaltm),t(mixAAsaltn),use="complete.obs")#
cor(t(mixAAnosaltm),t(mixAAnosaltn),use="complete.obs")
diag(cor(t(mixAAsaltm),t(mixAAsaltn),use="complete.obs"))
diag(cor(t(mixAAnosaltm),t(mixAAnosaltn),use="complete.obs"))
colnames(mixAA)
dim(mixAA)
dim(subbioexactdf)
head(subbioexactdf)
dim(subbioexactdf)
transfbiocc <- cc(subbioexactdf[,10:16],logprods)#
transfbiocc_sum <- CCsummary(transfbiocc)	#
transfbiocc2 <- cc(subbioexactdf[,10:16],mixAA)#
transfbiocc_sum2 <- CCsummary(transfbiocc2)	#
transfbiocc3 <- cc(subbioexactdf[,c(14:16,42)],mixAA)#
transfbiocc_sum3 <- CCsummary(transfbiocc3)
transfbiocc_sum
transfbiocc_sum2
transfbiocc_sum3
layout(matrix(c(1:2,3,3),ncol=2,byrow=T))#
par(mar=c(5,3,3,1))#
par(oma=c(2,3,1,0))#
	plot(transfbiocc$scores$yscores[,1]~transfbiocc$scores$xscores[,1], xlab="",ylab="")#
		mtext("Products score",side=2,line=3.5)#
		mtext(paste(round(100*transfbiocc_sum$vary.expl[1]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiocc_sum$varx.expl[1]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiocc_sum$cov.expl[1]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 1 (n.s.)",side=3,line=1.25)#
	plot(transfbiocc$scores$yscores[,2]~transfbiocc$scores$xscores[,2], xlab="",ylab="")#
		mtext("Biodata score",side=1,line=3.5,adj = -1.5)#
		mtext(paste(round(100*transfbiocc_sum$vary.expl[2]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiocc_sum$varx.expl[2]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiocc_sum$cov.expl[2]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 2 (n.s.)",side=3,line=1.25)#
par(mar=c(6,3,0,1))#
	image(as.matrix(rbind(transfbiocc$scores$corr.Y.yscores[,1:3],#
						transfbiocc$scores$corr.X.xscores[,1:3])),#
				xaxt="n",yaxt="n",ylab="",xlab="",zlim=c(-1,1),col=rwb(100))#
 		abline(v=sum(seq(from = 0, to = 1, length.out =9+7  )[9:10])/2)#
		axis(at=seq(from=0,to=1,length.out=3),side=2,labels=c("CCA axis 1","CCA axis 2", "CCA axis 3"),las=2)#
 		axis(at = seq(from = 0, to = 1, length.out =9+7),side=1,labels = c(prodnames,colnames(subbioexactdf)[10:16]),las=2 )
layout(matrix(c(1:2,3,3),ncol=2,byrow=T))#
par(mar=c(5,3,3,1))#
par(oma=c(2,3,1,0))#
	plot(transfbiotrtcc$scores$yscores[,1]~transfbiotrtcc$scores$xscores[,1], xlab="",ylab="")#
		mtext("Products score",side=2,line=3.5)#
		mtext(paste(round(100*transfbiotrtcc_sum$vary.expl[1]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiotrtcc_sum$varx.expl[1]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiotrtcc_sum$cov.expl[1]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 1 (n.s.)",side=3,line=1.25)#
	plot(transfbiotrtcc$scores$yscores[,2]~transfbiotrtcc$scores$xscores[,2], xlab="",ylab="")#
		mtext("Biodata score",side=1,line=3.5,adj = -1.5)#
		mtext(paste(round(100*transfbiotrtcc_sum$vary.expl[2]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiotrtcc_sum$varx.expl[2]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiotrtcc_sum$cov.expl[2]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 2 (n.s.)",side=3,line=1.25)#
par(mar=c(6,3,0,1))#
	image(as.matrix(rbind(transfbiotrtcc$scores$corr.Y.yscores[,1:3],#
						transfbiotrtcc$scores$corr.X.xscores[,1:3])),#
				xaxt="n",yaxt="n",ylab="",xlab="",zlim=c(-1,1),col=rwb(100))#
 		abline(v=sum(seq(from = 0, to = 1, length.out =9+11  )[9:10])/2)#
		axis(at=seq(from=0,to=1,length.out=3),side=2,labels=c("CCA axis 1","CCA axis 2", "CCA axis 3"),las=2)#
 		axis(at = seq(from = 0, to = 1, length.out =9+11),side=1,labels = c(prodnames,colnames(subbioexactdf)[18:28]),las=2 )
transfbiotrtcc <- cc(subbioexactdf[,18:28],logprods)#
transfbiotrtcc_sum <- CCsummary(transfbiotrtcc)
layout(matrix(c(1:2,3,3),ncol=2,byrow=T))#
par(mar=c(5,3,3,1))#
par(oma=c(2,3,1,0))#
	plot(transfbiotrtcc$scores$yscores[,1]~transfbiotrtcc$scores$xscores[,1], xlab="",ylab="")#
		mtext("Products score",side=2,line=3.5)#
		mtext(paste(round(100*transfbiotrtcc_sum$vary.expl[1]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiotrtcc_sum$varx.expl[1]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiotrtcc_sum$cov.expl[1]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 1 (n.s.)",side=3,line=1.25)#
	plot(transfbiotrtcc$scores$yscores[,2]~transfbiotrtcc$scores$xscores[,2], xlab="",ylab="")#
		mtext("Biodata score",side=1,line=3.5,adj = -1.5)#
		mtext(paste(round(100*transfbiotrtcc_sum$vary.expl[2]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiotrtcc_sum$varx.expl[2]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiotrtcc_sum$cov.expl[2]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 2 (n.s.)",side=3,line=1.25)#
par(mar=c(6,3,0,1))#
	image(as.matrix(rbind(transfbiotrtcc$scores$corr.Y.yscores[,1:3],#
						transfbiotrtcc$scores$corr.X.xscores[,1:3])),#
				xaxt="n",yaxt="n",ylab="",xlab="",zlim=c(-1,1),col=rwb(100))#
 		abline(v=sum(seq(from = 0, to = 1, length.out =9+11  )[9:10])/2)#
		axis(at=seq(from=0,to=1,length.out=3),side=2,labels=c("CCA axis 1","CCA axis 2", "CCA axis 3"),las=2)#
 		axis(at = seq(from = 0, to = 1, length.out =9+11),side=1,labels = c(prodnames,colnames(subbioexactdf)[18:28]),las=2 )
layout(matrix(c(1:2,3,3),ncol=2,byrow=T))#
par(mar=c(5,3,3,1))#
par(oma=c(2,3,1,0))#
	plot(transfbiocc2$scores$yscores[,1]~transfbiocc2$scores$xscores[,1], xlab="",ylab="")#
		mtext("Products score",side=2,line=3.5)#
		mtext(paste(round(100*transfbiocc2_sum$vary.expl[1]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$varx.expl[1]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$cov.expl[1]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 1 (n.s.)",side=3,line=1.25)#
	plot(transfbiocc2$scores$yscores[,2]~transfbiocc2$scores$xscores[,2], xlab="",ylab="")#
		mtext("Biodata score",side=1,line=3.5,adj = -1.5)#
		mtext(paste(round(100*transfbiocc2_sum$vary.expl[2]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$varx.expl[2]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$cov.expl[2]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 2 (n.s.)",side=3,line=1.25)#
par(mar=c(6,3,0,1))#
	image(as.matrix(rbind(transfbiocc2$scores$corr.Y.yscores[,1:3],#
						transfbiocc2$scores$corr.X.xscores[,1:3])),#
				xaxt="n",yaxt="n",ylab="",xlab="",zlim=c(-1,1),col=rwb(100))#
 		abline(v=sum(seq(from = 0, to = 1, length.out =9+7  )[9:10])/2)#
		axis(at=seq(from=0,to=1,length.out=3),side=2,labels=c("CCA axis 1","CCA axis 2", "CCA axis 3"),las=2)#
 		axis(at = seq(from = 0, to = 1, length.out =9+7),side=1,labels = c(prodnames,colnames(subbioexactdf)[10:16]),las=2 )
transfbiocc2$scores$corr.Y.yscores
transfbiocc2$scores$corr.X.xscores
layout(matrix(c(1:2,3,3),ncol=2,byrow=T))#
par(mar=c(5,3,3,1))#
par(oma=c(2,3,1,0))#
	plot(transfbiocc2$scores$yscores[,1]~transfbiocc2$scores$xscores[,1], xlab="",ylab="")#
		mtext("Products score",side=2,line=3.5)#
		mtext(paste(round(100*transfbiocc2_sum$vary.expl[1]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$varx.expl[1]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$cov.expl[1]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 1 (n.s.)",side=3,line=1.25)#
	plot(transfbiocc2$scores$yscores[,2]~transfbiocc2$scores$xscores[,2], xlab="",ylab="")#
		mtext("Biodata score",side=1,line=3.5,adj = -1.5)#
		mtext(paste(round(100*transfbiocc2_sum$vary.expl[2]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$varx.expl[2]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$cov.expl[2]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 2 (n.s.)",side=3,line=1.25)#
par(mar=c(6,3,0,1))#
	image(as.matrix(rbind(transfbiocc2$scores$corr.Y.yscores[,1:3],#
						transfbiocc2$scores$corr.X.xscores[,1:3])),#
				xaxt="n",yaxt="n",ylab="",xlab="",zlim=c(-1,1),col=rwb(100))#
 		abline(v=sum(seq(from = 0, to = 1, length.out =8+7  )[8:9])/2)#
		axis(at=seq(from=0,to=1,length.out=3),side=2,labels=c("CCA axis 1","CCA axis 2", "CCA axis 3"),las=2)#
 		axis(at = seq(from = 0, to = 1, length.out =9+7),side=1,labels = c(prodnames,colnames(subbioexactdf)[10:16]),las=2 )
layout(matrix(c(1:2,3,3),ncol=2,byrow=T))#
par(mar=c(5,3,3,1))#
par(oma=c(2,3,1,0))#
	plot(transfbiocc$scores$yscores[,1]~transfbiocc$scores$xscores[,1], xlab="",ylab="")#
		mtext("Products score",side=2,line=3.5)#
		mtext(paste(round(100*transfbiocc_sum$vary.expl[1]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiocc_sum$varx.expl[1]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiocc_sum$cov.expl[1]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 1 (n.s.)",side=3,line=1.25)#
	plot(transfbiocc$scores$yscores[,2]~transfbiocc$scores$xscores[,2], xlab="",ylab="")#
		mtext("Biodata score",side=1,line=3.5,adj = -1.5)#
		mtext(paste(round(100*transfbiocc_sum$vary.expl[2]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiocc_sum$varx.expl[2]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiocc_sum$cov.expl[2]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 2 (n.s.)",side=3,line=1.25)#
par(mar=c(6,3,0,1))#
	image(as.matrix(rbind(transfbiocc$scores$corr.Y.yscores[,1:3],#
						transfbiocc$scores$corr.X.xscores[,1:3])),#
				xaxt="n",yaxt="n",ylab="",xlab="",zlim=c(-1,1),col=rwb(100))#
 		abline(v=sum(seq(from = 0, to = 1, length.out =9+7  )[9:10])/2)#
		axis(at=seq(from=0,to=1,length.out=3),side=2,labels=c("CCA axis 1","CCA axis 2", "CCA axis 3"),las=2)#
 		axis(at = seq(from = 0, to = 1, length.out =9+7),side=1,labels = c(prodnames,colnames(subbioexactdf)[10:16]),las=2 )
transfbiocc2_sum
transfbiocc2 <- cc(subbioexactdf[,10:16],mixAA)#
transfbiocc_sum2 <- CCsummary(transfbiocc2)	#
transfbiocc3 <- cc(subbioexactdf[,c(14:16,42)],mixAA)#
transfbiocc_sum3 <- CCsummary(transfbiocc3)
transfbiocc_sum2 <- CCsummary(transfbiocc2)	#
transfbiocc3 <- cc(subbioexactdf[,c(14:16,42)],mixAA)#
transfbiocc_sum3 <- CCsummary(transfbiocc3)
layout(matrix(c(1:2,3,3),ncol=2,byrow=T))#
par(mar=c(5,3,3,1))#
par(oma=c(2,3,1,0))#
	plot(transfbiocc$scores$yscores[,1]~transfbiocc$scores$xscores[,1], xlab="",ylab="")#
		mtext("Products score",side=2,line=3.5)#
		mtext(paste(round(100*transfbiocc_sum$vary.expl[1]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiocc_sum$varx.expl[1]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiocc_sum$cov.expl[1]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 1 (n.s.)",side=3,line=1.25)#
	plot(transfbiocc$scores$yscores[,2]~transfbiocc$scores$xscores[,2], xlab="",ylab="")#
		mtext("Biodata score",side=1,line=3.5,adj = -1.5)#
		mtext(paste(round(100*transfbiocc_sum$vary.expl[2]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiocc_sum$varx.expl[2]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiocc_sum$cov.expl[2]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 2 (n.s.)",side=3,line=1.25)#
par(mar=c(6,3,0,1))#
	image(as.matrix(rbind(transfbiocc$scores$corr.Y.yscores[,1:3],#
						transfbiocc$scores$corr.X.xscores[,1:3])),#
				xaxt="n",yaxt="n",ylab="",xlab="",zlim=c(-1,1),col=rwb(100))#
 		abline(v=sum(seq(from = 0, to = 1, length.out =9+7  )[9:10])/2)#
		axis(at=seq(from=0,to=1,length.out=3),side=2,labels=c("CCA axis 1","CCA axis 2", "CCA axis 3"),las=2)#
 		axis(at = seq(from = 0, to = 1, length.out =9+7),side=1,labels = c(prodnames,colnames(subbioexactdf)[10:16]),las=2 )
layout(matrix(c(1:2,3,3),ncol=2,byrow=T))#
par(mar=c(5,3,3,1))#
par(oma=c(2,3,1,0))#
	plot(transfbiocc2$scores$yscores[,1]~transfbiocc2$scores$xscores[,1], xlab="",ylab="")#
		mtext("Products score",side=2,line=3.5)#
		mtext(paste(round(100*transfbiocc2_sum$vary.expl[1]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$varx.expl[1]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$cov.expl[1]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 1 (n.s.)",side=3,line=1.25)#
	plot(transfbiocc2$scores$yscores[,2]~transfbiocc2$scores$xscores[,2], xlab="",ylab="")#
		mtext("Biodata score",side=1,line=3.5,adj = -1.5)#
		mtext(paste(round(100*transfbiocc2_sum$vary.expl[2]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$varx.expl[2]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$cov.expl[2]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 2 (n.s.)",side=3,line=1.25)#
par(mar=c(6,3,0,1))#
	image(as.matrix(rbind(transfbiocc2$scores$corr.Y.yscores[,1:3],#
						transfbiocc2$scores$corr.X.xscores[,1:3])),#
				xaxt="n",yaxt="n",ylab="",xlab="",zlim=c(-1,1),col=rwb(100))#
 		abline(v=sum(seq(from = 0, to = 1, length.out =8+7  )[8:9])/2)#
		axis(at=seq(from=0,to=1,length.out=3),side=2,labels=c("CCA axis 1","CCA axis 2", "CCA axis 3"),las=2)#
 		axis(at = seq(from = 0, to = 1, length.out =9+7),side=1,labels = c(prodnames,colnames(subbioexactdf)[10:16]),las=2 )
transfbiocc2_sum <- CCsummary(transfbiocc2)	#
transfbiocc3 <- cc(subbioexactdf[,c(14:16,42)],mixAA)#
transfbiocc3_sum <- CCsummary(transfbiocc3)
layout(matrix(c(1:2,3,3),ncol=2,byrow=T))#
par(mar=c(5,3,3,1))#
par(oma=c(2,3,1,0))#
	plot(transfbiocc2$scores$yscores[,1]~transfbiocc2$scores$xscores[,1], xlab="",ylab="")#
		mtext("Products score",side=2,line=3.5)#
		mtext(paste(round(100*transfbiocc2_sum$vary.expl[1]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$varx.expl[1]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$cov.expl[1]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 1 (n.s.)",side=3,line=1.25)#
	plot(transfbiocc2$scores$yscores[,2]~transfbiocc2$scores$xscores[,2], xlab="",ylab="")#
		mtext("Biodata score",side=1,line=3.5,adj = -1.5)#
		mtext(paste(round(100*transfbiocc2_sum$vary.expl[2]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$varx.expl[2]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$cov.expl[2]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 2 (n.s.)",side=3,line=1.25)#
par(mar=c(6,3,0,1))#
	image(as.matrix(rbind(transfbiocc2$scores$corr.Y.yscores[,1:3],#
						transfbiocc2$scores$corr.X.xscores[,1:3])),#
				xaxt="n",yaxt="n",ylab="",xlab="",zlim=c(-1,1),col=rwb(100))#
 		abline(v=sum(seq(from = 0, to = 1, length.out =8+7  )[8:9])/2)#
		axis(at=seq(from=0,to=1,length.out=3),side=2,labels=c("CCA axis 1","CCA axis 2", "CCA axis 3"),las=2)#
 		axis(at = seq(from = 0, to = 1, length.out =9+7),side=1,labels = c(prodnames,colnames(subbioexactdf)[10:16]),las=2 )
layout(matrix(c(1:2,3,3),ncol=2,byrow=T))#
par(mar=c(5,3,3,1))#
par(oma=c(2,3,1,0))#
	plot(transfbiocc3$scores$yscores[,1]~transfbiocc3$scores$xscores[,1], xlab="",ylab="")#
		mtext("Products score",side=2,line=3.5)#
		mtext(paste(round(100*transfbiocc3_sum$vary.expl[1]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiocc3_sum$varx.expl[1]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiocc3_sum$cov.expl[1]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 1 (n.s.)",side=3,line=1.25)#
	plot(transfbiocc3$scores$yscores[,2]~transfbiocc3$scores$xscores[,2], xlab="",ylab="")#
		mtext("Biodata score",side=1,line=3.5,adj = -1.5)#
		mtext(paste(round(100*transfbiocc3_sum$vary.expl[2]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiocc3_sum$varx.expl[2]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiocc3_sum$cov.expl[2]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 2 (n.s.)",side=3,line=1.25)#
par(mar=c(6,3,0,1))#
	image(as.matrix(rbind(transfbiocc3$scores$corr.Y.yscores[,1:3],#
						transfbiocc3$scores$corr.X.xscores[,1:3])),#
				xaxt="n",yaxt="n",ylab="",xlab="",zlim=c(-1,1),col=rwb(100))#
 		abline(v=sum(seq(from = 0, to = 1, length.out =8+7  )[8:9])/2)#
		axis(at=seq(from=0,to=1,length.out=3),side=2,labels=c("CCA axis 1","CCA axis 2", "CCA axis 3"),las=2)#
 		axis(at = seq(from = 0, to = 1, length.out =9+7),side=1,labels = c(prodnames,colnames(subbioexactdf)[10:16]),las=2 )
prodnames <- colnames(products)#
prodnames2 <- colnames(mixAA)
layout(matrix(c(1:2,3,3),ncol=2,byrow=T))#
par(mar=c(5,3,3,1))#
par(oma=c(2,3,1,0))#
	plot(transfbiocc2$scores$yscores[,1]~transfbiocc2$scores$xscores[,1], xlab="",ylab="")#
		mtext("Products score",side=2,line=3.5)#
		mtext(paste(round(100*transfbiocc2_sum$vary.expl[1]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$varx.expl[1]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$cov.expl[1]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 1 (n.s.)",side=3,line=1.25)#
	plot(transfbiocc2$scores$yscores[,2]~transfbiocc2$scores$xscores[,2], xlab="",ylab="")#
		mtext("Biodata score",side=1,line=3.5,adj = -1.5)#
		mtext(paste(round(100*transfbiocc2_sum$vary.expl[2]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$varx.expl[2]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$cov.expl[2]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 2 (n.s.)",side=3,line=1.25)#
par(mar=c(6,3,0,1))#
	image(as.matrix(rbind(transfbiocc2$scores$corr.Y.yscores[,1:3],#
						transfbiocc2$scores$corr.X.xscores[,1:3])),#
				xaxt="n",yaxt="n",ylab="",xlab="",zlim=c(-1,1),col=rwb(100))#
 		abline(v=sum(seq(from = 0, to = 1, length.out =8+7  )[8:9])/2)#
		axis(at=seq(from=0,to=1,length.out=3),side=2,labels=c("CCA axis 1","CCA axis 2", "CCA axis 3"),las=2)#
 		axis(at = seq(from = 0, to = 1, length.out =9+7),side=1,labels = c(prodnames2,colnames(subbioexactdf)[10:16]),las=2 )
layout(matrix(c(1:2,3,3),ncol=2,byrow=T))#
par(mar=c(5,3,3,1))#
par(oma=c(2,3,1,0))#
	plot(transfbiocc2$scores$yscores[,1]~transfbiocc2$scores$xscores[,1], xlab="",ylab="")#
		mtext("Products score",side=2,line=3.5)#
		mtext(paste(round(100*transfbiocc2_sum$vary.expl[1]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$varx.expl[1]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$cov.expl[1]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 1 (n.s.)",side=3,line=1.25)#
	plot(transfbiocc2$scores$yscores[,2]~transfbiocc2$scores$xscores[,2], xlab="",ylab="")#
		mtext("Biodata score",side=1,line=3.5,adj = -1.5)#
		mtext(paste(round(100*transfbiocc2_sum$vary.expl[2]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$varx.expl[2]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$cov.expl[2]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 2 (n.s.)",side=3,line=1.25)#
par(mar=c(6,3,0,1))#
	image(as.matrix(rbind(transfbiocc2$scores$corr.Y.yscores[,1:3],#
						transfbiocc2$scores$corr.X.xscores[,1:3])),#
				xaxt="n",yaxt="n",ylab="",xlab="",zlim=c(-1,1),col=rwb(100))#
 		abline(v=sum(seq(from = 0, to = 1, length.out =8+7  )[8:9])/2)#
		axis(at=seq(from=0,to=1,length.out=3),side=2,labels=c("CCA axis 1","CCA axis 2", "CCA axis 3"),las=2)#
 		axis(at = seq(from = 0, to = 1, length.out =8+7),side=1,labels = c(prodnames2,colnames(subbioexactdf)[10:16]),las=2 )
layout(matrix(c(1:2,3,3),ncol=2,byrow=T))#
par(mar=c(5,3,3,1))#
par(oma=c(2,3,1,0))#
	plot(transfbiocc$scores$yscores[,1]~transfbiocc$scores$xscores[,1], xlab="",ylab="")#
		mtext("Products score",side=2,line=3.5)#
		mtext(paste(round(100*transfbiocc_sum$vary.expl[1]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiocc_sum$varx.expl[1]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiocc_sum$cov.expl[1]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 1 (n.s.)",side=3,line=1.25)#
	plot(transfbiocc$scores$yscores[,2]~transfbiocc$scores$xscores[,2], xlab="",ylab="")#
		mtext("Biodata score",side=1,line=3.5,adj = -1.5)#
		mtext(paste(round(100*transfbiocc_sum$vary.expl[2]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiocc_sum$varx.expl[2]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiocc_sum$cov.expl[2]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 2 (n.s.)",side=3,line=1.25)#
par(mar=c(6,3,0,1))#
	image(as.matrix(rbind(transfbiocc$scores$corr.Y.yscores[,1:3],#
						transfbiocc$scores$corr.X.xscores[,1:3])),#
				xaxt="n",yaxt="n",ylab="",xlab="",zlim=c(-1,1),col=rwb(100))#
 		abline(v=sum(seq(from = 0, to = 1, length.out =9+7  )[9:10])/2)#
		axis(at=seq(from=0,to=1,length.out=3),side=2,labels=c("CCA axis 1","CCA axis 2", "CCA axis 3"),las=2)#
 		axis(at = seq(from = 0, to = 1, length.out =9+7),side=1,labels = c(prodnames,colnames(subbioexactdf)[10:16]),las=2 )
layout(matrix(c(1:2,3,3),ncol=2,byrow=T))#
par(mar=c(5,3,3,1))#
par(oma=c(2,3,1,0))#
	plot(transfbiocc2$scores$yscores[,1]~transfbiocc2$scores$xscores[,1], xlab="",ylab="")#
		mtext("Products score",side=2,line=3.5)#
		mtext(paste(round(100*transfbiocc2_sum$vary.expl[1]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$varx.expl[1]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$cov.expl[1]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 1 (n.s.)",side=3,line=1.25)#
	plot(transfbiocc2$scores$yscores[,2]~transfbiocc2$scores$xscores[,2], xlab="",ylab="")#
		mtext("Biodata score",side=1,line=3.5,adj = -1.5)#
		mtext(paste(round(100*transfbiocc2_sum$vary.expl[2]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$varx.expl[2]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiocc2_sum$cov.expl[2]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 2 (n.s.)",side=3,line=1.25)#
par(mar=c(6,3,0,1))#
	image(as.matrix(rbind(transfbiocc2$scores$corr.Y.yscores[,1:3],#
						transfbiocc2$scores$corr.X.xscores[,1:3])),#
				xaxt="n",yaxt="n",ylab="",xlab="",zlim=c(-1,1),col=rwb(100))#
 		abline(v=sum(seq(from = 0, to = 1, length.out =8+7  )[8:9])/2)#
		axis(at=seq(from=0,to=1,length.out=3),side=2,labels=c("CCA axis 1","CCA axis 2", "CCA axis 3"),las=2)#
 		axis(at = seq(from = 0, to = 1, length.out =8+7),side=1,labels = c(prodnames2,colnames(subbioexactdf)[10:16]),las=2 )
layout(matrix(c(1:2,3,3),ncol=2,byrow=T))#
par(mar=c(5,3,3,1))#
par(oma=c(2,3,1,0))#
	plot(transfbiocc3$scores$yscores[,1]~transfbiocc3$scores$xscores[,1], xlab="",ylab="")#
		mtext("Products score",side=2,line=3.5)#
		mtext(paste(round(100*transfbiocc3_sum$vary.expl[1]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiocc3_sum$varx.expl[1]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiocc3_sum$cov.expl[1]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 1 (n.s.)",side=3,line=1.25)#
	plot(transfbiocc3$scores$yscores[,2]~transfbiocc3$scores$xscores[,2], xlab="",ylab="")#
		mtext("Biodata score",side=1,line=3.5,adj = -1.5)#
		mtext(paste(round(100*transfbiocc3_sum$vary.expl[2]),"% var",sep=""),side=2,line=2)#
		mtext(paste(round(100*transfbiocc3_sum$varx.expl[2]),"% var",sep=""),side=1,line=2)#
		mtext(paste(round(100*transfbiocc3_sum$cov.expl[2]),"% cov",sep=""),side=3,line=0.25)#
		mtext("CCA Axis 2 (n.s.)",side=3,line=1.25)#
par(mar=c(6,3,0,1))#
	image(as.matrix(rbind(transfbiocc3$scores$corr.Y.yscores[,1:3],#
						transfbiocc3$scores$corr.X.xscores[,1:3])),#
				xaxt="n",yaxt="n",ylab="",xlab="",zlim=c(-1,1),col=rwb(100))#
 		abline(v=sum(seq(from = 0, to = 1, length.out =8+4  )[8:9])/2)#
		axis(at=seq(from=0,to=1,length.out=3),side=2,labels=c("CCA axis 1","CCA axis 2", "CCA axis 3"),las=2)#
 		axis(at = seq(from = 0, to = 1, length.out =8+4),side=1,labels = c(prodnames2,colnames(subbioexactdf)[c(14:16,42)]),las=2 )
cor(transf$density,transfbiocc$scores$yscores)#using km instead of density, but similar#
cor(transf$km,transfbiocc$scores$yscores)##
cor(transf$km,transfbiotrtcc$scores$yscores)
cor(transf$km,transfbiocc2$scores$yscores)
cor(transf$density,transfbiocc2$scores$yscores)
cor(transf$density,transfbiocc3$scores$yscores)
cor(transf$km,transfbiocc3$scores$yscores)
plot(transf$km,transfbiocc3$scores$yscores)
plot(transf$km~transfbiocc3$scores$yscores)
transfbiocc3$scores$yscores
plot(transf$km~transfbiocc3$scores$yscores[,1])
plot(transf$density~transfbiocc3$scores$yscores[,1])
cor(transf$km,transfbiocc3$scores$yscores)
plot(transf$density,transfbiocc3$scores$yscores[,1])
plot(transf$km,transfbiocc3$scores$yscores[,1])
maanss <-rbind(mixAAsaltm,mixAAnosaltm)#
	rownames(maanss) <- c( colnames(mixAA), paste(colnames(mixAA),"_S",sep="")  )#
tipisout <- tipxout(maanss,subbalphy,hier.phy)#
#
ntipisout <- list()#
for(i in 1:1000){#
	nmaanss <- maanss[,sample(1:ncol(maanss),repl=F)]#
	ntipisout[[i]] <-  tipxout(nmaanss,subbalphy,hier.phy)#
}#
reord <- lapply(1:ncol(tipisout), function(prd) sapply(1:length(ntipisout), function(n) ntipisout[[n]][,prd]) )#
#
int <- sapply(1:ncol(tipisout), function(p) sapply(1:nrow(tipisout),function(T) findInterval(tipisout[T,p],sort(reord[[p]][T,]) ,left.open=T )/length(reord[[p]][T,]) ) )#
tipisoutpernode <- int#
tipisoutpernode [tipisoutpernode<0.95] <- 0
row.names(tipisoutbio)<- hier.phy3$tip.label#
row.names(Btipisoutpernode)<- hier.phy3$tip.label#
biotodf <- as.data.frame(tipisoutbio)#
biotodfpn <- as.data.frame(Btipisoutpernode)#
colnames(biotodf) <-  c("F10"," ","F10BZT","  ","epix"," ","epixBZT","  ","od600"," ","od600BZT","  ")#
colnames(biotodfpn) <- c("F10"," ","F10BZT","  ","epix"," ","epixBZT","  ","od600"," ","od600BZT","  ")
gtree <- ggtree(hier.phynodenams,ladderize=F,color="gray") + geom_hilight(data=filldat, mapping=aes(node=id, fill=type,extend=5),show.legend=FALSE)  + geom_nodelab()#
p <- gtree + new_scale_fill()#
p1 <- gheatmap(p, biotodf[,c(1:4)],  high=rgb(1,0,0),low="gray",offset=0, width=.1,#)#. , #,#
              colnames_angle=90, colnames_offset_y = 17)#
p2 <-gheatmap(p1, biotodf[,c(5:8)], offset=0.075, width=.1,#
         colnames_angle=90, colnames_offset_y = 20 ,  high=rgb(0.75,0,0),low="gray",legend_title="times outlier") #
p3 <- p2 + new_scale_fill()#
p3 <-gheatmap(p3, biotodf[,c(9:12)], offset=0.15, width=.1,#
         colnames_angle=90, colnames_offset_y = 20, high=rgb(0,0,1),low="gray",legend_title="times outlier")#
p3
gtree <- ggtree(hier.phynodenams,ladderize=F,color="gray") + geom_hilight(data=filldat, mapping=aes(node=id, fill=type,extend=5),show.legend=FALSE)  + geom_nodelab()#
p <- gtree + new_scale_fill()#
p1 <- gheatmap(p, biotodfpn[,c(1:4)],  high=rgb(1,0,0),low="gray",offset=0, width=.1,#)#. , #,#
              colnames_angle=90, colnames_offset_y = 17)#
p2 <-gheatmap(p1, biotodfpn[,c(5:8)], offset=0.075, width=.1,#
         colnames_angle=90, colnames_offset_y = 20 ,  high=rgb(0.75,0,0),low="gray",legend_title="times outlier") #
p3 <- p2 + new_scale_fill()#
p3 <-gheatmap(p3, biotodfpn[,c(9:12)], offset=0.15, width=.1,#
         colnames_angle=90, colnames_offset_y = 20, high=rgb(0,0,1),low="gray",legend_title="times outlier")#
p3
gtree <- ggtree(hier.phynodenams,ladderize=F,color="gray") + geom_hilight(data=filldat, mapping=aes(node=id, fill=type,extend=5),show.legend=FALSE)  + geom_nodelab()#
p <- gtree + new_scale_fill()#
p1 <- gheatmap(p, rotodf[,c(3:4)],  high=rgb(1,0,0),low="gray",offset=0, width=.1,#)#. , #,#
              colnames_angle=90, colnames_offset_y = 17)#
p2 <-gheatmap(p1, rotodf[,c(5:6)], offset=0.075, width=.1,#
         colnames_angle=90, colnames_offset_y = 20 ,  high=rgb(0.75,0,0),low="gray",legend_title="times outlier") #
p3 <- p2 + new_scale_fill()#
p3 <-gheatmap(p3, rotodf[,c(13:14)], offset=0.15, width=.1,#
         colnames_angle=90, colnames_offset_y = 13)#
p4 <-gheatmap(p3, rotodf[,c(15:16)], offset=0.225, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0.75,0,0.75),low="gray",legend_title="times outlier") #
p5 <- p4 + new_scale_fill()#
p5 <- gheatmap(p5, rotodf[,c(9:10)], offset=0.30, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0,0,1),low="gray") #
p6 <- gheatmap(p5, rotodf[,c(11:12)], offset=0.375, width=.1,#
         colnames_angle=90, colnames_offset_y = 25,  high=rgb(0,0,0.75),low="gray",legend_title="times outlier") #
p6
gtree <- ggtree(hier.phynodenams,ladderize=F,color="gray") + geom_hilight(data=filldat, mapping=aes(node=id, fill=type,extend=5),show.legend=FALSE)  + geom_nodelab()#
p <- gtree + new_scale_fill()#
p1 <- gheatmap(p, rotodfpn[,c(3:4)],  high=rgb(1,0,0),low="gray",offset=0, width=.1,#)#. , #,#
              colnames_angle=90, colnames_offset_y = 17)#
p2 <-gheatmap(p1, rotodfpn[,c(5:6)], offset=0.075, width=.1,#
         colnames_angle=90, colnames_offset_y = 20 ,  high=rgb(0.75,0,0),low="gray",legend_title="interval") #
p3 <- p2 + new_scale_fill()#
p3 <-gheatmap(p3, rotodfpn[,c(13:14)], offset=0.15, width=.1,#
         colnames_angle=90, colnames_offset_y = 13)#
p4 <-gheatmap(p3, rotodfpn[,c(15:16)], offset=0.225, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0.75,0,0.75),low="gray",legend_title="interval") #
p5 <- p4 + new_scale_fill()#
p5 <- gheatmap(p5, rotodfpn[,c(9:10)], offset=0.30, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0,0,1),low="gray") #
p6 <- gheatmap(p5, rotodfpn[,c(11:12)], offset=0.375, width=.1,#
         colnames_angle=90, colnames_offset_y = 25,  high=rgb(0,0,0.75),low="gray",legend_title="interval") #
p6
reorderTO <- tipisout[,c(1,9,2,10,3,11,4,12,5,13,6,14,7,15,8,16)] #first is salt then without salt#
row.names(reorderTO)<- hier.phy3$tip.label#
reorderTOpn <- tipisoutpernode[,c(1,9,2,10,3,11,4,12,5,13,6,14,7,15,8,16)]#
row.names(reorderTOpn)<- hier.phy3$tip.label#
rotodf <- as.data.frame(reorderTO)#
rotodfpn <- as.data.frame(reorderTOpn)#
transfnames <- c("BZT","gly.BZT","BZTa+aa","aniline","amino3ph","phenanzine","mBZT","moxyBZT")#
colnames(rotodf) <- c("BZT"," ","gly.BZT"," ","BZTa+aa"," ","aniline","aniline","amino3ph"," ","phenanzine"," ","mBZT"," ","moxyBZT"," ")#
colnames(rotodfpn) <- c("BZT"," ","gly.BZT"," ","BZTa+aa"," ","aniline","aniline","amino3ph"," ","phenanzine"," ","mBZT"," ","moxyBZT"," ")
gtree <- ggtree(hier.phynodenams,ladderize=F,color="gray") + geom_hilight(data=filldat, mapping=aes(node=id, fill=type,extend=5),show.legend=FALSE)  + geom_nodelab()#
p <- gtree + new_scale_fill()#
p1 <- gheatmap(p, rotodfpn[,c(3:4)],  high=rgb(1,0,0),low="gray",offset=0, width=.1,#)#. , #,#
              colnames_angle=90, colnames_offset_y = 17)#
p2 <-gheatmap(p1, rotodfpn[,c(5:6)], offset=0.075, width=.1,#
         colnames_angle=90, colnames_offset_y = 20 ,  high=rgb(0.75,0,0),low="gray",legend_title="interval") #
p3 <- p2 + new_scale_fill()#
p3 <-gheatmap(p3, rotodfpn[,c(13:14)], offset=0.15, width=.1,#
         colnames_angle=90, colnames_offset_y = 13)#
p4 <-gheatmap(p3, rotodfpn[,c(15:16)], offset=0.225, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0.75,0,0.75),low="gray",legend_title="interval") #
p5 <- p4 + new_scale_fill()#
p5 <- gheatmap(p5, rotodfpn[,c(9:10)], offset=0.30, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0,0,1),low="gray") #
p6 <- gheatmap(p5, rotodfpn[,c(11:12)], offset=0.375, width=.1,#
         colnames_angle=90, colnames_offset_y = 25,  high=rgb(0,0,0.75),low="gray",legend_title="interval") #
p6
gtree <- ggtree(hier.phynodenams,ladderize=F,color="gray") + geom_hilight(data=filldat, mapping=aes(node=id, fill=type,extend=5),show.legend=FALSE)  + geom_nodelab()#
p <- gtree + new_scale_fill()#
p1 <- gheatmap(p, rotodf[,c(3:4)],  high=rgb(1,0,0),low="gray",offset=0, width=.1,#)#. , #,#
              colnames_angle=90, colnames_offset_y = 17)#
p2 <-gheatmap(p1, rotodf[,c(5:6)], offset=0.075, width=.1,#
         colnames_angle=90, colnames_offset_y = 20 ,  high=rgb(0.75,0,0),low="gray",legend_title="times outlier") #
p3 <- p2 + new_scale_fill()#
p3 <-gheatmap(p3, rotodf[,c(13:14)], offset=0.15, width=.1,#
         colnames_angle=90, colnames_offset_y = 13)#
p4 <-gheatmap(p3, rotodf[,c(15:16)], offset=0.225, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0.75,0,0.75),low="gray",legend_title="times outlier") #
p5 <- p4 + new_scale_fill()#
p5 <- gheatmap(p5, rotodf[,c(9:10)], offset=0.30, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0,0,1),low="gray") #
p6 <- gheatmap(p5, rotodf[,c(11:12)], offset=0.375, width=.1,#
         colnames_angle=90, colnames_offset_y = 25,  high=rgb(0,0,0.75),low="gray",legend_title="times outlier") #
p6
#transformation products balance plots#
pdf("~/Dropbox/salt BT round 2/testggtreeheatv3_monly.pdf",width=8,height=10)#
gtree <- ggtree(hier.phynodenams,ladderize=F,color="gray") + geom_hilight(data=filldat, mapping=aes(node=id, fill=type,extend=5),show.legend=FALSE)  + geom_nodelab()#
p <- gtree + new_scale_fill()#
p1 <- gheatmap(p, rotodf[,c(3:4)],  high=rgb(1,0,0),low="gray",offset=0, width=.1,#)#. , #,#
              colnames_angle=90, colnames_offset_y = 17)#
p2 <-gheatmap(p1, rotodf[,c(5:6)], offset=0.075, width=.1,#
         colnames_angle=90, colnames_offset_y = 20 ,  high=rgb(0.75,0,0),low="gray",legend_title="times outlier") #
p3 <- p2 + new_scale_fill()#
p3 <-gheatmap(p3, rotodf[,c(13:14)], offset=0.15, width=.1,#
         colnames_angle=90, colnames_offset_y = 13)#
p4 <-gheatmap(p3, rotodf[,c(15:16)], offset=0.225, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0.75,0,0.75),low="gray",legend_title="times outlier") #
p5 <- p4 + new_scale_fill()#
p5 <- gheatmap(p5, rotodf[,c(9:10)], offset=0.30, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0,0,1),low="gray") #
p6 <- gheatmap(p5, rotodf[,c(11:12)], offset=0.375, width=.1,#
         colnames_angle=90, colnames_offset_y = 25,  high=rgb(0,0,0.75),low="gray",legend_title="times outlier") #
p6#
dev.off()#
#
pdf("~/Dropbox/salt BT round 2/testggtreeheatv3interval_monly.pdf",width=8,height=10)#
gtree <- ggtree(hier.phynodenams,ladderize=F,color="gray") + geom_hilight(data=filldat, mapping=aes(node=id, fill=type,extend=5),show.legend=FALSE)  + geom_nodelab()#
p <- gtree + new_scale_fill()#
p1 <- gheatmap(p, rotodfpn[,c(3:4)],  high=rgb(1,0,0),low="gray",offset=0, width=.1,#)#. , #,#
              colnames_angle=90, colnames_offset_y = 17)#
p2 <-gheatmap(p1, rotodfpn[,c(5:6)], offset=0.075, width=.1,#
         colnames_angle=90, colnames_offset_y = 20 ,  high=rgb(0.75,0,0),low="gray",legend_title="interval") #
p3 <- p2 + new_scale_fill()#
p3 <-gheatmap(p3, rotodfpn[,c(13:14)], offset=0.15, width=.1,#
         colnames_angle=90, colnames_offset_y = 13)#
p4 <-gheatmap(p3, rotodfpn[,c(15:16)], offset=0.225, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0.75,0,0.75),low="gray",legend_title="interval") #
p5 <- p4 + new_scale_fill()#
p5 <- gheatmap(p5, rotodfpn[,c(9:10)], offset=0.30, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0,0,1),low="gray") #
p6 <- gheatmap(p5, rotodfpn[,c(11:12)], offset=0.375, width=.1,#
         colnames_angle=90, colnames_offset_y = 25,  high=rgb(0,0,0.75),low="gray",legend_title="interval") #
p6#
dev.off()
pdf("~/Dropbox/salt BT round 2/ggtreeheatv3bio_monly.pdf",width=8,height=10)#
gtree <- ggtree(hier.phynodenams,ladderize=F,color="gray") + geom_hilight(data=filldat, mapping=aes(node=id, fill=type,extend=5),show.legend=FALSE)  + geom_nodelab()#
p <- gtree + new_scale_fill()#
p1 <- gheatmap(p, biotodf[,c(1:4)],  high=rgb(1,0,0),low="gray",offset=0, width=.1,#)#. , #,#
              colnames_angle=90, colnames_offset_y = 17)#
p2 <-gheatmap(p1, biotodf[,c(5:8)], offset=0.075, width=.1,#
         colnames_angle=90, colnames_offset_y = 20 ,  high=rgb(0.75,0,0),low="gray",legend_title="times outlier") #
p3 <- p2 + new_scale_fill()#
p3 <-gheatmap(p3, biotodf[,c(9:12)], offset=0.15, width=.1,#
         colnames_angle=90, colnames_offset_y = 20, high=rgb(0,0,1),low="gray",legend_title="times outlier")#
p3#
dev.off()#
#
pdf("~/Dropbox/salt BT round 2/ggtreeheatv3intervalbio_monly.pdf",width=8,height=10)#
gtree <- ggtree(hier.phynodenams,ladderize=F,color="gray") + geom_hilight(data=filldat, mapping=aes(node=id, fill=type,extend=5),show.legend=FALSE)  + geom_nodelab()#
p <- gtree + new_scale_fill()#
p1 <- gheatmap(p, biotodfpn[,c(1:4)],  high=rgb(1,0,0),low="gray",offset=0, width=.1,#)#. , #,#
              colnames_angle=90, colnames_offset_y = 17)#
p2 <-gheatmap(p1, biotodfpn[,c(5:8)], offset=0.075, width=.1,#
         colnames_angle=90, colnames_offset_y = 20 ,  high=rgb(0.75,0,0),low="gray",legend_title="times outlier") #
p3 <- p2 + new_scale_fill()#
p3 <-gheatmap(p3, biotodfpn[,c(9:12)], offset=0.15, width=.1,#
         colnames_angle=90, colnames_offset_y = 20, high=rgb(0,0,1),low="gray",legend_title="times outlier")#
p3#
dev.off()
str(biogenotrt)
head(biogenotrt)
colnames(biodat)
14*8
14*7
6*8
5*8
7*8
###microbes and plant growth & balances analysis#
biogeno4corM <- (biogenotrt[c(42,44,46,48,74,76,78,80,50,52,54,56),]) #alternating means only inoculated#
row.names(biogeno4corM) <- c("F10.00","F10.0S","F10.B0","F10.BS","epix.00","epix.0S","epix.B0","epix.BS","od600.00","od600.0S","od600.B0","od600.BS")#
tipisoutbio <- tipxout(biogeno4corM,bal.phy,hier.phy)#
nBtipisout <- list()#
for(i in 1:1000){#
	nbiogeno4corM <- biogeno4corM[,sample(1:ncol(biogeno4corM),repl=F)]#
	nBtipisout[[i]] <-  tipxout(nbiogeno4corM,bal.phy,hier.phy)#
}#
Breord <- lapply(1:ncol(tipisoutbio), function(prd) sapply(1:length(nBtipisout), function(n) nBtipisout[[n]][,prd]) )#
Bint <- sapply(1:ncol(tipisoutbio), function(p) sapply(1:nrow(tipisoutbio),function(T) findInterval(tipisoutbio[T,p],sort(Breord[[p]][T,]) ,left.open=T )/length(Breord[[p]][T,]) ) )#
Btipisoutpernode <- Bint#
Btipisoutpernode [Btipisoutpernode<0.95] <- 0#
#
row.names(tipisoutbio)<- hier.phy3$tip.label#
row.names(Btipisoutpernode)<- hier.phy3$tip.label#
biotodf <- as.data.frame(tipisoutbio)#
biotodfpn <- as.data.frame(Btipisoutpernode)#
colnames(biotodf) <-  c("F10"," ","F10BZT","  ","epix"," ","epixBZT","  ","od600"," ","od600BZT","  ")#
colnames(biotodfpn) <- c("F10"," ","F10BZT","  ","epix"," ","epixBZT","  ","od600"," ","od600BZT","  ")#
pdf("~/Dropbox/salt BT round 2/ggtreeheatv3bio_monly.pdf",width=8,height=10)#
gtree <- ggtree(hier.phynodenams,ladderize=F,color="gray") + geom_hilight(data=filldat, mapping=aes(node=id, fill=type,extend=5),show.legend=FALSE)  + geom_nodelab()#
p <- gtree + new_scale_fill()#
p1 <- gheatmap(p, biotodf[,c(1:4)],  high=rgb(1,0,0),low="gray",offset=0, width=.1,#)#. , #,#
              colnames_angle=90, colnames_offset_y = 17)#
p2 <-gheatmap(p1, biotodf[,c(5:8)], offset=0.075, width=.1,#
         colnames_angle=90, colnames_offset_y = 20 ,  high=rgb(0.75,0,0),low="gray",legend_title="times outlier") #
p3 <- p2 + new_scale_fill()#
p3 <-gheatmap(p3, biotodf[,c(9:12)], offset=0.15, width=.1,#
         colnames_angle=90, colnames_offset_y = 20, high=rgb(0,0,1),low="gray",legend_title="times outlier")#
p3#
dev.off()#
pdf("~/Dropbox/salt BT round 2/ggtreeheatv3intervalbio_monly.pdf",width=8,height=10)#
gtree <- ggtree(hier.phynodenams,ladderize=F,color="gray") + geom_hilight(data=filldat, mapping=aes(node=id, fill=type,extend=5),show.legend=FALSE)  + geom_nodelab()#
p <- gtree + new_scale_fill()#
p1 <- gheatmap(p, biotodfpn[,c(1:4)],  high=rgb(1,0,0),low="gray",offset=0, width=.1,#)#. , #,#
              colnames_angle=90, colnames_offset_y = 17)#
p2 <-gheatmap(p1, biotodfpn[,c(5:8)], offset=0.075, width=.1,#
         colnames_angle=90, colnames_offset_y = 20 ,  high=rgb(0.75,0,0),low="gray",legend_title="times outlier") #
p3 <- p2 + new_scale_fill()#
p3 <-gheatmap(p3, biotodfpn[,c(9:12)], offset=0.15, width=.1,#
         colnames_angle=90, colnames_offset_y = 20, high=rgb(0,0,1),low="gray",legend_title="times outlier")#
p3#
dev.off()#
###no microbes#
#
maanssN <-rbind(mixAAsaltn,mixAAnosaltn)#
	rownames(maanssN) <- c( colnames(mixAA), paste(colnames(mixAA),"_S",sep="")  )#
tipisoutN <- tipxout(maanssN,subbalphy,hier.phy)#
ntipisoutN <- list()#
for(i in 1:1000){#
	nmaanssN <- maanssN[,sample(1:ncol(maanssN),repl=F)]#
	ntipisoutN[[i]] <-  tipxout(nmaanssN,subbalphy,hier.phy)#
}#
reordN <- lapply(1:ncol(tipisoutN), function(prd) sapply(1:length(ntipisoutN), function(n) ntipisoutN[[n]][,prd]) )#
intN <- sapply(1:ncol(tipisoutN), function(p) sapply(1:nrow(tipisoutN),function(T) findInterval(tipisoutN[T,p],sort(reordN[[p]][T,]) ,left.open=T )/length(reord[[p]][T,]) ) )#
tipisoutpernodeN <- intN#
tipisoutpernodeN [tipisoutpernodeN<0.95] <- 0#
reorderTON <- tipisoutN[,c(1,9,2,10,3,11,4,12,5,13,6,14,7,15,8,16)] #first is salt then without salt#
row.names(reorderTON)<- hier.phy3$tip.label#
reorderTOpnN <- tipisoutpernodeN[,c(1,9,2,10,3,11,4,12,5,13,6,14,7,15,8,16)]#
row.names(reorderTOpnN)<- hier.phy3$tip.label#
rotodf <- as.data.frame(reorderTON)#
rotodfpn <- as.data.frame(reorderTOpnN)#
transfnames <- c("BZT","gly.BZT","BZTa+aa","aniline","amino3ph","phenanzine","mBZT","moxyBZT")#
colnames(rotodf) <- c("BZT"," ","gly.BZT"," ","BZTa+aa"," ","aniline","aniline","amino3ph"," ","phenanzine"," ","mBZT"," ","moxyBZT"," ")#
colnames(rotodfpn) <- c("BZT"," ","gly.BZT"," ","BZTa+aa"," ","aniline","aniline","amino3ph"," ","phenanzine"," ","mBZT"," ","moxyBZT"," ")#
#transformation products balance plots#
pdf("~/Dropbox/salt BT round 2/testggtreeheatv3_nonly.pdf",width=8,height=10)#
gtree <- ggtree(hier.phynodenams,ladderize=F,color="gray") + geom_hilight(data=filldat, mapping=aes(node=id, fill=type,extend=5),show.legend=FALSE)  + geom_nodelab()#
p <- gtree + new_scale_fill()#
p1 <- gheatmap(p, rotodf[,c(3:4)],  high=rgb(1,0,0),low="gray",offset=0, width=.1,#)#. , #,#
              colnames_angle=90, colnames_offset_y = 17)#
p2 <-gheatmap(p1, rotodf[,c(5:6)], offset=0.075, width=.1,#
         colnames_angle=90, colnames_offset_y = 20 ,  high=rgb(0.75,0,0),low="gray",legend_title="times outlier") #
p3 <- p2 + new_scale_fill()#
p3 <-gheatmap(p3, rotodf[,c(13:14)], offset=0.15, width=.1,#
         colnames_angle=90, colnames_offset_y = 13)#
p4 <-gheatmap(p3, rotodf[,c(15:16)], offset=0.225, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0.75,0,0.75),low="gray",legend_title="times outlier") #
p5 <- p4 + new_scale_fill()#
p5 <- gheatmap(p5, rotodf[,c(9:10)], offset=0.30, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0,0,1),low="gray") #
p6 <- gheatmap(p5, rotodf[,c(11:12)], offset=0.375, width=.1,#
         colnames_angle=90, colnames_offset_y = 25,  high=rgb(0,0,0.75),low="gray",legend_title="times outlier") #
p6#
dev.off()#
pdf("~/Dropbox/salt BT round 2/testggtreeheatv3interval_nonly.pdf",width=8,height=10)#
gtree <- ggtree(hier.phynodenams,ladderize=F,color="gray") + geom_hilight(data=filldat, mapping=aes(node=id, fill=type,extend=5),show.legend=FALSE)  + geom_nodelab()#
p <- gtree + new_scale_fill()#
p1 <- gheatmap(p, rotodfpn[,c(3:4)],  high=rgb(1,0,0),low="gray",offset=0, width=.1,#)#. , #,#
              colnames_angle=90, colnames_offset_y = 17)#
p2 <-gheatmap(p1, rotodfpn[,c(5:6)], offset=0.075, width=.1,#
         colnames_angle=90, colnames_offset_y = 20 ,  high=rgb(0.75,0,0),low="gray",legend_title="interval") #
p3 <- p2 + new_scale_fill()#
p3 <-gheatmap(p3, rotodfpn[,c(13:14)], offset=0.15, width=.1,#
         colnames_angle=90, colnames_offset_y = 13)#
p4 <-gheatmap(p3, rotodfpn[,c(15:16)], offset=0.225, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0.75,0,0.75),low="gray",legend_title="interval") #
p5 <- p4 + new_scale_fill()#
p5 <- gheatmap(p5, rotodfpn[,c(9:10)], offset=0.30, width=.1,#
         colnames_angle=90, colnames_offset_y = 21,  high=rgb(0,0,1),low="gray") #
p6 <- gheatmap(p5, rotodfpn[,c(11:12)], offset=0.375, width=.1,#
         colnames_angle=90, colnames_offset_y = 25,  high=rgb(0,0,0.75),low="gray",legend_title="interval") #
p6#
dev.off()#
#
biogeno4corN <- (biogenotrt[c(41,43,45,47,73,75,77,79,49,51,53,55),]) #alternating means only inoculated#
row.names(biogeno4corN) <- c("F10.00","F10.0S","F10.B0","F10.BS","epix.00","epix.0S","epix.B0","epix.BS","od600.00","od600.0S","od600.B0","od600.BS")#
tipisoutbioN <- tipxout(biogeno4corN,bal.phy,hier.phy)#
nBtipisoutN <- list()#
for(i in 1:1000){#
	nbiogeno4corN <- biogeno4corN[,sample(1:ncol(biogeno4corN),repl=F)]#
	nBtipisoutN[[i]] <-  tipxout(nbiogeno4corN,bal.phy,hier.phy)#
}#
BreordN <- lapply(1:ncol(tipisoutbioN), function(prd) sapply(1:length(nBtipisoutN), function(n) nBtipisoutN[[n]][,prd]) )#
BintN <- sapply(1:ncol(tipisoutbioN), function(p) sapply(1:nrow(tipisoutbioN),function(T) findInterval(tipisoutbioN[T,p],sort(BreordN[[p]][T,]) ,left.open=T )/length(BreordN[[p]][T,]) ) )#
Btipisoutpernode <- BintN#
Btipisoutpernode [Btipisoutpernode<0.95] <- 0#
#
row.names(tipisoutbioN)<- hier.phy3$tip.label#
row.names(Btipisoutpernode)<- hier.phy3$tip.label#
biotodf <- as.data.frame(tipisoutbioN)#
biotodfpn <- as.data.frame(Btipisoutpernode)#
colnames(biotodf) <-  c("F10"," ","F10BZT","  ","epix"," ","epixBZT","  ","od600"," ","od600BZT","  ")#
colnames(biotodfpn) <- c("F10"," ","F10BZT","  ","epix"," ","epixBZT","  ","od600"," ","od600BZT","  ")#
pdf("~/Dropbox/salt BT round 2/ggtreeheatv3bio_nonly.pdf",width=8,height=10)#
gtree <- ggtree(hier.phynodenams,ladderize=F,color="gray") + geom_hilight(data=filldat, mapping=aes(node=id, fill=type,extend=5),show.legend=FALSE)  + geom_nodelab()#
p <- gtree + new_scale_fill()#
p1 <- gheatmap(p, biotodf[,c(1:4)],  high=rgb(1,0,0),low="gray",offset=0, width=.1,#)#. , #,#
              colnames_angle=90, colnames_offset_y = 17)#
p2 <-gheatmap(p1, biotodf[,c(5:8)], offset=0.075, width=.1,#
         colnames_angle=90, colnames_offset_y = 20 ,  high=rgb(0.75,0,0),low="gray",legend_title="times outlier") #
p3 <- p2 + new_scale_fill()#
p3 <-gheatmap(p3, biotodf[,c(9:12)], offset=0.15, width=.1,#
         colnames_angle=90, colnames_offset_y = 20, high=rgb(0,0,1),low="gray",legend_title="times outlier")#
p3#
dev.off()#
pdf("~/Dropbox/salt BT round 2/ggtreeheatv3intervalbio_nonly.pdf",width=8,height=10)#
gtree <- ggtree(hier.phynodenams,ladderize=F,color="gray") + geom_hilight(data=filldat, mapping=aes(node=id, fill=type,extend=5),show.legend=FALSE)  + geom_nodelab()#
p <- gtree + new_scale_fill()#
p1 <- gheatmap(p, biotodfpn[,c(1:4)],  high=rgb(1,0,0),low="gray",offset=0, width=.1,#)#. , #,#
              colnames_angle=90, colnames_offset_y = 17)#
p2 <-gheatmap(p1, biotodfpn[,c(5:8)], offset=0.075, width=.1,#
         colnames_angle=90, colnames_offset_y = 20 ,  high=rgb(0.75,0,0),low="gray",legend_title="times outlier") #
p3 <- p2 + new_scale_fill()#
p3 <-gheatmap(p3, biotodfpn[,c(9:12)], offset=0.15, width=.1,#
         colnames_angle=90, colnames_offset_y = 20, high=rgb(0,0,1),low="gray",legend_title="times outlier")#
p3#
dev.off()
head(transf)
head(mixAA)
mixAAtrt <- cbind(transf$Genotype, transf$Salt, transf$Microbes, transf$density, transf$km, mixAA)
head(mixAAtrt)
mixAAtrt <- cbind(transf$Genotype, transf$Salt, Microbes = transf$Microbes, transf$density, transf$km, mixAA)
head(mixAAtrt)
mixAAtrt <- cbind(transf$Genotype, transf$Salt, Microbes = transf$Microbes, transf$density, transf$km, mixAA)
head(mixAAtrt)
mixAAtrt <- cbind(Genotype=transf$Genotype, Salt=transf$Salt, Microbes = transf$Microbes, rddens =transf$density, km= transf$km, mixAA)
head(mixAAtrt)
summary(MCMCglmm(conc_corrected~Microbes + Salt +rddens + rddens:Salt + rddens:Microbes + rddens:Microbes:Salt,data=transf,nitt=10000,verbose=F)#
)
MCMCglmm(conc_corrected~Microbes + Salt +rddens + rddens:Salt + rddens:Microbes + rddens:Microbes:Salt,data=mixAAtrt,nitt=10000,verbose=F)
summary(MCMCglmm(conc_corrected~Microbes + Salt +rddens + rddens:Salt + rddens:Microbes + rddens:Microbes:Salt,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(conc_corrected~Microbes + Salt +rddens + rddens:Salt + rddens:Microbes ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(conc_corrected~Microbes + Salt +rddens +rddens:Microbes ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(conc_corrected~Microbes + Salt +rddens + rddens:Salt  ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(conc_corrected~Microbes + Salt +rddens  ,data=mixAAtrt,nitt=10000,verbose=F))
head(mixAA)
head(transf)
summary(MCMCglmm(glycosylatedBZT ~Microbes + Salt +rddens + rddens:Salt + rddens:Microbes + rddens:Microbes:Salt,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(glycosylatedBZT ~Microbes + Salt +rddens + rddens:Salt + rddens:Microbes ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(glycosylatedBZT ~Microbes + Salt +rddens + rddens:Salt + ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(glycosylatedBZT ~Microbes + Salt +rddens + rddens:Salt  ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(glycosylatedBZT ~Microbes + Salt +rddens + rddens:Microbes ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(glycosylatedBZT ~Microbes + Salt +rddens ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(glycosylatedBZT ~Microbes + Salt ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(glycosylatedBZT ~ Salt +rddens ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(glycosylatedBZT ~Microbes  +rddens ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(glycosylatedBZT ~Microbes ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(glycosylatedBZT ~Salt ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(glycosylatedBZT ~rddens ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(BZTa+BZTaa ~Microbes + Salt +rddens + rddens:Salt + rddens:Microbes + rddens:Microbes:Salt,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm("BZTa+BZTaa" ~Microbes + Salt +rddens + rddens:Salt + rddens:Microbes + rddens:Microbes:Salt,data=mixAAtrt,nitt=10000,verbose=F))
colnames(mixAAtrt)[colnames(mixAAtrt)=="BZTa+BZTaa"] <- "BZTaplusBZTaa"
head(mixAAtrt)
summary(MCMCglmm(BZTaplusBZTaa ~Microbes + Salt +rddens + rddens:Salt + rddens:Microbes + rddens:Microbes:Salt,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(BZTaplusBZTaa ~Microbes + Salt +rddens + rddens:Salt + rddens:Microbes ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(BZTaplusBZTaa ~Microbes + Salt +rddens + rddens:Salt + ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(BZTaplusBZTaa ~Microbes + Salt +rddens + rddens:Salt  ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(BZTaplusBZTaa ~Microbes + Salt +rddens +  ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(BZTaplusBZTaa ~Microbes + Salt +rddens  ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(BZTaplusBZTaa ~ Salt +rddens  ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(BZTaplusBZTaa ~ rddens  ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(phenanzine ~Microbes + Salt +rddens + rddens:Salt + rddens:Microbes + rddens:Microbes:Salt,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(phenazine ~Microbes + Salt +rddens + rddens:Salt + rddens:Microbes + rddens:Microbes:Salt,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(phenazine ~Microbes + Salt +rddens + rddens:Salt + rddens:Microbes ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(phenazine ~Microbes + Salt +rddens +  rddens:Microbes ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(phenazine ~Microbes + Salt +rddens ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(phenazine ~  Salt +rddens ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(phenazine ~Microbes  +rddens ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(phenazine ~  rddens ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(conc_corrected~ Salt +rddens  ,data=mixAAtrt,nitt=10000,verbose=F))
summary(MCMCglmm(BZTaplusBZTaa ~ rddens  ,data=mixAAtrt,nitt=10000,verbose=F))
library(UpSetR) #for set plots#
library(MCMCglmm) #for models#
library(grDevices) #for color#
#
HPDi <- function(vect,prob){#
	int <- HPDinterval(as.mcmc(vect),prob=prob)#
	return(int)#
}#
#
invlogistic <- function(x){exp(x)/(1+ exp(x))}#
std.error <- function(dat, na.rm=TRUE) {sd(dat,na.rm=na.rm)/sqrt(length(dat))}#defaults to na.rm=T#
#################################################################################
####read in data#
#################################################################################
# analyze WOS records for AjB lit review on influence of microbes plant phenology#
setwd("~/MicrobesAndPhenology/")#
#
# wos_recs <- read.csv("~/saved records WOS friday sep 11 2020 - WOS records.tsv",#
# 					sep="\t",stringsAsFactors=F,na.strings = c("NA",""))#
#
cwos_recs <- read.csv("saved records WOS friday sep 11 2020 - 500scoredWOSrecords.csv",#
					stringsAsFactors=F,na.strings = c("NA","")) #
# split_recs <- read.csv("trimmed RECORDS FOR SPLITTING v4.csv", #sep="\t",#
split_recs <- read.csv("saved records WOS friday sep 11 2020 - Split Records.csv", #sep="\t",#
					stringsAsFactors=F,na.strings = c("NA","")) #
split_recs_scr <- split_recs[!is.na(split_recs$direction.effect.split),] #
	#several records were not possible to score for effect direction; but were relevant to microbial effects on phenology#
#
#################################################################################
####Analysis of all broadly relevant records			#
#################################################################################
relevant <- cwos_recs$"Relevant..Y.N"=="y"#
PMo <- as.numeric(as.factor(cwos_recs$otherPhenMicrLink=="y")) -1 #other link between phenology, plants and microbes#
MiP <- as.numeric(as.factor(cwos_recs$MicrobesAffectPhenology=="y")) -1 # microbes influence plant phenology#
#
table(relevant)#
table(PMo)#
table(MiP)#
table(cwos_recs$anyeffect)#
#
wos_rel <- cwos_recs[which(relevant),]#
wos_MiP <- cwos_recs[which(MiP==1),]#
#
taxand <- gsub("; ", wos_rel$micrtax,replacement="&")#
locand <- gsub("; ", wos_rel$micrloc,replacement="&")#
phenand <- gsub("; ", wos_rel$phentrait_of,replacement="&")#
#
pdf("upsetrtax.pdf",width=4,height=5)#
upset(fromExpression(table(taxand)),nsets=15, order.by = "freq")#
dev.off()#
pdf("upsetrloc.pdf",width=4,height=5)#
upset(fromExpression(table(locand)),nsets=10, order.by = "freq")#
dev.off()#
pdf("upsetrtrt.pdf",width=4,height=5)#
upset(fromExpression(table(phenand)), nsets=15, order.by = "freq")#
dev.off()#
#################################################################################
####Analysis of phenological timing records#
#################################################################################
#
##numbers for text#
#
split_recs$anyeffnum <- as.numeric(as.factor(split_recs$anyeffect))-1#
#by microbe tax#
sum(   tapply(split_recs$anyeffnum[split_recs$micrtax=="MF"],split_recs$WOS.relevance.rank[split_recs$micrtax=="MF"],sum) ==0)#4#
length(unique(split_recs$WOS.relevance.rank[split_recs$micrtax=="MF"] ))#20#
sum(   tapply(split_recs$anyeffnum[split_recs$micrtax=="bacteria"],split_recs$WOS.relevance.rank[split_recs$micrtax=="bacteria"],sum) ==0)#1#
length(unique(split_recs$WOS.relevance.rank[split_recs$micrtax=="bacteria"] )) #25#
length(table(split_recs$WOS.relevance.rank[split_recs$micrloc=="multiple"])) #14#
length(unique(split_recs$WOS.relevance.rank[split_recs$micrtax=="otherfungi"] ))#18#
length(unique(split_recs$WOS.relevance.rank[split_recs$micrtax=="mixed"] ))#16#
#by phenophase#
sum(   tapply(split_recs$anyeffnum[split_recs$phentrait=="flowering time"],split_recs$WOS.relevance.rank[split_recs$phentrait=="flowering time"],sum) ==0)#43#
length(unique(split_recs$WOS.relevance.rank[split_recs$phentrait=="flowering time"]))#6#
sum(   tapply(split_recs$anyeffnum[split_recs$phentrait=="germination time"],split_recs$WOS.relevance.rank[split_recs$phentrait=="germination time"],sum) ==0)#2#
length(unique(split_recs$WOS.relevance.rank[split_recs$phentrait=="germination time"]))#19#
sum(   tapply(split_recs$anyeffnum[split_recs$phentrait=="germination prb"],split_recs$WOS.relevance.rank[split_recs$phentrait=="germination prb"],sum) ==0)#1#
length(unique(split_recs$WOS.relevance.rank[split_recs$phentrait=="germination prb"]))#26#
sum(   tapply(split_recs$anyeffnum[split_recs$phentrait=="fruiting time"],split_recs$WOS.relevance.rank[split_recs$phentrait=="fruiting time"],sum) ==0)#1#
length(unique(split_recs$WOS.relevance.rank[split_recs$phentrait=="fruiting time"]))#7#
sum(   tapply(split_recs$anyeffnum[split_recs$phentrait=="senescence time"],split_recs$WOS.relevance.rank[split_recs$phentrait=="senescence time"],sum) ==0)#1#
length(unique(split_recs$WOS.relevance.rank[split_recs$phentrait=="senescence time"]))#2#
sum(   tapply(split_recs$anyeffnum[split_recs$phentrait%in% c("phyllochron","budburst")],split_recs$WOS.relevance.rank[split_recs$phentrait %in% c("phyllochron","budburst") ],sum) ==0)#1#
length(unique(split_recs$WOS.relevance.rank[split_recs$phentrait %in% c("phyllochron","budburst") ])) #9#
##
table(split_recs$microbeNPHO)#
length(unique(split_recs$WOS.relevance.rank[split_recs$lifeform=="annual" | split_recs$lifeform=="both"]))#
length(unique(split_recs$WOS.relevance.rank[split_recs$lifeform=="perennial"]))#
#appendix S8#
apps8 <- cbind(names(table(split_recs$plant.family)),table(split_recs$plant.family), #
	sapply(sort(unique(split_recs$plant.family)), function(fam) #
		 length(unique(split_recs$WOS.relevance.rank[split_recs$plant.family==fam])) )#
	)#
colnames(apps8) <- c("Plant Family","Number of Tests","Number of Studies")#
write.csv(apps8,"AppendixS8.csv",row.names=F)	#
#
#repeat above alternately for subset data, if exclude records that could not be split: some observed effects, but are not included in model results#
split_recs_scr$anyeffnum <- as.numeric(as.factor(split_recs_scr$anyeffect))-1 ##
#
###more numbers reported in text:#
flowering$anyeffnum <- as.numeric(as.factor(flowering$anyeffect))-1#
sum(tapply(flowering$anyeffnum,flowering$WOS.relevance.rank,sum) == 0) #6#
length(tapply(flowering$anyeffnum,flowering$WOS.relevance.rank,sum))#40#
germtime$anyeffnum <- as.numeric(as.factor(germtime$anyeffect))-1#
sum(tapply(germtime$anyeffnum,germtime$WOS.relevance.rank,sum) ==0)#2 #
length(tapply(germtime$anyeffnum,germtime$WOS.relevance.rank,sum))#19#
germprb$anyeffnum <- as.numeric(as.factor(germprb$anyeffect))-1 #
sum(tapply(germprb$anyeffnum,germprb$WOS.relevance.rank,sum) ==0)#1#
length(tapply(germprb$anyeffnum,germprb$WOS.relevance.rank,sum))#25#
length(unique(c(germprb$WOS.relevance.rank, germtime$WOS.relevance.rank)))#overlap 29#
sapply(sort(unique(split_recs_scr$microbeNPHO)), function(z) sapply(sort(unique(split_recs_scr$micrtax)), function(k) sum(split_recs_scr$micrtax==k & split_recs_scr$microbeNPHO==z) ) )#
sapply(sort(unique(split_recs_scr$micrloc)), function(z) sapply(sort(unique(split_recs_scr$micrtax)), function(k) sum(split_recs_scr$micrtax==k & split_recs_scr$micrloc==z) ) )#
sapply(sort(unique(split_recs_scr$micrloc)), function(z) sapply(sort(unique(split_recs_scr$microbeNPHO)), function(k) sum(split_recs_scr$microbeNPHO==k & split_recs_scr$micrloc==z) ) )#
##split early/delay/expanded/narrowed into binomial#
numeric.phen.eff <- rep(NA, length=nrow(split_recs_scr))#
numeric.phen.eff[split_recs_scr$direction.effect.split=="earlier"] <- -1#
numeric.phen.eff[split_recs_scr$direction.effect.split=="delayed"] <- 1#
numeric.phen.eff[split_recs_scr$direction.effect.split=="none"] <- 0#
numeric.phen.eff[split_recs_scr$direction.effect.split=="expanded"] <- 1#
numeric.phen.eff[split_recs_scr$direction.effect.split=="narrowed"] <- -1#
split_recs_scr$numeric.phen.eff <- numeric.phen.eff#
split_recs_scr$isEarlyOrNrw <- ifelse(numeric.phen.eff=="-1",1,0)#
split_recs_scr$notEarlyOrNrw <- 1-split_recs_scr$isEarlyOrNrw#
split_recs_scr$isDelayOrExp <- ifelse(numeric.phen.eff=="1",1,0)#
split_recs_scr$notDelayOrExp <- 1-split_recs_scr$isDelayOrExp#
split_recs_scr$isSig <- ifelse(numeric.phen.eff=="1" | numeric.phen.eff=="-1",1,0)#
split_recs_scr$notSig <- 1- split_recs_scr$isSig #
#rotate levels for evaluating significant differences among all groups#
split_recs_scr$micrtaxmfa <- split_recs_scr$micrtax#
split_recs_scr$micrtaxmfa[split_recs_scr$micrtaxmfa=="MF"] <- "0MF"#
split_recs_scr$micrtaxmixa <- split_recs_scr$micrtax#
split_recs_scr$micrtaxmixa[split_recs_scr$micrtaxmixa=="mixed"] <- "0mix"#
##
split_recs_scr$strainvcommsa <- split_recs_scr$inoctype#
split_recs_scr$strainvcommsa[split_recs_scr$strainvcommsa=="strain"] <- "0strain"#
##
split_recs_scr$lifeformpa <- split_recs_scr$lifeform#
split_recs_scr$lifeformpa[split_recs_scr$lifeformpa == "perennial"] <- "0perennial"#
##
split_recs_scr$mphpa <- split_recs_scr$microbeNPHO#
split_recs_scr$mphpa[split_recs_scr$mphpa == "pathogen"] <- "0path"#
split_recs_scr$mphba <- split_recs_scr$microbeNPHO#
split_recs_scr$mphba[split_recs_scr$mphba == "other beneficial"] <- "0ob"#
##
split_recs_scr$micrlocseeda <- split_recs_scr$micrloc#
split_recs_scr$micrlocseeda[split_recs_scr$micrlocseeda=="seed"] <- "0seed"#
split_recs_scr$micrlocshoota <- split_recs_scr$micrloc#
split_recs_scr$micrlocshoota[split_recs_scr$micrlocshoota=="shoot"] <- "0shoot"#
##
split_recs_scr$phentraitfba <- split_recs_scr$phentrait#
split_recs_scr$phentraitfba[split_recs_scr$phentrait=="floral budset time"] <- "0fbt"#
split_recs_scr$phentraitfla <- split_recs_scr$phentrait#
split_recs_scr$phentraitfla[split_recs_scr$phentrait=="flowering time"] <- "0flwr"#
split_recs_scr$phentraitfra <- split_recs_scr$phentrait#
split_recs_scr$phentraitfra[split_recs_scr$phentrait=="fruiting time"] <- "0frt"#
split_recs_scr$phentraitga <- split_recs_scr$phentrait#
split_recs_scr$phentraitga[split_recs_scr$phentrait=="germination time"] <- "0gt"#
split_recs_scr$phentraitfda <- split_recs_scr$phentrait#
split_recs_scr$phentraitfda[split_recs_scr$phentrait=="flowering duration"] <- "0fd"#
#
#function to pool studies with few tests into one category; otherwise random effects cannot be estimated, and random effects are important to weight impacts of studies with many tests#
wosbin <- function(dataframe, woscolname,nrecs){#
	dataframe$dummyWOSrelrank <- dataframe[,woscolname]#
	dataframe$dummyWOSrelrank[dataframe$dummyWOSrelran%in%names(table(dataframe$WOS.relevance.rank)[table(dataframe$WOS.relevance.rank)<nrecs])] <- "binned"#
	return(dataframe)#
}#
#
flowering <- wosbin(split_recs_scr[split_recs_scr$phentrait=="flowering time",],"WOS.relevance.rank",15)#
	## *** LOW SAMPLE REMOVALS FOR TOTAL TESTS, NOTE THAT SOMETIMES THERE IS STILL ONLY ONE STUDY PER CATEGORY ***#
	#low sample, removing: virus = 9#
	flowerTAX    <- wosbin(split_recs_scr[split_recs_scr$phentrait=="flowering time" & split_recs_scr$micrtax !="virus",],"WOS.relevance.rank",15)#
	#there are 0 records for seed microbe impacts on in flowering time#
	floweringMAT <- wosbin(split_recs_scr[split_recs_scr$phentrait=="flowering time" & split_recs_scr$mating != "unk" & split_recs_scr$mating != "s+o",],"WOS.relevance.rank",15)#
	#low sample, removing: phytoH = 6#
	floweringMPH <- wosbin(split_recs_scr[split_recs_scr$phentrait=="flowering time" & !split_recs_scr$microbeNPHO%in%c( "unknown","phytohormones"),],"WOS.relevance.rank",15)#
germtime <- wosbin(split_recs_scr[split_recs_scr$phentrait=="germination time",],"WOS.relevance.rank",15)#
	#0 records of MF on germination time#
	#low sample, removing: shoot = 4, #
	germtimeLOC <- wosbin(split_recs_scr[split_recs_scr$phentrait=="germination time" & split_recs_scr$micrloc != "shoot",],"WOS.relevance.rank",15)#
	germtimeMAT <- wosbin(split_recs_scr[split_recs_scr$phentrait=="germination time" & split_recs_scr$mating != "unk" & split_recs_scr$mating != "s+o",],"WOS.relevance.rank",15)#
	#low sample, removing: phytoH = 3 path = 5#
	germtimeMPH <- wosbin(split_recs_scr[split_recs_scr$phentrait=="germination time" & !split_recs_scr$microbeNPHO %in%c("unknown","pathogen","phytohormones"),],"WOS.relevance.rank",15)#
germprb <- wosbin(split_recs_scr[split_recs_scr$phentrait=="germination prb",],"WOS.relevance.rank",15)#
	#low sample, removing: MF, size = 2#
	germprbTAX <- wosbin(split_recs_scr[split_recs_scr$phentrait=="germination prb" & split_recs_scr$micrtax !="MF",],"WOS.relevance.rank",15)#
	germprbMAT <- wosbin(split_recs_scr[split_recs_scr$phentrait=="germination prb" & split_recs_scr$mating != "unk" & split_recs_scr$mating != "s+o",],"WOS.relevance.rank",15)#
	#low sample; removing: pathogen = 9; phytohormones is 0#
	germprbMPH <- wosbin(split_recs_scr[split_recs_scr$phentrait=="germination prb" & !split_recs_scr$microbeNPHO%in% c("unknown","pathogen"),],"WOS.relevance.rank",15)#
	#low sample, removing: shoot = 4#
	germprbLOC <- wosbin(split_recs_scr[split_recs_scr$phentrait=="germination prb" & split_recs_scr$micrloc != "shoot",],"WOS.relevance.rank",15)#
#low sample traits, removing, mat time=4, senec time = 2, peak flower = 9, flower sen. time = 4; floral bud duration = 9#
allphen <- wosbin(split_recs_scr[!is.na(split_recs_scr$phentrait) & (split_recs_scr$phentrait%in% c("budburst","floral budset time","flowering time","phyllochron","fruiting time","germination time")),],"WOS.relevance.rank",15)
weightmns2 <- function(dataframelist, cols,dfwithnames){#
	typelist <- lapply(1:length(cols), function(x) sort(unique( dfwithnames[ ,cols[x] ] )))#
	wos <- lapply(dataframelist, function(dat) sort(unique(dat$dummyWOSrelrank) ) )#
	xEmn <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wos[[type]], function(w)  #
			mean(dataframelist[[type]]$isEarlyOrNrw[dataframelist[[type]]$dummyWOSrelrank==w & dataframelist[[type]][,which(colnames(dataframelist[[type]])==cols[type])]==m] )#
			   )))#
	xE.m <- unlist( lapply(1:length(xEmn), function(T)   colMeans(xEmn[[T]],na.rm=T)))#
	xEse <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wos[[type]], function(w)  #
			std.error(dataframelist[[type]]$isEarlyOrNrw[dataframelist[[type]]$dummyWOSrelrank==w & dataframelist[[type]][,which(colnames(dataframelist[[type]])==cols[type])]==m] )  #
			 )))#
	xE.se <-unlist(lapply(1:length(xEse), function(type)  sapply(1:ncol(xEse[[type]]), function(m) mean(xEse[[type]][,m],na.rm=T))))#
 	xDmn <-  lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wos[[type]], function(w)  #
			mean(dataframelist[[type]]$isDelayOrExp[dataframelist[[type]]$dummyWOSrelrank==w & dataframelist[[type]][,which(colnames(dataframelist[[type]])==cols[type])]==m] )#
			   )))#
	xDse <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wos[[type]], function(w)  #
			std.error(dataframelist[[type]]$isDelayOrExp[dataframelist[[type]]$dummyWOSrelrank==w & dataframelist[[type]][,which(colnames(dataframelist[[type]])==cols[type])]==m] )  #
			 )))#
	xD.m <- unlist(lapply(1:length(xDmn), function(type) colMeans(xDmn[[type]],na.rm=T)))#
	xD.se <-unlist(lapply(1:length(xDse), function(type)  sapply(1:ncol(xDse[[type]]), function(m) mean(xDse[[type]][,m],na.rm=T))))#
	return(list(xE.m,xE.se,xD.m,xD.se))#
}#
#
cols1 <- c("microbeNPHO","micrtax","micrloc") #
flwrdlist <- list(flowering,flowering,flowering)#
germtlist <- list(germtime,germtime,germtime)#
germplist <- list(germprb,germprb,germprb)#
#
flwrE.m <-   weightmns2(flwrdlist,cols=cols1,flowering)[[1]][-c(5,10)] #
flwrE.se <-  weightmns2(flwrdlist,cols=cols1,flowering)[[2]][-c(5,10)]#
flwrD.m <-   weightmns2(flwrdlist,cols=cols1,flowering)[[3]][-c(5,10)]#
flwrD.se <-  weightmns2(flwrdlist,cols=cols1,flowering)[[4]][-c(5,10)]#
germTE.m <-  weightmns2(germtlist,cols=cols1,germtime)[[1]][-5] #
germTE.se <- weightmns2(germtlist,cols=cols1,germtime)[[2]][-5] #
germTD.m <-  weightmns2(germtlist,cols=cols1,germtime)[[3]][-5] #
germTD.se <- weightmns2(germtlist,cols=cols1,germtime)[[4]][-5] #
germPE.m <-  weightmns2(germplist,cols=cols1,germprb)[[1]] #
germPE.se <- weightmns2(germplist,cols=cols1,germprb)[[2]] #
germPD.m <-  weightmns2(germplist,cols=cols1,germprb)[[3]] #
germPD.se <- weightmns2(germplist,cols=cols1,germprb)[[4]] #
#subtracting unknown category in MPH (and virus for flowering, which is only 1 sudy with three tests), which is not useful. leaving in germP to fill gap from phytohormones, of which there are no studies in germination probability#
#fill in from model results#
siggroupsFE <- c("","","", "-", # #mph , at 0.9 "a","ab","b", "-" ; .95 " "," "," ", "-"#
				"ab","a","b","ab",#tax #at 0.9; at .9 "ab","a","b","b"; .95 "ab","a","b","ab"#
				" "," ","-"," ")#, #loc#
siggroupsFD <- c( "","","","-", #"b", #mph # at 0.9 "b","ab","a","-" ; .95 " "," "," ","-",#
				"b","b","a","ab",#tax # same for .95 and .9#
				"ab","b","-","a")#, #loc #at 0.95 or .9 same#
siggroupsGtE <- c("","","-","-", #mph; n.s. at .9  "b","a","-","-", at .95 " "," ","-","-"#
				"a","-","b","a",#tax  #same at .95#
				"","","","-")#, #loc	#
siggroupsGtD <- c(" "," ","-","-",#, #mph#
				"b","-","a","b",#tax # same at .95#
				 "","","","-")#,#loc  ; at .9 "ab","b","a","-"; at .95 " "," "," ","-"#
siggroupsGpE <- c(" "," ","-","-", #mph ****no phytohormone records***#
				"b","-","a","a",#tax; same at .95#
				" "," "," ","-")#, #loc#
siggroupsGpD <- c(" "," ","-","-", #mph ****no phytohormone records***#
				"","-","","",#tax#
				"ab","a","b","-")#, #loc; at .9: a a b; at. 95 "ab","a","b","-"
6748-575
173+211
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(9,4,1,1))#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals[-11],pch=16)#
	points(unlist(flwrD.m)~I(xvals[-11]+0.01),pch=16,col="gray")#
	arrows(x0=xvals[-11] , y0=flwrE.m -flwrE.se, y1 = flwrE.m +flwrE.se,length=0     )#
	arrows(x0=xvals[-11]+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m +flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[8:9])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsFE)#
	text(xvals,y=-0.2,siggroupsFD,col="gray")#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[9],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals[-6],pch=16)#
	points(unlist(germTD.m)~I(xvals[-6]+0.01),pch=16,col="gray")#
	arrows(x0=xvals[-6] , y0=germTE.m -germTE.se, y1 = germTE.m +germTE.se,length=0     )#
	arrows(x0=xvals[-6]+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m +germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[8:9])/2),lty=3 )#
	text(xvals,y=1.2,siggroupsGtE)#
	text(xvals,y=-0.2,siggroupsGtD,col="gray")#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[9],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals, y0=germPE.m -germPE.se, y1 = germPE.m +germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m +germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[8:9])/2),lty=3 )#
	text(xvals,y=1.2,siggroupsGpE)#
	text(xvals,y=-0.2,siggroupsGpD,col="gray")#
	mtext(side=3,"germination probability")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[9],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)#
mtext("microbe mechanism", side = 1, at = mean(xvals[2:3], line=8.5) #
mtext("microbe taxonomy", side = 1, at = mean(xvals[6:7], line=8.5) #
mtext("microbe location", side = 1, at = mean(xvals[10:11], line=8.5)
xvals <- c(seq(from=0,to=1,length.out=c(4+4+4) ))#
# xlab <- c("nutrients","other beneficial","pathogen","phytohormones","bacteria","myc fungi","mixed","other fungi","root","seed","shoot","mult. w/ reprod","mult. w/o reprod")#
xlab <- c("nutrients","other beneficial","pathogen","phytohormones","bacteria","myc fungi","mixed","other fungi","multiple","root","seed","shoot")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(9,4,1,1))#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals[-11],pch=16)#
	points(unlist(flwrD.m)~I(xvals[-11]+0.01),pch=16,col="gray")#
	arrows(x0=xvals[-11] , y0=flwrE.m -flwrE.se, y1 = flwrE.m +flwrE.se,length=0     )#
	arrows(x0=xvals[-11]+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m +flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[8:9])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsFE)#
	text(xvals,y=-0.2,siggroupsFD,col="gray")#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[9],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals[-6],pch=16)#
	points(unlist(germTD.m)~I(xvals[-6]+0.01),pch=16,col="gray")#
	arrows(x0=xvals[-6] , y0=germTE.m -germTE.se, y1 = germTE.m +germTE.se,length=0     )#
	arrows(x0=xvals[-6]+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m +germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[8:9])/2),lty=3 )#
	text(xvals,y=1.2,siggroupsGtE)#
	text(xvals,y=-0.2,siggroupsGtD,col="gray")#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[9],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals, y0=germPE.m -germPE.se, y1 = germPE.m +germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m +germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[8:9])/2),lty=3 )#
	text(xvals,y=1.2,siggroupsGpE)#
	text(xvals,y=-0.2,siggroupsGpD,col="gray")#
	mtext(side=3,"germination probability")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[9],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)#
mtext("microbe mechanism", side = 1, at = mean(xvals[2:3], line=8.5) #
mtext("microbe taxonomy", side = 1, at = mean(xvals[6:7], line=8.5) #
mtext("microbe location", side = 1, at = mean(xvals[10:11], line=8.5)
xvals <- c(seq(from=0,to=1,length.out=c(4+4+4) ))#
# xlab <- c("nutrients","other beneficial","pathogen","phytohormones","bacteria","myc fungi","mixed","other fungi","root","seed","shoot","mult. w/ reprod","mult. w/o reprod")#
xlab <- c("nutrients","other beneficial","pathogen","phytohormones","bacteria","myc fungi","mixed","other fungi","multiple","root","seed","shoot")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(9,4,1,1))#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals[-11],pch=16)#
	points(unlist(flwrD.m)~I(xvals[-11]+0.01),pch=16,col="gray")#
	arrows(x0=xvals[-11] , y0=flwrE.m -flwrE.se, y1 = flwrE.m +flwrE.se,length=0     )#
	arrows(x0=xvals[-11]+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m +flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[8:9])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsFE)#
	text(xvals,y=-0.2,siggroupsFD,col="gray")#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[9],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals[-6],pch=16)#
	points(unlist(germTD.m)~I(xvals[-6]+0.01),pch=16,col="gray")#
	arrows(x0=xvals[-6] , y0=germTE.m -germTE.se, y1 = germTE.m +germTE.se,length=0     )#
	arrows(x0=xvals[-6]+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m +germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[8:9])/2),lty=3 )#
	text(xvals,y=1.2,siggroupsGtE)#
	text(xvals,y=-0.2,siggroupsGtD,col="gray")#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[9],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals, y0=germPE.m -germPE.se, y1 = germPE.m +germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m +germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[8:9])/2),lty=3 )#
	text(xvals,y=1.2,siggroupsGpE)#
	text(xvals,y=-0.2,siggroupsGpD,col="gray")#
	mtext(side=3,"germination probability")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[9],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)#
mtext("microbe mechanism", side = 1, at = mean(xvals[2:3], line=8.5) #
mtext("microbe taxonomy", side = 1, at = mean(xvals[6:7], line=8.5) #
mtext("microbe location", side = 1, at = mean(xvals[10:11], line=8.5)
mtext("microbe mechanism", side = 1, at = mean(xvals[2:3]), line=8.5)
mtext("microbe mechanism", side = 1, at = mean(xvals[2:3]), line=8.5)
mtext("microbe taxonomy", side = 1, at = mean(xvals[6:7]), line=8.5) #
mtext("microbe location", side = 1, at = mean(xvals[10:11]), line=8.5)
pdf("means_ses_and prelim fitted diffs from binom slim 95hpdi.pdf",height=6,width=4)#
xvals <- c(seq(from=0,to=1,length.out=c(4+4+4) ))#
# xlab <- c("nutrients","other beneficial","pathogen","phytohormones","bacteria","myc fungi","mixed","other fungi","root","seed","shoot","mult. w/ reprod","mult. w/o reprod")#
xlab <- c("nutrients","other beneficial","pathogen","phytohormones","bacteria","myc fungi","mixed","other fungi","multiple","root","seed","shoot")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(9,4,1,1))#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals[-11],pch=16)#
	points(unlist(flwrD.m)~I(xvals[-11]+0.01),pch=16,col="gray")#
	arrows(x0=xvals[-11] , y0=flwrE.m -flwrE.se, y1 = flwrE.m +flwrE.se,length=0     )#
	arrows(x0=xvals[-11]+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m +flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[8:9])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsFE)#
	text(xvals,y=-0.2,siggroupsFD,col="gray")#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[9],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals[-6],pch=16)#
	points(unlist(germTD.m)~I(xvals[-6]+0.01),pch=16,col="gray")#
	arrows(x0=xvals[-6] , y0=germTE.m -germTE.se, y1 = germTE.m +germTE.se,length=0     )#
	arrows(x0=xvals[-6]+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m +germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[8:9])/2),lty=3 )#
	text(xvals,y=1.2,siggroupsGtE)#
	text(xvals,y=-0.2,siggroupsGtD,col="gray")#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[9],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals, y0=germPE.m -germPE.se, y1 = germPE.m +germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m +germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[8:9])/2),lty=3 )#
	text(xvals,y=1.2,siggroupsGpE)#
	text(xvals,y=-0.2,siggroupsGpD,col="gray")#
	mtext(side=3,"germination probability")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[9],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)#
mtext("microbe mechanism", side = 1, at = mean(xvals[2:3]), line=8.5) #
mtext("microbe taxonomy", side = 1, at = mean(xvals[6:7]), line=8.5) #
mtext("microbe location", side = 1, at = mean(xvals[10:11]), line=8.5)  #
dev.off()
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(9,4,1,1))#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals[-11],pch=16)#
	points(unlist(flwrD.m)~I(xvals[-11]+0.01),pch=16,col="gray")#
	arrows(x0=xvals[-11] , y0=flwrE.m -flwrE.se, y1 = flwrE.m +flwrE.se,length=0     )#
	arrows(x0=xvals[-11]+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m +flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[8:9])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsFE)#
	text(xvals,y=-0.2,siggroupsFD,col="gray")#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[9],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals[-6],pch=16)#
	points(unlist(germTD.m)~I(xvals[-6]+0.01),pch=16,col="gray")#
	arrows(x0=xvals[-6] , y0=germTE.m -germTE.se, y1 = germTE.m +germTE.se,length=0     )#
	arrows(x0=xvals[-6]+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m +germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[8:9])/2),lty=3 )#
	text(xvals,y=1.2,siggroupsGtE)#
	text(xvals,y=-0.2,siggroupsGtD,col="gray")#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[9],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals, y0=germPE.m -germPE.se, y1 = germPE.m +germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m +germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[8:9])/2),lty=3 )#
	text(xvals,y=1.2,siggroupsGpE)#
	text(xvals,y=-0.2,siggroupsGpD,col="gray")#
	mtext(side=3,"germination probability")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[9],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)#
mtext("mechanism", side = 1, at = mean(xvals[2:3]), line=8.5) #
mtext("taxonomy", side = 1, at = mean(xvals[6:7]), line=8.5) #
mtext("location", side = 1, at = mean(xvals[10:11]), line=8.5)
pdf("means_ses_and prelim fitted diffs from binom slim 95hpdi.pdf",height=6,width=4)#
xvals <- c(seq(from=0,to=1,length.out=c(4+4+4) ))#
# xlab <- c("nutrients","other beneficial","pathogen","phytohormones","bacteria","myc fungi","mixed","other fungi","root","seed","shoot","mult. w/ reprod","mult. w/o reprod")#
xlab <- c("nutrients","other beneficial","pathogen","phytohormones","bacteria","myc fungi","mixed","other fungi","multiple","root","seed","shoot")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(9,4,1,1))#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals[-11],pch=16)#
	points(unlist(flwrD.m)~I(xvals[-11]+0.01),pch=16,col="gray")#
	arrows(x0=xvals[-11] , y0=flwrE.m -flwrE.se, y1 = flwrE.m +flwrE.se,length=0     )#
	arrows(x0=xvals[-11]+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m +flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[8:9])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsFE)#
	text(xvals,y=-0.2,siggroupsFD,col="gray")#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[9],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals[-6],pch=16)#
	points(unlist(germTD.m)~I(xvals[-6]+0.01),pch=16,col="gray")#
	arrows(x0=xvals[-6] , y0=germTE.m -germTE.se, y1 = germTE.m +germTE.se,length=0     )#
	arrows(x0=xvals[-6]+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m +germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[8:9])/2),lty=3 )#
	text(xvals,y=1.2,siggroupsGtE)#
	text(xvals,y=-0.2,siggroupsGtD,col="gray")#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[9],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals, y0=germPE.m -germPE.se, y1 = germPE.m +germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m +germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[8:9])/2),lty=3 )#
	text(xvals,y=1.2,siggroupsGpE)#
	text(xvals,y=-0.2,siggroupsGpD,col="gray")#
	mtext(side=3,"germination probability")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[9],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)#
mtext("mechanism", side = 1, at = mean(xvals[2:3]), line=8.5) #
mtext("taxonomy", side = 1, at = mean(xvals[6:7]), line=8.5) #
mtext("location", side = 1, at = mean(xvals[10:11]), line=8.5)  #
dev.off()
cols1 <- c("inoctype","lifeform","mating") #"inoctype","lifeform",#
flwrdlist <- list(flowering,flowering,floweringMAT)#
germtlist <- list(germtime,germtime,germtimeMAT)#
germplist <- list(germprb,germprb,germprbMAT)#
#
flwrE.m <-   weightmns2(flwrdlist,cols=cols1,flowering)[[1]][-c(8,10)] #
flwrE.se <-  weightmns2(flwrdlist,cols=cols1,flowering)[[2]][-c(8,10)] #
flwrD.m <-   weightmns2(flwrdlist,cols=cols1,flowering)[[3]][-c(8,10)] #
flwrD.se <-  weightmns2(flwrdlist,cols=cols1,flowering)[[4]][-c(8,10)] #
germTE.m <-  weightmns2(germtlist,cols=cols1,germtime)[[1]] [-c(8,10)] #
germTE.se <- weightmns2(germtlist,cols=cols1,germtime)[[2]] [-c(8,10)] #
germTD.m <-  weightmns2(germtlist,cols=cols1,germtime)[[3]] [-c(8,10)] #
germTD.se <- weightmns2(germtlist,cols=cols1,germtime)[[4]] [-c(8,10)] #
germPE.m <-  weightmns2(germplist,cols=cols1,germprb)[[1]] [-c(8,10)] #
germPE.se <- weightmns2(germplist,cols=cols1,germprb)[[2]] [-c(8,10)] #
germPD.m <-  weightmns2(germplist,cols=cols1,germprb)[[3]] [-c(8,10)] #
germPD.se <- weightmns2(germplist,cols=cols1,germprb)[[4]] [-c(8,10)] #
#
#fill in from model results#
siggroupsFE <- c("b","a","ab",#scom  same at .95/.9#
 				"a","ab","b",#lh  same at .95/.9#
 				"","") #
siggroupsFD <- c("a","b","b",#scom; same at .95/.9; looks different from model predictions#
				"","","",#lh#
				" "," ") #mat #at .9 "b","a"#
siggroupsGtE <- c("","","",#scom#
				" "," "," ",#lh #
				" "," ") #mat n.s. at 0.95 a .9 "a","b"#
siggroupsGtD <- c("a","b","c",#scom # at 0.95/.9 same#
				"a","ab","b",#lh at .95/.9 same#
				"","") #mat#
siggroupsGpE <- c("a","a","b",#scom # at .95/9 same#
				"","","",#lh#
				"","") #mat#
siggroupsGpD <- c("b","b","a",#scom ; recall is comm, strain, strain mix; same at .95/.9#
				" "," "," ",#lh#
				"","") # mat #
#
pdf("means_ses_and prelim fitted diffs from binom supp cats 95hpdi.pdf",height=6,width=3.5)#
xvals <- c(seq(from=0,to=1,length.out=c(3+3+2) ))#
xlab <- c("community","strain","strain mix","annual","both","perennial","outcrosser","selfer")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(7,4,1,1))#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals,pch=16)#
	points(unlist(flwrD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=flwrE.m -flwrE.se, y1 = flwrE.m +flwrE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m +flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsFE)#
	text(xvals,y=-0.2,siggroupsFD,col="gray")#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals,pch=16)#
	points(unlist(germTD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germTE.m -germTE.se, y1 = germTE.m +germTE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m +germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsGtE)#
	text(xvals,y=-0.2,siggroupsGtD,col="gray")#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals, y0=germPE.m -germPE.se, y1 = germPE.m +germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m +germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsGpE)#
	text(xvals,y=-0.2,siggroupsGpD,col="gray")#
	mtext(side=3,"germination probability")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)#
mtext("inoculation", side = 1, at = mean(xvals[2]), line=8.5) #
mtext("lifeform", side = 1, at = mean(xvals[5]), line=8.5) #
mtext("mating system", side = 1, at = mean(xvals[8]), line=8.5)  #
dev.off()
pdf("means_ses_and prelim fitted diffs from binom supp cats 95hpdi.pdf",height=6,width=3.5)#
xvals <- c(seq(from=0,to=1,length.out=c(3+3+2) ))#
xlab <- c("community","strain","strain mix","annual","both","perennial","outcrosser","selfer")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(9,4,1,1))#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals,pch=16)#
	points(unlist(flwrD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=flwrE.m -flwrE.se, y1 = flwrE.m +flwrE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m +flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsFE)#
	text(xvals,y=-0.2,siggroupsFD,col="gray")#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals,pch=16)#
	points(unlist(germTD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germTE.m -germTE.se, y1 = germTE.m +germTE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m +germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsGtE)#
	text(xvals,y=-0.2,siggroupsGtD,col="gray")#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals, y0=germPE.m -germPE.se, y1 = germPE.m +germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m +germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsGpE)#
	text(xvals,y=-0.2,siggroupsGpD,col="gray")#
	mtext(side=3,"germination probability")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)#
mtext("inoculation", side = 1, at = mean(xvals[2]), line=8.5) #
mtext("lifeform", side = 1, at = mean(xvals[5]), line=8.5) #
mtext("mating system", side = 1, at = mean(xvals[8]), line=8.5)  #
dev.off()
pdf("means_ses_and prelim fitted diffs from binom supp cats 95hpdi.pdf",height=6,width=3.5)#
xvals <- c(seq(from=0,to=1,length.out=c(3+3+2) ))#
xlab <- c("community","strain","strain mix","annual","both","perennial","outcrosser","selfer")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(9,4,1,1))#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals,pch=16)#
	points(unlist(flwrD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=flwrE.m -flwrE.se, y1 = flwrE.m +flwrE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m +flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsFE)#
	text(xvals,y=-0.2,siggroupsFD,col="gray")#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals,pch=16)#
	points(unlist(germTD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germTE.m -germTE.se, y1 = germTE.m +germTE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m +germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsGtE)#
	text(xvals,y=-0.2,siggroupsGtD,col="gray")#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals, y0=germPE.m -germPE.se, y1 = germPE.m +germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m +germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsGpE)#
	text(xvals,y=-0.2,siggroupsGpD,col="gray")#
	mtext(side=3,"germination probability")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)#
mtext("inoculation", side = 1, at = mean(xvals[2]), line=7.5) #
mtext("type", side = 1, at = mean(xvals[2]), line=8.5) #
mtext("lifeform", side = 1, at = mean(xvals[5]), line=8.5) #
mtext("mating", side = 1, at = mean(xvals[7:8]), line=7.5)  #
mtext("system", side = 1, at = mean(xvals[7:8]), line=8.5)  #
dev.off()
pdf("means_ses_and prelim fitted diffs from binom supp cats 95hpdi.pdf",height=6,width=3.5)#
xvals <- c(seq(from=0,to=1,length.out=c(3+3+2) ))#
xlab <- c("community","strain","strain mix","annual","both","perennial","outcrosser","selfer")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(9,4,1,1))#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals,pch=16)#
	points(unlist(flwrD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=flwrE.m -flwrE.se, y1 = flwrE.m +flwrE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m +flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsFE)#
	text(xvals,y=-0.2,siggroupsFD,col="gray")#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals,pch=16)#
	points(unlist(germTD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germTE.m -germTE.se, y1 = germTE.m +germTE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m +germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsGtE)#
	text(xvals,y=-0.2,siggroupsGtD,col="gray")#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals, y0=germPE.m -germPE.se, y1 = germPE.m +germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m +germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsGpE)#
	text(xvals,y=-0.2,siggroupsGpD,col="gray")#
	mtext(side=3,"germination probability")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)#
mtext("inoculation", side = 1, at = mean(xvals[2]), line=7.5) #
mtext("type", side = 1, at = mean(xvals[2]), line=8.5) #
mtext("lifeform", side = 1, at = mean(xvals[5]), line=8.5) #
mtext("mating", side = 1, at = mean(xvals[7:8]), line=7)  #
mtext("system", side = 1, at = mean(xvals[7:8]), line=8.5)  #
dev.off()
pdf("means_ses_and prelim fitted diffs from binom supp cats 95hpdi.pdf",height=6,width=3.5)#
xvals <- c(seq(from=0,to=1,length.out=c(3+3+2) ))#
xlab <- c("community","strain","strain mix","annual","both","perennial","outcrosser","selfer")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(9,4,1,1))#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals,pch=16)#
	points(unlist(flwrD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=flwrE.m -flwrE.se, y1 = flwrE.m +flwrE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m +flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsFE)#
	text(xvals,y=-0.2,siggroupsFD,col="gray")#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals,pch=16)#
	points(unlist(germTD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germTE.m -germTE.se, y1 = germTE.m +germTE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m +germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsGtE)#
	text(xvals,y=-0.2,siggroupsGtD,col="gray")#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals, y0=germPE.m -germPE.se, y1 = germPE.m +germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m +germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsGpE)#
	text(xvals,y=-0.2,siggroupsGpD,col="gray")#
	mtext(side=3,"germination probability")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)#
mtext("inoculation", side = 1, at = mean(xvals[2]), line=7.5) #
mtext("type", side = 1, at = mean(xvals[2]), line=8.5) #
mtext("lifeform", side = 1, at = mean(xvals[5]), line=7.5) #
mtext("mating", side = 1, at = mean(xvals[7:8]), line=7.5)  #
mtext("system", side = 1, at = mean(xvals[7:8]), line=8.5)  #
dev.off()
pdf("means_ses_and prelim fitted diffs from binom supp cats 95hpdi.pdf",height=6,width=3.5)#
xvals <- c(seq(from=0,to=1,length.out=c(3+3+2) ))#
xlab <- c("community","strain","strain mix","annual","both","perennial","outcrosser","selfer")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(9,4,1,1))#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals,pch=16)#
	points(unlist(flwrD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=flwrE.m -flwrE.se, y1 = flwrE.m +flwrE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m +flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsFE)#
	text(xvals,y=-0.2,siggroupsFD,col="gray")#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals,pch=16)#
	points(unlist(germTD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germTE.m -germTE.se, y1 = germTE.m +germTE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m +germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsGtE)#
	text(xvals,y=-0.2,siggroupsGtD,col="gray")#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals, y0=germPE.m -germPE.se, y1 = germPE.m +germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m +germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsGpE)#
	text(xvals,y=-0.2,siggroupsGpD,col="gray")#
	mtext(side=3,"germination probability")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)#
mtext("inoculation", side = 1, at = mean(xvals[2]), line=7.5) #
mtext("type", side = 1, at = mean(xvals[2]), line=8.5) #
mtext("lifeform", side = 1, at = mean(xvals[5]), line=7.5) #
mtext("mating", side = 1, at = mean(xvals[7:8]), line=8)  #
mtext("system", side = 1, at = mean(xvals[7:8]), line=8.5)  #
dev.off()
cols1 <- c("microbeNPHO","micrtax","micrloc") #
flwrdlist <- list(flowering,flowering,flowering)#
germtlist <- list(germtime,germtime,germtime)#
germplist <- list(germprb,germprb,germprb)#
#
flwrE.m <-   weightmns2(flwrdlist,cols=cols1,flowering)[[1]][-c(5,10)] #
flwrE.se <-  weightmns2(flwrdlist,cols=cols1,flowering)[[2]][-c(5,10)]#
flwrD.m <-   weightmns2(flwrdlist,cols=cols1,flowering)[[3]][-c(5,10)]#
flwrD.se <-  weightmns2(flwrdlist,cols=cols1,flowering)[[4]][-c(5,10)]#
germTE.m <-  weightmns2(germtlist,cols=cols1,germtime)[[1]][-5] #
germTE.se <- weightmns2(germtlist,cols=cols1,germtime)[[2]][-5] #
germTD.m <-  weightmns2(germtlist,cols=cols1,germtime)[[3]][-5] #
germTD.se <- weightmns2(germtlist,cols=cols1,germtime)[[4]][-5] #
germPE.m <-  weightmns2(germplist,cols=cols1,germprb)[[1]] #
germPE.se <- weightmns2(germplist,cols=cols1,germprb)[[2]] #
germPD.m <-  weightmns2(germplist,cols=cols1,germprb)[[3]] #
germPD.se <- weightmns2(germplist,cols=cols1,germprb)[[4]] #
#subtracting unknown category in MPH (and virus for flowering, which is only 1 sudy with three tests), which is not useful. leaving in germP to fill gap from phytohormones, of which there are no studies in germination probability#
#fill in from model results#
siggroupsFE <- c("","","", "-", # #mph , at 0.9 "a","ab","b", "-" ; .95 " "," "," ", "-"#
				"ab","a","b","ab",#tax #at 0.9; at .9 "ab","a","b","b"; .95 "ab","a","b","ab"#
				" "," ","-"," ")#, #loc#
siggroupsFD <- c( "","","","-", #"b", #mph # at 0.9 "b","ab","a","-" ; .95 " "," "," ","-",#
				"b","b","a","ab",#tax # same for .95 and .9#
				"ab","b","-","a")#, #loc #at 0.95 or .9 same#
siggroupsGtE <- c("","","-","-", #mph; n.s. at .9  "b","a","-","-", at .95 " "," ","-","-"#
				"a","-","b","a",#tax  #same at .95#
				"","","","-")#, #loc	#
siggroupsGtD <- c(" "," ","-","-",#, #mph#
				"b","-","a","b",#tax # same at .95#
				 "","","","-")#,#loc  ; at .9 "ab","b","a","-"; at .95 " "," "," ","-"#
siggroupsGpE <- c(" "," ","-","-", #mph ****no phytohormone records***#
				"b","-","a","a",#tax; same at .95#
				" "," "," ","-")#, #loc#
siggroupsGpD <- c(" "," ","-","-", #mph ****no phytohormone records***#
				"","-","","",#tax#
				"ab","a","b","-")#, #loc; at .9: a a b; at. 95 "ab","a","b","-"#
#
pdf("means_ses_and prelim fitted diffs from binom slim 95hpdi.pdf",height=6,width=4)#
xvals <- c(seq(from=0,to=1,length.out=c(4+4+4) ))#
# xlab <- c("nutrients","other beneficial","pathogen","phytohormones","bacteria","myc fungi","mixed","other fungi","root","seed","shoot","mult. w/ reprod","mult. w/o reprod")#
xlab <- c("nutrients","other beneficial","pathogen","phytohormones","bacteria","myc fungi","mixed","other fungi","multiple","root","seed","shoot")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(9,4,1,1))#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals[-11],pch=16)#
	points(unlist(flwrD.m)~I(xvals[-11]+0.01),pch=16,col="gray")#
	arrows(x0=xvals[-11] , y0=flwrE.m -flwrE.se, y1 = flwrE.m +flwrE.se,length=0     )#
	arrows(x0=xvals[-11]+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m +flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[8:9])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsFE)#
	text(xvals,y=-0.2,siggroupsFD,col="gray")#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[9],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals[-6],pch=16)#
	points(unlist(germTD.m)~I(xvals[-6]+0.01),pch=16,col="gray")#
	arrows(x0=xvals[-6] , y0=germTE.m -germTE.se, y1 = germTE.m +germTE.se,length=0     )#
	arrows(x0=xvals[-6]+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m +germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[8:9])/2),lty=3 )#
	text(xvals,y=1.2,siggroupsGtE)#
	text(xvals,y=-0.2,siggroupsGtD,col="gray")#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[9],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals, y0=germPE.m -germPE.se, y1 = germPE.m +germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m +germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[8:9])/2),lty=3 )#
	text(xvals,y=1.2,siggroupsGpE)#
	text(xvals,y=-0.2,siggroupsGpD,col="gray")#
	mtext(side=3,"germination probability")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[9],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)#
mtext("microbe", side = 1, at = mean(xvals[2:3]), line=7.5) #
mtext("microbe", side = 1, at = mean(xvals[6:7]), line=7.5) #
mtext("microbe", side = 1, at = mean(xvals[10:11]), line=7.5)  #
mtext("mechanism", side = 1, at = mean(xvals[2:3]), line=8.5) #
mtext("taxonomy", side = 1, at = mean(xvals[6:7]), line=8.5) #
mtext("location", side = 1, at = mean(xvals[10:11]), line=8.5)  #
dev.off()
siggroupsFE <- c("a","ab","b", "-", # #mph , at 0.9 "a","ab","b", "-" ; .95 " "," "," ", "-"#
				"ab","a","b","b",#tax #at 0.9; at .9 "ab","a","b","b"; .95 "ab","a","b","ab"#
				" "," ","-"," ")#, #loc#
siggroupsFD <- c("b","ab","a","-", #"b", #mph # at 0.9 "b","ab","a","-" ; .95 " "," "," ","-",#
				"b","b","a","ab",#tax # same for .95 and .9#
				"ab","b","-","a")#, #loc #at 0.95 or .9 same#
siggroupsGtE <- c("b","a","-","-", #mph; n.s. at .9  "b","a","-","-", at .95 " "," ","-","-"#
				"a","-","b","a",#tax  #same at .95#
				"","","","-")#, #loc	#
siggroupsGtD <- c(" "," ","-","-",#, #mph#
				"b","-","a","b",#tax # same at .95#
				"ab","b","a","-")#,#loc  ; at .9 "ab","b","a","-"; at .95 " "," "," ","-"#
siggroupsGpE <- c(" "," ","-","-", #mph ****no phytohormone records***#
				"b","-","a","a",#tax; same at .95#
				" "," "," ","-")#, #loc#
siggroupsGpD <- c(" "," ","-","-", #mph ****no phytohormone records***#
				"","-","","",#tax#
				"a","a","b","-")#, #loc; at .9: a a b; at. 95 "ab","a","b","-"#
#
pdf("means_ses_and prelim fitted diffs from binom slim 90hpdi.pdf",height=6,width=4)#
xvals <- c(seq(from=0,to=1,length.out=c(4+4+4) ))#
# xlab <- c("nutrients","other beneficial","pathogen","phytohormones","bacteria","myc fungi","mixed","other fungi","root","seed","shoot","mult. w/ reprod","mult. w/o reprod")#
xlab <- c("nutrients","other beneficial","pathogen","phytohormones","bacteria","myc fungi","mixed","other fungi","multiple","root","seed","shoot")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(9,4,1,1))#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals[-11],pch=16)#
	points(unlist(flwrD.m)~I(xvals[-11]+0.01),pch=16,col="gray")#
	arrows(x0=xvals[-11] , y0=flwrE.m -flwrE.se, y1 = flwrE.m +flwrE.se,length=0     )#
	arrows(x0=xvals[-11]+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m +flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[8:9])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsFE)#
	text(xvals,y=-0.2,siggroupsFD,col="gray")#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[9],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals[-6],pch=16)#
	points(unlist(germTD.m)~I(xvals[-6]+0.01),pch=16,col="gray")#
	arrows(x0=xvals[-6] , y0=germTE.m -germTE.se, y1 = germTE.m +germTE.se,length=0     )#
	arrows(x0=xvals[-6]+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m +germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[8:9])/2),lty=3 )#
	text(xvals,y=1.2,siggroupsGtE)#
	text(xvals,y=-0.2,siggroupsGtD,col="gray")#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[9],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals, y0=germPE.m -germPE.se, y1 = germPE.m +germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m +germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[8:9])/2),lty=3 )#
	text(xvals,y=1.2,siggroupsGpE)#
	text(xvals,y=-0.2,siggroupsGpD,col="gray")#
	mtext(side=3,"germination probability")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[9],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)#
mtext("microbe", side = 1, at = mean(xvals[2:3]), line=7.5) #
mtext("microbe", side = 1, at = mean(xvals[6:7]), line=7.5) #
mtext("microbe", side = 1, at = mean(xvals[10:11]), line=7.5)  #
mtext("mechanism", side = 1, at = mean(xvals[2:3]), line=8.5) #
mtext("taxonomy", side = 1, at = mean(xvals[6:7]), line=8.5) #
mtext("location", side = 1, at = mean(xvals[10:11]), line=8.5)  #
dev.off()
cols1 <- c("inoctype","lifeform","mating") #"inoctype","lifeform",#
flwrdlist <- list(flowering,flowering,floweringMAT)#
germtlist <- list(germtime,germtime,germtimeMAT)#
germplist <- list(germprb,germprb,germprbMAT)#
#
flwrE.m <-   weightmns2(flwrdlist,cols=cols1,flowering)[[1]][-c(8,10)] #
flwrE.se <-  weightmns2(flwrdlist,cols=cols1,flowering)[[2]][-c(8,10)] #
flwrD.m <-   weightmns2(flwrdlist,cols=cols1,flowering)[[3]][-c(8,10)] #
flwrD.se <-  weightmns2(flwrdlist,cols=cols1,flowering)[[4]][-c(8,10)] #
germTE.m <-  weightmns2(germtlist,cols=cols1,germtime)[[1]] [-c(8,10)] #
germTE.se <- weightmns2(germtlist,cols=cols1,germtime)[[2]] [-c(8,10)] #
germTD.m <-  weightmns2(germtlist,cols=cols1,germtime)[[3]] [-c(8,10)] #
germTD.se <- weightmns2(germtlist,cols=cols1,germtime)[[4]] [-c(8,10)] #
germPE.m <-  weightmns2(germplist,cols=cols1,germprb)[[1]] [-c(8,10)] #
germPE.se <- weightmns2(germplist,cols=cols1,germprb)[[2]] [-c(8,10)] #
germPD.m <-  weightmns2(germplist,cols=cols1,germprb)[[3]] [-c(8,10)] #
germPD.se <- weightmns2(germplist,cols=cols1,germprb)[[4]] [-c(8,10)] #
#
#fill in from model results#
siggroupsFE <- c("b","a","ab",#scom  same at .95/.9#
 				"a","ab","b",#lh  same at .95/.9#
 				"","") #
siggroupsFD <- c("a","b","b",#scom; same at .95/.9; looks different from model predictions#
				"","","",#lh#
				"b","a") #mat #at .9 "b","a"; at .95  "", ""#
siggroupsGtE <- c("","","",#scom#
				" "," "," ",#lh #
				"a","b") #mat n.s. at 0.95 a .9 "a","b"#
siggroupsGtD <- c("a","b","c",#scom # at 0.95/.9 same#
				"a","ab","b",#lh at .95/.9 same#
				"","") #mat#
siggroupsGpE <- c("a","a","b",#scom # at .95/9 same#
				"","","",#lh#
				"","") #mat#
siggroupsGpD <- c("b","b","a",#scom ; recall is comm, strain, strain mix; same at .95/.9#
				" "," "," ",#lh#
				"","") # mat #
#
pdf("means_ses_and prelim fitted diffs from binom supp cats 90hpdi.pdf",height=6,width=3.5)#
xvals <- c(seq(from=0,to=1,length.out=c(3+3+2) ))#
xlab <- c("community","strain","strain mix","annual","both","perennial","outcrosser","selfer")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(9,4,1,1))#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals,pch=16)#
	points(unlist(flwrD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=flwrE.m -flwrE.se, y1 = flwrE.m +flwrE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m +flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsFE)#
	text(xvals,y=-0.2,siggroupsFD,col="gray")#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals,pch=16)#
	points(unlist(germTD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germTE.m -germTE.se, y1 = germTE.m +germTE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m +germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsGtE)#
	text(xvals,y=-0.2,siggroupsGtD,col="gray")#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals, y0=germPE.m -germPE.se, y1 = germPE.m +germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m +germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsGpE)#
	text(xvals,y=-0.2,siggroupsGpD,col="gray")#
	mtext(side=3,"germination probability")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)#
mtext("inoculation", side = 1, at = mean(xvals[2]), line=7.5) #
mtext("type", side = 1, at = mean(xvals[2]), line=8.5) #
mtext("lifeform", side = 1, at = mean(xvals[5]), line=7.5) #
mtext("mating", side = 1, at = mean(xvals[7:8]), line=8)  #
mtext("system", side = 1, at = mean(xvals[7:8]), line=8.5)  #
dev.off()
pdf("means_ses_and prelim fitted diffs from binom supp cats 90hpdi.pdf",height=6,width=3.5)#
xvals <- c(seq(from=0,to=1,length.out=c(3+3+2) ))#
xlab <- c("community","strain","strain mix","annual","both","perennial","outcrosser","selfer")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(9,4,1,1))#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals,pch=16)#
	points(unlist(flwrD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=flwrE.m -flwrE.se, y1 = flwrE.m +flwrE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m +flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsFE)#
	text(xvals,y=-0.2,siggroupsFD,col="gray")#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals,pch=16)#
	points(unlist(germTD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germTE.m -germTE.se, y1 = germTE.m +germTE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m +germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsGtE)#
	text(xvals,y=-0.2,siggroupsGtD,col="gray")#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals, y0=germPE.m -germPE.se, y1 = germPE.m +germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m +germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsGpE)#
	text(xvals,y=-0.2,siggroupsGpD,col="gray")#
	mtext(side=3,"germination probability")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)#
mtext("inoculation", side = 1, at = mean(xvals[2]), line=7.5) #
mtext("type", side = 1, at = mean(xvals[2]), line=8.5) #
mtext("lifeform", side = 1, at = mean(xvals[5]), line=8) #
mtext("mating", side = 1, at = mean(xvals[7:8]), line=7.5)  #
mtext("system", side = 1, at = mean(xvals[7:8]), line=8.5)  #
dev.off()
pdf("means_ses_and prelim fitted diffs from binom supp cats 90hpdi.pdf",height=6,width=3.5)#
xvals <- c(seq(from=0,to=1,length.out=c(3+3+2) ))#
xlab <- c("community","strain","strain mix","annual","both","perennial","outcrosser","selfer")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(8,4,1,1))#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals,pch=16)#
	points(unlist(flwrD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=flwrE.m -flwrE.se, y1 = flwrE.m +flwrE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m +flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsFE)#
	text(xvals,y=-0.2,siggroupsFD,col="gray")#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals,pch=16)#
	points(unlist(germTD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germTE.m -germTE.se, y1 = germTE.m +germTE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m +germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsGtE)#
	text(xvals,y=-0.2,siggroupsGtD,col="gray")#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.3,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals, y0=germPE.m -germPE.se, y1 = germPE.m +germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m +germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[3:4])/2, sum(xvals[6:7])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsGpE)#
	text(xvals,y=-0.2,siggroupsGpD,col="gray")#
	mtext(side=3,"germination probability")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[4],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)#
mtext("inoculation", side = 1, at = mean(xvals[2]), line=6.5) #
mtext("type", side = 1, at = mean(xvals[2]), line=7.5) #
mtext("lifeform", side = 1, at = mean(xvals[5]), line=7) #
mtext("mating", side = 1, at = mean(xvals[7:8]), line=6.5)  #
mtext("system", side = 1, at = mean(xvals[7:8]), line=7.5)  #
dev.off()
rm(list="ls")
rm(list=ls())
ls()
