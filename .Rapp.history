table(germtime$direction.effect.split)
table(germprb$direction.effect.split)
table(germprbMAT$direction.effect.split)
table(germtimeMAT$direction.effect.split)
table(floweringMAT$direction.effect.split)
flowering$anyeffnum <- as.numeric(as.factor(flowering$anyeffect))-1#
sum(tapply(flowering$anyeffnum,flowering$WOS.relevance.rank,sum) == 0) #6#
length(tapply(flowering$anyeffnum,flowering$WOS.relevance.rank,sum))#39#
germtime$anyeffnum <- as.numeric(as.factor(germtime$anyeffect))-1#
sum(tapply(germtime$anyeffnum,germtime$WOS.relevance.rank,sum) ==0)#1 -- note this record only appears in germtime, not germprb#
length(tapply(germtime$anyeffnum,germtime$WOS.relevance.rank,sum))#19#
germprb$anyeffnum <- as.numeric(as.factor(germprb$anyeffect))-1#
sum(tapply(germprb$anyeffnum,germprb$WOS.relevance.rank,sum) ==0)#0#
length(tapply(germprb$anyeffnum,germprb$WOS.relevance.rank,sum))#13#
length(unique(c(germprb$WOS.relevance.rank, germtime$WOS.relevance.rank)))#overlap
priornr=list(R=list(V= 1, fix=1))#
#I'm still not sure why/if R should be fixed, but JH has it fixed in ALL example priors, so I think so?#
prior=list(R=list(V= 1, fix=1), G=list(G1=list(V=1, nu=0)))#
priornuup=list(R=list(V= 1, fix=1), G=list(G1=list(V=1, nu=8)))#turning this degree of belief way up solved sampling issues for flowering time#
	#estimates for intercept and random effects became more independent, because this shunts variation to be explained by fixed effect when there isn't information in the data for the random effect#
prior2=list(R=list(V= 1, fix=1), G=list(G1=list(V=1, nu=0),G2=list(V=1, nu=0)))#
priornuup2=list(R=list(V= 1, fix=1), G=list(G1=list(V=1, nu=8),G2=list(V=1, nu=8)))#
#after fitting the flowering model with various priors for the case with random effects(prior 2 onwards, the latter two of which are meant for no-intercept models); and various levels of binning,#
###I conclude that the prior doesn't seem to help with the correlation issues between the posterior fixed and random effects. These issues are exacerbated by two little or too much binning#
####effective sampling for the random effect was higher with the most complex prior, but it reduced DIC and also effective sampling (though still acceptable) for cutpoint#
####no-intercept models seem to make all problems worse.#
#
######BINOMIALS#
# flowerbiINT <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~1,random = ~dummyWOSrelrank,data=flowering,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=100000,thin=50,burnin=1000)#
#
flowerbitax <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~micrtax.sim2,random = ~dummyWOSrelrank,data=flowering,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
#a a b b #
flowerbiscom <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~Strainvcomm.1,random = ~dummyWOSrelrank,data=flowering,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
flowerbimat <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~mating2,random = ~dummyWOSrelrank,data=floweringMAT,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
flowerbilh <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~lifeform2,random = ~dummyWOSrelrank,data=flowering,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
flowerbiloc <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~micrloc3,random = ~dummyWOSrelrank,data=flowering,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
flowerDbitax <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~micrtax.sim2,random = ~dummyWOSrelrank,data=flowering,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
flowerDbiscom <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~Strainvcomm.1,random = ~dummyWOSrelrank,data=flowering,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
flowerDbimat <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~mating2,random = ~dummyWOSrelrank,data=floweringMAT,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
flowerDbilh <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~lifeform2,random = ~dummyWOSrelrank,data=flowering,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
flowerDbiloc <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~micrloc3,random = ~dummyWOSrelrank,data=flowering,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
earlyFmns <- lapply(c("micrtax.sim2","Strainvcomm.1","mating2","lifeform2","micrloc3"),#
		 function(z) tapply(flowering$isEarlyOrNrw,flowering[,colnames(flowering)==z],mean,na.rm=T) )#
	earlyFmns[[3]] <- tapply(floweringMAT$isEarlyOrNrw,floweringMAT[,colnames(floweringMAT)=="mating2"],mean,na.rm=T)#
	earlyFmns[[6]] <- mean(floweringMAT$isEarlyOrNrw)#
earlyFses <- lapply(c("micrtax.sim2","Strainvcomm.1","mating2","lifeform2","micrloc3"),#
		 function(z) tapply(flowering$isEarlyOrNrw,flowering[,colnames(flowering)==z],std.error) )#
	earlyFses[[3]] <- tapply(floweringMAT$isEarlyOrNrw,floweringMAT[,colnames(floweringMAT)=="mating2"],std.error)#
	earlyFses[[6]] <- std.error(floweringMAT$isEarlyOrNrw)#
delayFmns <- lapply(c("micrtax.sim2","Strainvcomm.1","mating2","lifeform2","micrloc3"),#
		 function(z) tapply(flowering$isDelayOrExp,flowering[,colnames(flowering)==z],mean,na.rm=T) )#
	delayFmns[[3]] <- tapply(floweringMAT$isDelayOrExp,floweringMAT[,colnames(floweringMAT)=="mating2"],mean,na.rm=T)#
	delayFmns[[6]] <- mean(floweringMAT$isDelayOrExp)#
delayFses <- lapply(c("micrtax.sim2","Strainvcomm.1","mating2","lifeform2","micrloc3"),#
		 function(z) tapply(flowering$isDelayOrExp,flowering[,colnames(flowering)==z],std.error) )#
	delayFses[[3]] <- tapply(floweringMAT$isDelayOrExp,floweringMAT[,colnames(floweringMAT)=="mating2"],std.error)#
	delayFses[[6]] <- std.error(floweringMAT$isDelayOrExp)#
#
#more likely to be earlier:bacteria vs fungi (simplified micr only); culture inoc vs removed exps; strains vs mixed; ; annuals vs perennials#
germtimebitax <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~micrtax.sim2,random = ~dummyWOSrelrank,data=germtime,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
#b a c b#
germtimebiscom <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~Strainvcomm.1,random = ~dummyWOSrelrank,data=germtime,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germtimebimat <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~mating2,random = ~dummyWOSrelrank,data=germtimeMAT,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germtimebilh <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~lifeform2,random = ~dummyWOSrelrank,data=germtime,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germtimebiloc <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~micrloc3,random = ~dummyWOSrelrank,data=germtime,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germtimeDbitax <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~micrtax.sim2,random = ~dummyWOSrelrank,data=germtime,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germtimeDbiscom <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~Strainvcomm.1,random = ~dummyWOSrelrank,data=germtime,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germtimeDbimat <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~mating2,random = ~dummyWOSrelrank,data=germtimeMAT,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germtimeDbilh <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~lifeform2,random = ~dummyWOSrelrank,data=germtime,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germtimeDbiloc <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~micrloc3,random = ~dummyWOSrelrank,data=germtime,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
earlyGmns <- lapply(c("micrtax.sim2","Strainvcomm.1","mating2","lifeform2","micrloc3"),#
		 function(z) tapply(germtime$isEarlyOrNrw,germtime[,colnames(germtime)==z],mean,na.rm=T) )#
	earlyGmns[[3]] <- tapply(germtimeMAT$isEarlyOrNrw,germtimeMAT[,colnames(germtimeMAT)=="mating2"],mean,na.rm=T) #
	earlyGmns[[6]] <- mean(germtime$isEarlyOrNrw)#
earlyGses <- lapply(c("micrtax.sim2","Strainvcomm.1","mating2","lifeform2","micrloc3"),#
		 function(z) tapply(germtime$isEarlyOrNrw,germtime[,colnames(germtime)==z],std.error) )#
	earlyGses[[3]] <- tapply(germtimeMAT$isEarlyOrNrw,germtimeMAT[,colnames(germtimeMAT)=="mating2"],std.error)#
	earlyGses[[6]] <- std.error(germtime$isEarlyOrNrw)#
delayGmns <- lapply(c("micrtax.sim2","Strainvcomm.1","mating2","lifeform2","micrloc3"),#
		 function(z) tapply(germtime$isDelayOrExp,germtime[,colnames(germtime)==z],mean,na.rm=T) )#
	delayGmns[[3]] <- tapply(germtimeMAT$isDelayOrExp,germtimeMAT[,colnames(germtimeMAT)=="mating2"],mean,na.rm=T) #
	delayGmns[[6]] <- mean(germtime$isDelayOrExp)#
delayGses <- lapply(c("micrtax.sim2","Strainvcomm.1","mating2","lifeform2","micrloc3"),#
		 function(z) tapply(germtime$isDelayOrExp,germtime[,colnames(germtime)==z],std.error) )#
	delayGses[[3]] <- tapply(germtimeMAT$isDelayOrExp,germtimeMAT[,colnames(germtimeMAT)=="mating2"],std.error)#
	delayGses[[6]] <- std.error(germtime$isDelayOrExp)#
germprbbitax <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~micrtax.sim2,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbbiscom <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~Strainvcomm.1,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbbimat <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~mating2,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbbilh <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~lifeform2,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbbiloc <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~micrloc3,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbDbitax <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~micrtax.sim2,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbDbiscom <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~Strainvcomm.1,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbDbimat <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~mating2,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbDbilh <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~lifeform2,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbDbiloc <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~micrloc3,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
earlyGPmns <- lapply(c("micrtax.sim2","Strainvcomm.1","mating2","lifeform2","micrloc3"),#
		 function(z) tapply(germprb$isEarlyOrNrw,germprb[,colnames(germprb)==z],mean,na.rm=T) )#
	earlyGPmns[[3]] <- tapply(germprbMAT$isEarlyOrNrw,germprbMAT[,colnames(germprbMAT)=="mating2"],mean,na.rm=T)#
	earlyGPmns[[6]] <- mean(germprb$isEarlyOrNrw)#
earlyGPses <- lapply(c("micrtax.sim2","Strainvcomm.1","mating2","lifeform2","micrloc3"),#
		 function(z) tapply(germprb$isEarlyOrNrw,germprb[,colnames(germprb)==z],std.error) )#
	earlyGPses[[3]] <- tapply(germprbMAT$isEarlyOrNrw,germprbMAT[,colnames(germprbMAT)=="mating2"],std.error)#
	earlyGPses[[6]] <- std.error(germprb$isEarlyOrNrw)#
delayGPmns <- lapply(c("micrtax.sim2","Strainvcomm.1","mating2","lifeform2","micrloc3"),#
		 function(z) tapply(germprb$isDelayOrExp,germprb[,colnames(germprb)==z],mean,na.rm=T) )#
	delayGPmns[[3]] <- tapply(germprbMAT$isDelayOrExp,germprbMAT[,colnames(germprbMAT)=="mating2"],mean,na.rm=T)#
	delayGPmns[[6]] <- mean(germprb$isDelayOrExp)#
delayGPses <- lapply(c("micrtax.sim2","Strainvcomm.1","mating2","lifeform2","micrloc3"),#
		 function(z) tapply(germprb$isDelayOrExp,germprb[,colnames(germprb)==z],std.error) )#
	delayGPses[[3]] <- tapply(germprbMAT$isDelayOrExp,germprbMAT[,colnames(germprbMAT)=="mating2"],std.error)#
	delayGPses[[6]] <- std.error(germprb$isDelayOrExp)
summary(flowerbitax)
summary(flowerDbitax)
summary(germtimebitax)
summary(germtimeDbitax)
split_recs <- read.csv("trimmed RECORDS FOR SPLITTING v3.csv", #sep="\t",#
					stringsAsFactors=F,na.strings = c("NA","")) #
			#hand removed some columns, re-enforced the 5 options for direction of effect#
			#also re-enforced options for mating, microbe nutrient-pathogen-other; Micrloc.2; state.relative.too, incl 1 "sterilized soils" to "without focal microbe"#
			#also, there seem to be some extra rows still, perhaps those should be reomoved.#
			#there are a few notes about changes in how records are scored, might want to make sure those are reflected in the previous tab as well?#
			#Deleted a few effect directions to be blank because it seemed like they were a pooled version of split records? (e.g. still had two traits mixed --"flowering time; fruiting time" -- this might not be right)#
split_recs_scr <- split_recs[!is.na(split_recs$direction.effect.split),]
dim(split_recs_scr)
split_recs_scr$direction.effect.split[split_recs_scr$direction.effect.split== "later"] <- "delayed" #
split_recs_scr$direction.effect.split[split_recs_scr$direction.effect.split %in% c("decreased","reduced")] <- "narrowed" #
split_recs_scr$direction.effect.split[split_recs_scr$direction.effect.split %in% c("increased","extended")] <- "expanded" #
split_recs_scr$direction.effect.split[split_recs_scr$direction.effect.split== "none "] <- "none"
table(split_recs_scr$direction.effect.split)
split_recs_scr$culture.sim[split_recs_scr$culture.sim== "culture; direct"] <- "culture" # making a decision on Lu2018 #
split_recs_scr$micrtax.sim2[split_recs_scr$micrtax.sim2=="fungi"] <- "otherfungi" #changing alphabetical position for convenience
table(split_recs_scr$micrtax.sim2)
table(split_recs_scr$culture.sim)
split_recs_scr$culture.sim[split_recs_scr$culture.sim %in% c("culture; direct","cutlure")] <- "culture" # making a decision on Lu2018
table(split_recs_scr$culture.sim)
numeric.phen.eff <- rep(NA, length=nrow(split_recs_scr))#
numeric.phen.eff[split_recs_scr$direction.effect.split=="earlier"] <- -1#
numeric.phen.eff[split_recs_scr$direction.effect.split=="delayed"] <- 1#
numeric.phen.eff[split_recs_scr$direction.effect.split=="none"] <- 0#
numeric.phen.eff[split_recs_scr$direction.effect.split=="expanded"] <- 1#
numeric.phen.eff[split_recs_scr$direction.effect.split=="narrowed"] <- -1#
split_recs_scr$numeric.phen.eff <- numeric.phen.eff
table(numeric.phen.eff)
split_recs_scr$lifeform2 <- split_recs_scr$lifeform#
split_recs_scr$lifeform2[  split_recs_scr$lifeform %in% c("annual in cultivation (perennnial)","perennial; annual (both)","both") ] <-  "both"#
split_recs_scr$lifeform2[  split_recs_scr$lifeform =="perennial (biennial?)" ] <-  "perennial"
table(split_recs_scr$lifeform2)
table(split_recs_scr$mating2)
split_recs_scr$mating2 <- split_recs_scr$mating#
split_recs_scr$mating2 [is.na(split_recs_scr$mating)] <- "unk"#
split_recs_scr$mating2 [split_recs_scr$mating=="outcross?"] <- "unk"#
split_recs_scr$mating2 [split_recs_scr$mating=="both"] <- "s+o"#
split_recs_scr$mating2 [split_recs_scr$mating %in% c("selfie","selifer","selfier")] <- "selfer" #correcting spelling errors
table(split_recs_scr$mating2)
split_recs_scr$phen.trait.2[split_recs_scr$phen.trait.2=='"budburst"'] <- "budburst" #correcting spelling errors
table(split_recs_scr$phen.trait.2)
split_recs_scr$micrloc3 <- split_recs_scr$Micrloc.2#
split_recs_scr$micrloc3 [split_recs_scr$Micrloc.2%in% c("reproductive; shoot","root; shoot; reproductive","root; shoot; reproductive; seed")] <- "various incl reproductive"#
split_recs_scr$micrloc3 [split_recs_scr$Micrloc.2%in% c("seed; shoot","root; shoot","root; seed","root; shoot; seed")] <- "various not incl reproductive"#
split_recs_scr$micrloc3 [split_recs_scr$Micrloc.2=="seed "] <- "seed"#
split_recs_scr$micrloc3 [split_recs_scr$Micrloc.2=="leaves"] <- "shoot"
summary(split_recs_scr$micrloc3)
table(split_recs_scr$micrloc3)
sum(is.na(split_recs_scr$micrloc3))
sum(is.na(split_recs_scr$mating2))
sum(is.na(split_recs_scr$lifeform2))
sum(is.na(split_recs_scr$micrtax.sim2))
sum(is.na(split_recs_scr$Strainvcomm.1))
table(split_recs_scr$Strainvcomm.1)
split_recs_scr$isEarlyOrNrw <- ifelse(numeric.phen.eff=="-1",1,0)#
split_recs_scr$notEarlyOrNrw <- 1-split_recs_scr$isEarlyOrNrw#
split_recs_scr$isDelayOrExp <- ifelse(numeric.phen.eff=="1",1,0)#
split_recs_scr$notDelayOrExp <- 1-split_recs_scr$isDelayOrExp#
split_recs_scr$isSig <- ifelse(numeric.phen.eff=="1" | numeric.phen.eff=="-1",1,0)#
split_recs_scr$notSig <- 1- split_recs_scr$isSig
split_recs_scr$anyeffnum <- as.numeric(as.factor(split_recs_scr$anyeffect))-1#
sum(   tapply(split_recs_scr$anyeffnum[split_recs_scr$micrtax.sim2=="MF"],split_recs_scr$WOS.relevance.rank[split_recs_scr$micrtax.sim2=="MF"],sum) ==0)#4#
length(tapply(split_recs_scr$anyeffnum[split_recs_scr$micrtax.sim2=="MF"],split_recs_scr$WOS.relevance.rank[split_recs_scr$micrtax.sim2=="MF"],sum))#17  17-4 = 13#
sum(   tapply(split_recs_scr$anyeffnum[split_recs_scr$micrtax.sim2=="bacteria"],split_recs_scr$WOS.relevance.rank[split_recs_scr$micrtax.sim2=="bacteria"],sum) ==0)#0#
length(tapply(split_recs_scr$anyeffnum[split_recs_scr$micrtax.sim2=="bacteria"],split_recs_scr$WOS.relevance.rank[split_recs_scr$micrtax.sim2=="bacteria"],sum))#13#
table(split_recs_scr$WOS.relevance.rank[split_recs_scr$micrloc3=="various incl reproductive"])#
length(unique(split_recs_scr$WOS.relevance.rank[split_recs_scr$phen.trait.2=="fruiting time"]))#
length(unique(split_recs_scr$WOS.relevance.rank[split_recs_scr$phen.trait.2=="senescence time"]))#
length(unique(split_recs_scr$WOS.relevance.rank[split_recs_scr$phen.trait.2 %in% c("phyllochron","budburst") ]))
flowering <- split_recs_scr[split_recs_scr$phen.trait.2=="flowering time",]#
	flowering <- flowering[flowering$micrtax.sim2!= "virus",] #subtract the one  record in this categories#
	flowering$dummyWOSrelrank <- flowering$WOS.relevance.rank#
	flowering$dummyWOSrelrank[flowering$dummyWOSrelran%in%names(table(flowering$WOS.relevance.rank)[table(flowering$WOS.relevance.rank)<13])] <- "binned"#
floweringMAT <- split_recs_scr[split_recs_scr$phen.trait.2=="flowering time" & split_recs_scr$mating2 != "unk" & split_recs_scr$mating2 != "s+o",]#
	floweringMAT$dummyWOSrelrank <- floweringMAT$WOS.relevance.rank#
	floweringMAT$dummyWOSrelrank[floweringMAT$dummyWOSrelran%in%names(table(floweringMAT$WOS.relevance.rank)[table(floweringMAT$WOS.relevance.rank)<13])] <- "binned"#
germtime <- split_recs_scr[split_recs_scr$phen.trait.2=="germination time",]#
	germtime <- germtime[germtime$micrtax.sim2!= "MF; fungi",] #subtract the one  record in this categories#
	germtime$dummyWOSrelrank <- germtime$WOS.relevance.rank#
	germtime$dummyWOSrelrank[germtime$dummyWOSrelran%in%names(table(germtime$WOS.relevance.rank)[table(germtime$WOS.relevance.rank)<13])] <- "binned"#
germtimeMAT <- split_recs_scr[split_recs_scr$phen.trait.2=="germination time" & split_recs_scr$mating2 != "unk" & split_recs_scr$mating2 != "s+o",]#
	germtimeMAT$dummyWOSrelrank <- germtimeMAT$WOS.relevance.rank#
	germtimeMAT$dummyWOSrelrank[germtimeMAT$dummyWOSrelran%in%names(table(germtimeMAT$WOS.relevance.rank)[table(germtimeMAT$WOS.relevance.rank)<13])] <- "binned"#
germprb <- split_recs_scr[split_recs_scr$phen.trait.2=="germination prb"& split_recs_scr$mating2 != "unk" & split_recs_scr$mating2 != "s+o",]#
	germprb <- germprb[germprb$micrtax.sim2!= "MF; fungi",] #subtract the one  records in this categories#
	germprb$dummyWOSrelrank <- germprb$WOS.relevance.rank#
	germprb$dummyWOSrelrank[germprb$dummyWOSrelran%in%names(table(germprb$WOS.relevance.rank)[table(germprb$WOS.relevance.rank)<13])] <- "binned"#
# 	germprb<- germprb[-which(germprb$culture.sim=="observed"),] #removing the sole record that is not manipulated#
#no longer need to remove the observed record; as not checking how this relates to results #
germprbMAT <- split_recs_scr[split_recs_scr$phen.trait.2=="germination prb" & split_recs_scr$mating2 != "unk" & split_recs_scr$mating2 != "s+o",]#
	germprbMAT$dummyWOSrelrank <- germprbMAT$WOS.relevance.rank#
	germprbMAT$dummyWOSrelrank[germprbMAT$dummyWOSrelran%in%names(table(germprbMAT$WOS.relevance.rank)[table(germprbMAT$WOS.relevance.rank)<13])] <- "binned"#
# 	germprbMAT<- germprbMAT[-which(germprbMAT$culture.sim=="observed"),] #removing the sole record that is not manipulated#
allphen <- split_recs_scr[!is.na(split_recs_scr$phen.trait.2),]#
	allphen$dummyWOSrelrank <- allphen$WOS.relevance.rank#
	allphen$dummyWOSrelrank[allphen$dummyWOSrelran%in%names(table(allphen$WOS.relevance.rank)[table(allphen$WOS.relevance.rank)<13])] <- "binned"
flowering$anyeffnum <- as.numeric(as.factor(flowering$anyeffect))-1#
sum(tapply(flowering$anyeffnum,flowering$WOS.relevance.rank,sum) == 0) #6#
length(tapply(flowering$anyeffnum,flowering$WOS.relevance.rank,sum))#39#
germtime$anyeffnum <- as.numeric(as.factor(germtime$anyeffect))-1#
sum(tapply(germtime$anyeffnum,germtime$WOS.relevance.rank,sum) ==0)#1 -- note this record only appears in germtime, not germprb#
length(tapply(germtime$anyeffnum,germtime$WOS.relevance.rank,sum))#19#
germprb$anyeffnum <- as.numeric(as.factor(germprb$anyeffect))-1#
sum(tapply(germprb$anyeffnum,germprb$WOS.relevance.rank,sum) ==0)#0#
length(tapply(germprb$anyeffnum,germprb$WOS.relevance.rank,sum))#13#
length(unique(c(germprb$WOS.relevance.rank, germtime$WOS.relevance.rank)))#overlap
priornr=list(R=list(V= 1, fix=1))#
#I'm still not sure why/if R should be fixed, but JH has it fixed in ALL example priors, so I think so?#
prior=list(R=list(V= 1, fix=1), G=list(G1=list(V=1, nu=0)))#
priornuup=list(R=list(V= 1, fix=1), G=list(G1=list(V=1, nu=8)))#turning this degree of belief way up solved sampling issues for flowering time#
	#estimates for intercept and random effects became more independent, because this shunts variation to be explained by fixed effect when there isn't information in the data for the random effect#
# prior2=list(R=list(V= 1, fix=1), G=list(G1=list(V=1, nu=0),G2=list(V=1, nu=0)))#
priornuup2=list(R=list(V= 1, fix=1), G=list(G1=list(V=1, nu=8),G2=list(V=1, nu=8)))#
#after fitting the flowering model with various priors for the case with random effects(prior 2 onwards, the latter two of which are meant for no-intercept models); and various levels of binning,#
###I conclude that the prior doesn't seem to help with the correlation issues between the posterior fixed and random effects. These issues are exacerbated by two little or too much binning#
####effective sampling for the random effect was higher with the most complex prior, but it reduced DIC and also effective sampling (though still acceptable) for cutpoint#
####no-intercept models seem to make all problems worse.#
#
######BINOMIALS#
 traitdiffs <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~phen.trait.2,random = ~dummyWOSrelrank,data=allphen,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=100000,thin=50,burnin=1000)
summary(traitdiffs)
mtypes  <- c("bacteria","MF","mixed","otherfungi")#
wosdf <- unique(flowering$dummyWOSrelrank)#
wosdgt <- unique(germtime$dummyWOSrelrank)#
wosdgp <- unique(germprb$dummyWOSrelrank)#
fxmxrxw <- sapply(mtypes, function(m)  sapply(wosdf, function(w)  mean(flowering$dummyWOSrelrank==w &flowering$micrtax.sim2==m )   ))
fxmxrxw
flwr.m <- colMeans(fxmxrxw)#
flwr.se <- sapply(ncol(fxmxrxw), function(m) std.error(fxmxrxw[,m]) )
flwr.m
summary(germtimeDbiloc)
mtypes  <- c("bacteria","MF","mixed","otherfungi")#
ctypes <- c("community","strain","strain mix")#
lhtypes <- c("annual","both","perennial")#
loctypes <- c("root","seed","shoot","various incl reproductive","various not incl reproductive")#
typelist <- list(mtypes,ctypes,lhtypes,loctypes)
fxmxrxw <- lapply(typelist, function(type) sapply(type, function(m)  sapply(wosdf, function(w)  mean(flowering$dummyWOSrelrank==w &flowering$micrtax.sim2==m )   ))
)
fxmxrxw
cols <- c("micrtax.sim2","Strainvcomm.1","lifeform2","micrloc3")
fxmxrxw <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  mean(flowering$dummyWOSrelrank==w & flowering$(cols[type])==m )   ))
fxmxrxw <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  mean(flowering$dummyWOSrelrank==w & flowering[colnames(flowering)==cols[type],]==m )   ))
)
colnames(flowering)==cols[1]
fxmxrxw <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  mean(flowering$dummyWOSrelrank==w & flowering[which(colnames(flowering)==cols[type]),]==m )   )))
which(colnames(flowering)==cols[1])
fxmxrxw <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  mean(flowering$dummyWOSrelrank==w & flowering[,which(colnames(flowering)==cols[type])]==m )   )))
fxmxrxw
flwr.m <- lapply(1:length(typelist), function(type) colMeans(fxmxrxw[[type]])
flwr.m <- lapply(1:length(typelist), function(type) colMeans(fxmxrxw[[type]])#
)
flwr.m
flwr.mse <-lapply(1:length(typelist), function(type)  sapply(ncol(fxmxrxw), function(m) std.error(fxmxrxw[,m]) ))
flwr.mse
flwr.mse <-lapply(1:length(typelist), function(type)  sapply(ncol(fxmxrxw[[type]]), function(m) std.error(fxmxrxw[[type]][,m]) ))
flwr.mse
flwr.mse <-lapply(1:length(typelist), function(type)  sapply(1:ncol(fxmxrxw[[type]]), function(m) std.error(fxmxrxw[[type]][,m]) ))
flwr.mse
flowerbitax <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~micrtax.sim2,random = ~dummyWOSrelrank,data=flowering,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
flowerbiscom <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~Strainvcomm.1,random = ~dummyWOSrelrank,data=flowering,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
flowerbimat <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~mating2,random = ~dummyWOSrelrank,data=floweringMAT,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
flowerbilh <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~lifeform2,random = ~dummyWOSrelrank,data=flowering,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
flowerbiloc <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~micrloc3,random = ~dummyWOSrelrank,data=flowering,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
flowerDbitax <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~micrtax.sim2,random = ~dummyWOSrelrank,data=flowering,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
flowerDbiscom <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~Strainvcomm.1,random = ~dummyWOSrelrank,data=flowering,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
flowerDbimat <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~mating2,random = ~dummyWOSrelrank,data=floweringMAT,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
flowerDbilh <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~lifeform2,random = ~dummyWOSrelrank,data=flowering,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
flowerDbiloc <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~micrloc3,random = ~dummyWOSrelrank,data=flowering,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)
summary(flowerbitax)
summary(flowerDbitax)
summary(flowerbiscom)
summary(flowerDbiscom)
summary(flowerbimat)
flowering$micrtax.sim2
summary(flowerbimat)
summary(flowerDbimat)
summary(flowerbilh)
summary(flowerDbilh)
summary(flowerbiloc)
summary(flowerDbiloc)
summary(germtimbitax)
summary(germtimebitax)
germtimebitax <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~micrtax.sim2,random = ~dummyWOSrelrank,data=germtime,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)
summary(germtimebitax)
germtimebiscom <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~Strainvcomm.1,random = ~dummyWOSrelrank,data=germtime,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germtimebimat <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~mating2,random = ~dummyWOSrelrank,data=germtimeMAT,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germtimebilh <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~lifeform2,random = ~dummyWOSrelrank,data=germtime,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germtimebiloc <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~micrloc3,random = ~dummyWOSrelrank,data=germtime,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germtimeDbitax <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~micrtax.sim2,random = ~dummyWOSrelrank,data=germtime,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germtimeDbiscom <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~Strainvcomm.1,random = ~dummyWOSrelrank,data=germtime,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germtimeDbimat <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~mating2,random = ~dummyWOSrelrank,data=germtimeMAT,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germtimeDbilh <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~lifeform2,random = ~dummyWOSrelrank,data=germtime,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germtimeDbiloc <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~micrloc3,random = ~dummyWOSrelrank,data=germtime,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)
germprbbitax <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~micrtax.sim2,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbbiscom <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~Strainvcomm.1,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbbimat <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~mating2,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbbilh <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~lifeform2,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbbiloc <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~micrloc3,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbDbitax <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~micrtax.sim2,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbDbiscom <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~Strainvcomm.1,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbDbimat <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~mating2,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbDbilh <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~lifeform2,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbDbiloc <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~micrloc3,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)
mtypes  <- c("bacteria","MF","mixed","otherfungi")#
ctypes <- c("community","strain","strain mix")#
lhtypes <- c("annual","both","perennial")#
loctypes <- c("root","seed","shoot","various incl reproductive","various not incl reproductive")#
typelist <- list(mtypes,ctypes,lhtypes,loctypes)#
cols <- c("micrtax.sim2","Strainvcomm.1","lifeform2","micrloc3")#
wosdf <- unique(flowering$dummyWOSrelrank)#
wosdgt <- unique(germtime$dummyWOSrelrank)#
wosdgp <- unique(germprb$dummyWOSrelrank)#
fxmxrxw <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  mean(flowering$dummyWOSrelrank==w & flowering[,which(colnames(flowering)==cols[type])]==m )   )))#
flwr.m <- lapply(1:length(typelist), function(type) colMeans(fxmxrxw[[type]]))#
flwr.se <-lapply(1:length(typelist), function(type)  sapply(1:ncol(fxmxrxw[[type]]), function(m) std.error(fxmxrxw[[type]][,m]) ))#
gxmxrxw <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdgt, function(w)  mean(germtime$dummyWOSrelrank==w & germtime[,which(colnames(germtime)==cols[type])]==m )   )))#
germT.m <- lapply(1:length(typelist), function(type) colMeans(gxmxrxw[[type]]))#
germT.se <-lapply(1:length(typelist), function(type)  sapply(1:ncol(gxmxrxw[[type]]), function(m) std.error(gxmxrxw[[type]][,m]) ))#
gpxmxrxw <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdgp, function(w)  mean(germprb$dummyWOSrelrank==w & germprb[,which(colnames(germprb)==cols[type])]==m )   )))#
germP.m <- lapply(1:length(typelist), function(type) colMeans(gpxmxrxw[[type]]))#
germP.se <-lapply(1:length(typelist), function(type)  sapply(1:ncol(gpxmxrxw[[type]]), function(m) std.error(gpxmxrxw[[type]][,m]) ))
matypes <- c("selfer","outcross")#
wosdfM <- unique(floweringMAT$dummyWOSrelrank)#
wosdgtM <- unique(germtimeMAT$dummyWOSrelrank)#
wosdgpM <- unique(germprbMAT$dummyWOSrelrank)
sapply(mattypes, function(m)  sapply(wosdfM, function(w)  mean(floweringMAT$dummyWOSrelrank==w & floweringMAT[,which(colnames(floweringMAT)==cols[type])]==m )   )))
sapply(mattypes, function(m)  sapply(wosdfM, function(w)  mean(floweringMAT$dummyWOSrelrank==w & floweringMAT[,which(colnames(floweringMAT)==cols[type])]==m )   ))
sapply(matypes, function(m)  sapply(wosdfM, function(w)  mean(floweringMAT$dummyWOSrelrank==w & floweringMAT[,which(colnames(floweringMAT)==cols[type])]==m )   ))
sapply(matypes, function(m)  sapply(wosdfM, function(w)  mean(floweringMAT$dummyWOSrelrank==w & floweringMAT$mating2==m )   ))
fxmxrxw <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  mean(flowering$dummyWOSrelrank==w & flowering[,which(colnames(flowering)==cols[type])]==m )   )))#
fxmxrxw[[5]] <-  sapply(matypes, function(m)  sapply(wosdfM, function(w)  mean(floweringMAT$dummyWOSrelrank==w & floweringMAT$mating2==m )   ))#
flwr.m <- lapply(1:length(typelist), function(type) colMeans(fxmxrxw[[type]]))
flwr.m
flwr.m <- lapply(1:length(fxmxrxw), function(type) colMeans(fxmxrxw[[type]]))
flwr.m
mtypes  <- c("bacteria","MF","mixed","otherfungi")#
ctypes <- c("community","strain","strain mix")#
lhtypes <- c("annual","both","perennial")#
loctypes <- c("root","seed","shoot","various incl reproductive","various not incl reproductive")#
typelist <- list(mtypes,ctypes,lhtypes,loctypes)#
cols <- c("micrtax.sim2","Strainvcomm.1","lifeform2","micrloc3")#
wosdf <- unique(flowering$dummyWOSrelrank)#
wosdgt <- unique(germtime$dummyWOSrelrank)#
wosdgp <- unique(germprb$dummyWOSrelrank)#
matypes <- c("selfer","outcross")#
wosdfM <- unique(floweringMAT$dummyWOSrelrank)#
wosdgtM <- unique(germtimeMAT$dummyWOSrelrank)#
wosdgpM <- unique(germprbMAT$dummyWOSrelrank)#
fxmxrxw <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  mean(flowering$dummyWOSrelrank==w & flowering[,which(colnames(flowering)==cols[type])]==m )   )))#
	fxmxrxw[[5]] <-  sapply(matypes, function(m)  sapply(wosdfM, function(w)  mean(floweringMAT$dummyWOSrelrank==w & floweringMAT$mating2==m )   ))#
	flwr.m <- lapply(1:length(fxmxrxw), function(type) colMeans(fxmxrxw[[type]]))#
	flwr.se <-lapply(1:length(fxmxrxw), function(type)  sapply(1:ncol(fxmxrxw[[type]]), function(m) std.error(fxmxrxw[[type]][,m]) ))#
gxmxrxw <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdgt, function(w)  mean(germtime$dummyWOSrelrank==w & germtime[,which(colnames(germtime)==cols[type])]==m )   )))#
	gxmxrxw[[5]] <-  sapply(matypes, function(m)  sapply(wosdgtM, function(w)  mean(germtimeMAT$dummyWOSrelrank==w & germtimeMAT$mating2==m )   ))#
	germT.m <- lapply(1:length(gxmxrxw), function(type) colMeans(gxmxrxw[[type]]))#
	germT.se <-lapply(1:length(gxmxrxw), function(type)  sapply(1:ncol(gxmxrxw[[type]]), function(m) std.error(gxmxrxw[[type]][,m]) ))#
gpxmxrxw <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdgp, function(w)  mean(germprb$dummyWOSrelrank==w & germprb[,which(colnames(germprb)==cols[type])]==m )   )))#
	gpxmxrxw[[5]] <-  sapply(matypes, function(m)  sapply(wosdgpM, function(w)  mean(germprbMAT$dummyWOSrelrank==w & germprbMAT$mating2==m )   ))#
	germP.m <- lapply(1:length(gpxmxrxw), function(type) colMeans(gpxmxrxw[[type]]))#
	germP.se <-lapply(1:length(gpxmxrxw), function(type)  sapply(1:ncol(gpxmxrxw[[type]]), function(m) std.error(gpxmxrxw[[type]][,m]) ))
germP.m
unlist(germP.m)
fxtxE <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  mean(floweringMAT$isEarlyOrNrw[flowering$dummyWOSrelrank==w & flowering[,which(colnames(flowering)==cols[type])]==m] )   )))#
	fxtxE[[5]] <-  sapply(matypes, function(m)  sapply(wosdfM, function(w)  mean(floweringMAT$isEarlyOrNrw[floweringMAT$dummyWOSrelrank==w & floweringMAT$mating2==m ])   ))#
	flwrE.m <- lapply(1:length(fxtxE), function(type) colMeans(fxtxE[[type]]))#
	flwrE.se <-lapply(1:length(fxtxE), function(type)  sapply(1:ncol(fxtxE[[type]]), function(m) std.error(fxtxE[[type]][,m]) ))#
gTxtxE <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdgt, function(w)  mean(germtime$isEarlyOrNrw[germtime$dummyWOSrelrank==w & germtime[,which(colnames(germtime)==cols[type])]==m ] )   )))#
	gTxtxE[[5]] <-  sapply(matypes, function(m)  sapply(wosdgtM, function(w)  mean(germtimeMAT$isEarlyOrNrw[germtimeMAT$dummyWOSrelrank==w & germtimeMAT$mating2==m] )   ))#
	germTE.m <- lapply(1:length(gTxtxE), function(type) colMeans(gTxtxE[[type]]))#
	germTE.se <-lapply(1:length(gTxtxE), function(type)  sapply(1:ncol(gTxtxE[[type]]), function(m) std.error(gTxtxE[[type]][,m]) ))#
gPxtxE <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdgp, function(w)  mean(germprb$isEarlyOrNrw[germprb$dummyWOSrelrank==w & germprb[,which(colnames(germprb)==cols[type])]==m] )   )))#
	gPxtxE[[5]] <-  sapply(matypes, function(m)  sapply(wosdgpM, function(w)  mean(germprbMAT$isEarlyOrNrw[germprbMAT$dummyWOSrelrank==w & germprbMAT$mating2==m] )   ))#
	germPE.m <- lapply(1:length(gPxtxE), function(type) colMeans(gPxtxE[[type]]))#
	germPE.se <-lapply(1:length(gPxtxE), function(type)  sapply(1:ncol(gPxtxE[[type]]), function(m) std.error(gPxtxE[[type]][,m]) ))
fxtxE
floweringMAT$isEarlyOrNrw
fxtxE <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  mean(flowering$isEarlyOrNrw[flowering$dummyWOSrelrank==w & flowering[,which(colnames(flowering)==cols[type])]==m] )   )))#
	fxtxE[[5]] <-  sapply(matypes, function(m)  sapply(wosdfM, function(w)  mean(floweringMAT$isEarlyOrNrw[floweringMAT$dummyWOSrelrank==w & floweringMAT$mating2==m ])   ))#
	flwrE.m <- lapply(1:length(fxtxE), function(type) colMeans(fxtxE[[type]]))#
	flwrE.se <-lapply(1:length(fxtxE), function(type)  sapply(1:ncol(fxtxE[[type]]), function(m) std.error(fxtxE[[type]][,m]) ))
fxtxE
flwrE.m
flwrE.m <- lapply(1:length(fxtxE), function(type) colMeans(fxtxE[[type]],na.rm=T))
flwrE.m
fxtxE <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  mean(flowering$isEarlyOrNrw[flowering$dummyWOSrelrank==w & flowering[,which(colnames(flowering)==cols[type])]==m] )   )))#
	fxtxE[[5]] <-  sapply(matypes, function(m)  sapply(wosdfM, function(w)  mean(floweringMAT$isEarlyOrNrw[floweringMAT$dummyWOSrelrank==w & floweringMAT$mating2==m ])   ))#
	flwrE.m <- lapply(1:length(fxtxE), function(type) colMeans(fxtxE[[type]],na.rm=T))#
	flwrE.se <-lapply(1:length(fxtxE), function(type)  sapply(1:ncol(fxtxE[[type]]), function(m) std.error(fxtxE[[type]][,m]) ))#
gTxtxE <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdgt, function(w)  mean(germtime$isEarlyOrNrw[germtime$dummyWOSrelrank==w & germtime[,which(colnames(germtime)==cols[type])]==m ] )   )))#
	gTxtxE[[5]] <-  sapply(matypes, function(m)  sapply(wosdgtM, function(w)  mean(germtimeMAT$isEarlyOrNrw[germtimeMAT$dummyWOSrelrank==w & germtimeMAT$mating2==m] )   ))#
	germTE.m <- lapply(1:length(gTxtxE), function(type) colMeans(gTxtxE[[type]],na.rm=T))#
	germTE.se <-lapply(1:length(gTxtxE), function(type)  sapply(1:ncol(gTxtxE[[type]]), function(m) std.error(gTxtxE[[type]][,m]) ))#
gPxtxE <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdgp, function(w)  mean(germprb$isEarlyOrNrw[germprb$dummyWOSrelrank==w & germprb[,which(colnames(germprb)==cols[type])]==m] )   )))#
	gPxtxE[[5]] <-  sapply(matypes, function(m)  sapply(wosdgpM, function(w)  mean(germprbMAT$isEarlyOrNrw[germprbMAT$dummyWOSrelrank==w & germprbMAT$mating2==m] )   ))#
	germPE.m <- lapply(1:length(gPxtxE), function(type) colMeans(gPxtxE[[type]],na.rm=T))#
	germPE.se <-lapply(1:length(gPxtxE), function(type)  sapply(1:ncol(gPxtxE[[type]]), function(m) std.error(gPxtxE[[type]][,m]) ))
plot(flwrE.m~I(1:length(flwrE.m)))
plot(unlist(flwrE.m)~I(1:length(unlist(flwrE.m))))
plot(unlist(germTE.m)~I(1:length(unlist(germT.m))))
plot(unlist(germPE.m)~I(1:length(unlist(germPE.m))))
fxtxD <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  mean(flowering$isDelayOrExp[flowering$dummyWOSrelrank==w & flowering[,which(colnames(flowering)==cols[type])]==m] )   )))#
	fxtxD[[5]] <-  sapply(matypes, function(m)  sapply(wosdfM, function(w)  mean(floweringMAT$isDelayOrExp[floweringMAT$dummyWOSrelrank==w & floweringMAT$mating2==m ])   ))#
	flwrD.m <- unlist(lapply(1:length(fxtxD), function(type) colMeans(fxtxD[[type]],na.rm=T)))#
	flwrD.se <-unlist(lapply(1:length(fxtxD), function(type)  sapply(1:ncol(fxtxD[[type]]), function(m) std.error(fxtxD[[type]][,m]) )))#
	flwrD.m <-  c(flwrD.m, mean(flowering$isDelayOrExp))#
	flwrD.se <-  c(flwrD.se, std.error(flowering$isDelayOrExp))#
gTxtxD <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdgt, function(w)  mean(germtime$isDelayOrExp[germtime$dummyWOSrelrank==w & germtime[,which(colnames(germtime)==cols[type])]==m ] )   )))#
	gTxtxD[[5]] <-  sapply(matypes, function(m)  sapply(wosdgtM, function(w)  mean(germtimeMAT$isDelayOrExp[germtimeMAT$dummyWOSrelrank==w & germtimeMAT$mating2==m] )   ))#
	germTD.m <- unlist(lapply(1:length(gTxtxD), function(type) colMeans(gTxtxD[[type]],na.rm=T)))#
	germTD.se <-unlist(lapply(1:length(gTxtxD), function(type)  sapply(1:ncol(gTxtxD[[type]]), function(m) std.error(gTxtxD[[type]][,m]) )))#
	germTD.m <-  c(germTD.m, mean(germtime$isDelayOrExp))#
	germTD.se <-  c(germTD.se, std.error(germtime$isDelayOrExp))#
gPxtxD <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdgp, function(w)  mean(germprb$isDelayOrExp[germprb$dummyWOSrelrank==w & germprb[,which(colnames(germprb)==cols[type])]==m] )   )))#
	gPxtxD[[5]] <-  sapply(matypes, function(m)  sapply(wosdgpM, function(w)  mean(germprbMAT$isDelayOrExp[germprbMAT$dummyWOSrelrank==w & germprbMAT$mating2==m] )   ))#
	germPD.m <- unlist(lapply(1:length(gPxtxD), function(type) colMeans(gPxtxD[[type]],na.rm=T)))#
	germPD.se <-unlist(lapply(1:length(gPxtxD), function(type)  sapply(1:ncol(gPxtxD[[type]]), function(m) std.error(gPxtxD[[type]][,m]) )))#
	germPD.m <-  c(germPD.m, mean(germprb$isDelayOrExp))#
	germPD.se <-  c(germPD.se, std.error(germprb$isDelayOrExp))
fxtxD
fxtxE
xvals <- c(seq(from=0,to=1,length.out=c(4+3+2+3+5+1) ))#
xlab <- c("bacteria","myc fungi","mixed","other fungi","community","strain","strain mix","annual","both","perennial","root","seed","shoot","v. w/ reprod","v. w/o reprod","outcrosser","selfer","All")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(5,4,1,1))####NOTE THAT SOME OF THESE ARE ONLY SIG AT 0.9#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals,pch=16)#
	points(unlist(flwerD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=~xvals , y0=flwrE.m -flwrE.se, y1 = flwrE.m -flwrE.se,length=0     )#
	arrows(x0=~xvals+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m -flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[13:14])/2, sum(xvals[18:19])/2 ),lty=3 )#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals,pch=16)#
	points(unlist(germTD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=~xvals , y0=germTE.m -germTE.se, y1 = germTE.m -germTE.se,length=0     )#
	arrows(x0=~xvals+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m -germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[13:14])/2, sum(xvals[18:19])/2 ),lty=3 )#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=~xvals , y0=germPE.m -germPE.se, y1 = germPE.m -germPE.se,length=0     )#
	arrows(x0=~xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m -germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[13:14])/2, sum(xvals[18:19])/2 ),lty=3 )#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)
flwrE.m
mtypes  <- c("bacteria","MF","mixed","otherfungi")#
ctypes <- c("community","strain","strain mix")#
lhtypes <- c("annual","both","perennial")#
loctypes <- c("root","seed","shoot","various incl reproductive","various not incl reproductive")#
typelist <- list(mtypes,ctypes,lhtypes,loctypes)#
cols <- c("micrtax.sim2","Strainvcomm.1","lifeform2","micrloc3")#
wosdf <- unique(flowering$dummyWOSrelrank)#
wosdgt <- unique(germtime$dummyWOSrelrank)#
wosdgp <- unique(germprb$dummyWOSrelrank)#
matypes <- c("selfer","outcross")#
wosdfM <- unique(floweringMAT$dummyWOSrelrank)#
wosdgtM <- unique(germtimeMAT$dummyWOSrelrank)#
wosdgpM <- unique(germprbMAT$dummyWOSrelrank)#
fxtxE <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  mean(flowering$isEarlyOrNrw[flowering$dummyWOSrelrank==w & flowering[,which(colnames(flowering)==cols[type])]==m] )   )))#
	fxtxE[[5]] <-  sapply(matypes, function(m)  sapply(wosdfM, function(w)  mean(floweringMAT$isEarlyOrNrw[floweringMAT$dummyWOSrelrank==w & floweringMAT$mating2==m ])   ))#
	flwrE.m <- unlist(lapply(1:length(fxtxE), function(type) colMeans(fxtxE[[type]],na.rm=T)))#
	flwrE.se <-unlist(lapply(1:length(fxtxE), function(type)  sapply(1:ncol(fxtxE[[type]]), function(m) std.error(fxtxE[[type]][,m]) )))#
	flwrE.m <-  c(flwrE.m, mean(flowering$isEarlyOrNrw))#
	flwrE.se <-  c(flwrE.se, std.error(flowering$isEarlyOrNrw))#
gTxtxE <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdgt, function(w)  mean(germtime$isEarlyOrNrw[germtime$dummyWOSrelrank==w & germtime[,which(colnames(germtime)==cols[type])]==m ] )   )))#
	gTxtxE[[5]] <-  sapply(matypes, function(m)  sapply(wosdgtM, function(w)  mean(germtimeMAT$isEarlyOrNrw[germtimeMAT$dummyWOSrelrank==w & germtimeMAT$mating2==m] )   ))#
	germTE.m <- unlist(lapply(1:length(gTxtxE), function(type) colMeans(gTxtxE[[type]],na.rm=T)))#
	germTE.se <-unlist(lapply(1:length(gTxtxE), function(type)  sapply(1:ncol(gTxtxE[[type]]), function(m) std.error(gTxtxE[[type]][,m]) )))#
	germTE.m <-  c(germTE.m, mean(germtime$isEarlyOrNrw))#
	germTE.se <-  c(germTE.se, std.error(germtime$isEarlyOrNrw))#
gPxtxE <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdgp, function(w)  mean(germprb$isEarlyOrNrw[germprb$dummyWOSrelrank==w & germprb[,which(colnames(germprb)==cols[type])]==m] )   )))#
	gPxtxE[[5]] <-  sapply(matypes, function(m)  sapply(wosdgpM, function(w)  mean(germprbMAT$isEarlyOrNrw[germprbMAT$dummyWOSrelrank==w & germprbMAT$mating2==m] )   ))#
	germPE.m <- unlist(lapply(1:length(gPxtxE), function(type) colMeans(gPxtxE[[type]],na.rm=T)))#
	germPE.se <-unlist(lapply(1:length(gPxtxE), function(type)  sapply(1:ncol(gPxtxE[[type]]), function(m) std.error(gPxtxE[[type]][,m]) )))#
	germPE.m <-  c(germPE.m, mean(germprb$isEarlyOrNrw))#
	germPE.se <-  c(germPE.se, std.error(germprb$isEarlyOrNrw))#
fxtxD <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  mean(flowering$isDelayOrExp[flowering$dummyWOSrelrank==w & flowering[,which(colnames(flowering)==cols[type])]==m] )   )))#
	fxtxD[[5]] <-  sapply(matypes, function(m)  sapply(wosdfM, function(w)  mean(floweringMAT$isDelayOrExp[floweringMAT$dummyWOSrelrank==w & floweringMAT$mating2==m ])   ))#
	flwrD.m <- unlist(lapply(1:length(fxtxD), function(type) colMeans(fxtxD[[type]],na.rm=T)))#
	flwrD.se <-unlist(lapply(1:length(fxtxD), function(type)  sapply(1:ncol(fxtxD[[type]]), function(m) std.error(fxtxD[[type]][,m]) )))#
	flwrD.m <-  c(flwrD.m, mean(flowering$isDelayOrExp))#
	flwrD.se <-  c(flwrD.se, std.error(flowering$isDelayOrExp))#
gTxtxD <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdgt, function(w)  mean(germtime$isDelayOrExp[germtime$dummyWOSrelrank==w & germtime[,which(colnames(germtime)==cols[type])]==m ] )   )))#
	gTxtxD[[5]] <-  sapply(matypes, function(m)  sapply(wosdgtM, function(w)  mean(germtimeMAT$isDelayOrExp[germtimeMAT$dummyWOSrelrank==w & germtimeMAT$mating2==m] )   ))#
	germTD.m <- unlist(lapply(1:length(gTxtxD), function(type) colMeans(gTxtxD[[type]],na.rm=T)))#
	germTD.se <-unlist(lapply(1:length(gTxtxD), function(type)  sapply(1:ncol(gTxtxD[[type]]), function(m) std.error(gTxtxD[[type]][,m]) )))#
	germTD.m <-  c(germTD.m, mean(germtime$isDelayOrExp))#
	germTD.se <-  c(germTD.se, std.error(germtime$isDelayOrExp))#
gPxtxD <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdgp, function(w)  mean(germprb$isDelayOrExp[germprb$dummyWOSrelrank==w & germprb[,which(colnames(germprb)==cols[type])]==m] )   )))#
	gPxtxD[[5]] <-  sapply(matypes, function(m)  sapply(wosdgpM, function(w)  mean(germprbMAT$isDelayOrExp[germprbMAT$dummyWOSrelrank==w & germprbMAT$mating2==m] )   ))#
	germPD.m <- unlist(lapply(1:length(gPxtxD), function(type) colMeans(gPxtxD[[type]],na.rm=T)))#
	germPD.se <-unlist(lapply(1:length(gPxtxD), function(type)  sapply(1:ncol(gPxtxD[[type]]), function(m) std.error(gPxtxD[[type]][,m]) )))#
	germPD.m <-  c(germPD.m, mean(germprb$isDelayOrExp))#
	germPD.se <-  c(germPD.se, std.error(germprb$isDelayOrExp))
flwrE.m
length(flwrE.m)
length(xvals)
xvals <- c(seq(from=0,to=1,length.out=c(4+3+2+3+5+1) ))#
xlab <- c("bacteria","myc fungi","mixed","other fungi","community","strain","strain mix","annual","both","perennial","root","seed","shoot","v. w/ reprod","v. w/o reprod","outcrosser","selfer","All")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(5,4,1,1))####NOTE THAT SOME OF THESE ARE ONLY SIG AT 0.9#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals,pch=16)#
	points(unlist(flwerD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=~xvals , y0=flwrE.m -flwrE.se, y1 = flwrE.m -flwrE.se,length=0     )#
	arrows(x0=~xvals+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m -flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[13:14])/2, sum(xvals[18:19])/2 ),lty=3 )#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals,pch=16)#
	points(unlist(germTD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=~xvals , y0=germTE.m -germTE.se, y1 = germTE.m -germTE.se,length=0     )#
	arrows(x0=~xvals+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m -germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[13:14])/2, sum(xvals[18:19])/2 ),lty=3 )#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=~xvals , y0=germPE.m -germPE.se, y1 = germPE.m -germPE.se,length=0     )#
	arrows(x0=~xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m -germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[13:14])/2, sum(xvals[18:19])/2 ),lty=3 )#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(5,4,1,1))####NOTE THAT SOME OF THESE ARE ONLY SIG AT 0.9#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals,pch=16)#
	points(unlist(flwrD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=flwrE.m -flwrE.se, y1 = flwrE.m -flwrE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m -flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[16:17])/2, sum(xvals[17:18])/2 ),lty=3 )#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals,pch=16)#
	points(unlist(germTD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germTE.m -germTE.se, y1 = germTE.m -germTE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m -germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[16:17])/2, sum(xvals[17:18])/2 ),lty=3 )#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germPE.m -germPE.se, y1 = germPE.m -germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m -germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[16:17])/2, sum(xvals[17:18])/2 ),lty=3 )#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))
germPD.se
unlist(lapply(1:length(gPxtxD), function(type)  sapply(1:ncol(gPxtxD[[type]]), function(m) std.error(gPxtxD[[type]][,m]) )))
germPE.m -germPE.se
germPE.m +germPE.se
flwrE.se
fxtxE <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  mean(flowering$isEarlyOrNrw[flowering$dummyWOSrelrank==w & flowering[,which(colnames(flowering)==cols[type])]==m] )   )))#
fxtxEse <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  std.error(flowering$isEarlyOrNrw[flowering$dummyWOSrelrank==w & flowering[,which(colnames(flowering)==cols[type])]==m] )   )))#
	fxtxE[[5]] <-  sapply(matypes, function(m)  sapply(wosdfM, function(w)  mean(floweringMAT$isEarlyOrNrw[floweringMAT$dummyWOSrelrank==w & floweringMAT$mating2==m ])   ))#
	fxtxEse[[5]] <-  sapply(matypes, function(m)  sapply(wosdfM, function(w)  std.error(floweringMAT$isEarlyOrNrw[floweringMAT$dummyWOSrelrank==w & floweringMAT$mating2==m ])   ))#
	flwrE.m <- unlist(lapply(1:length(fxtxE), function(type) colMeans(fxtxE[[type]],na.rm=T)))#
	flwrE.se <-unlist(lapply(1:length(fxtxEse), function(type)  sapply(1:ncol(fxtxEse[[type]]), function(m) mean(fxtxEse[[type]][,m],na.rm=T))))#
	flwrE.m <-  c(flwrE.m, mean(flowering$isEarlyOrNrw))#
	flwrE.se <-  c(flwrE.se, std.error(flowering$isEarlyOrNrw))
flwrE.se
fxtxE <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  mean(flowering$isEarlyOrNrw[flowering$dummyWOSrelrank==w & flowering[,which(colnames(flowering)==cols[type])]==m] )   )))#
fxtxEse <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  std.error(flowering$isEarlyOrNrw[flowering$dummyWOSrelrank==w & flowering[,which(colnames(flowering)==cols[type])]==m] )   )))#
	fxtxE[[5]] <-  sapply(matypes, function(m)  sapply(wosdfM, function(w)  mean(floweringMAT$isEarlyOrNrw[floweringMAT$dummyWOSrelrank==w & floweringMAT$mating2==m ])   ))#
	fxtxEse[[5]] <-  sapply(matypes, function(m)  sapply(wosdfM, function(w)  std.error(floweringMAT$isEarlyOrNrw[floweringMAT$dummyWOSrelrank==w & floweringMAT$mating2==m ])   ))#
	flwrE.m <- unlist(lapply(1:length(fxtxE), function(type) colMeans(fxtxE[[type]],na.rm=T)))#
	flwrE.se <-unlist(lapply(1:length(fxtxEse), function(type)  sapply(1:ncol(fxtxEse[[type]]), function(m) mean(fxtxEse[[type]][,m],na.rm=T))))#
	flwrE.m <-  c(flwrE.m, mean(flowering$isEarlyOrNrw))#
	flwrE.se <-  c(flwrE.se, std.error(flowering$isEarlyOrNrw))#
gTxtxE <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  mean(germtime$isEarlyOrNrw[germtime$dummyWOSrelrank==w & germtime[,which(colnames(germtime)==cols[type])]==m] )   )))#
gTxtxEse <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  std.error(germtime$isEarlyOrNrw[germtime$dummyWOSrelrank==w & germtime[,which(colnames(germtime)==cols[type])]==m] )   )))#
	gTxtxE[[5]] <-  sapply(matypes, function(m)  sapply(wosdgtM, function(w)  mean(germtimeMAT$isEarlyOrNrw[germtimeMAT$dummyWOSrelrank==w & germtimeMAT$mating2==m ])   ))#
	gTxtxEse[[5]] <-  sapply(matypes, function(m)  sapply(wosdgtM, function(w)  std.error(germtimeMAT$isEarlyOrNrw[germtimeMAT$dummyWOSrelrank==w & germtimeMAT$mating2==m ])   ))#
	germTE.m <- unlist(lapply(1:length(gTxtxE), function(type) colMeans(gTxtxE[[type]],na.rm=T)))#
	germTE.se <-unlist(lapply(1:length(gTxtxEse), function(type)  sapply(1:ncol(gTxtxEse[[type]]), function(m) mean(gTxtxEse[[type]][,m],na.rm=T))))#
	germTE.m <-  c(germTE.m, mean(germtime$isEarlyOrNrw))#
	germTE.se <-  c(germTE.se, std.error(germtime$isEarlyOrNrw))#
gPxtxE <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  mean(germprb$isEarlyOrNrw[germprb$dummyWOSrelrank==w & germprb[,which(colnames(germprb)==cols[type])]==m] )   )))#
gPxtxEse <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  std.error(germprb$isEarlyOrNrw[germprb$dummyWOSrelrank==w & germprb[,which(colnames(germprb)==cols[type])]==m] )   )))#
	gPxtxE[[5]] <-  sapply(matypes, function(m)  sapply(wosdgpM, function(w)  mean(germprbMAT$isEarlyOrNrw[germprbMAT$dummyWOSrelrank==w & germprbMAT$mating2==m ])   ))#
	gPxtxEse[[5]] <-  sapply(matypes, function(m)  sapply(wosdgpM, function(w)  std.error(germprbMAT$isEarlyOrNrw[germprbMAT$dummyWOSrelrank==w & germprbMAT$mating2==m ])   ))#
	germPE.m <- unlist(lapply(1:length(gPxtxE), function(type) colMeans(gPxtxE[[type]],na.rm=T)))#
	germPE.se <-unlist(lapply(1:length(gPxtxEse), function(type)  sapply(1:ncol(gPxtxEse[[type]]), function(m) mean(gPxtxEse[[type]][,m],na.rm=T))))#
	germPE.m <-  c(germPE.m, mean(germprb$isEarlyOrNrw))#
	germPE.se <-  c(germPE.se, std.error(germprb$isEarlyOrNrw))#
fxtxD <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  mean(flowering$isDelayOrExp[flowering$dummyWOSrelrank==w & flowering[,which(colnames(flowering)==cols[type])]==m] )   )))#
fxtxDse <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  std.error(flowering$isDelayOrExp[flowering$dummyWOSrelrank==w & flowering[,which(colnames(flowering)==cols[type])]==m] )   )))#
	fxtxD[[5]] <-  sapply(matypes, function(m)  sapply(wosdfM, function(w)  mean(floweringMAT$isDelayOrExp[floweringMAT$dummyWOSrelrank==w & floweringMAT$mating2==m ])   ))#
	fxtxDse[[5]] <-  sapply(matypes, function(m)  sapply(wosdfM, function(w)  std.error(floweringMAT$isDelayOrExp[floweringMAT$dummyWOSrelrank==w & floweringMAT$mating2==m ])   ))#
	flwrD.m <- unlist(lapply(1:length(fxtxD), function(type) colMeans(fxtxD[[type]],na.rm=T)))#
	flwrD.se <-unlist(lapply(1:length(fxtxDse), function(type)  sapply(1:ncol(fxtxDse[[type]]), function(m) mean(fxtxDse[[type]][,m],na.rm=T))))#
	flwrD.m <-  c(flwrD.m, mean(flowering$isDelayOrExp))#
	flwrD.se <-  c(flwrD.se, std.error(flowering$isDelayOrExp))#
gTxtxD <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  mean(germtime$isDelayOrExp[germtime$dummyWOSrelrank==w & germtime[,which(colnames(germtime)==cols[type])]==m] )   )))#
gTxtxDse <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  std.error(germtime$isDelayOrExp[germtime$dummyWOSrelrank==w & germtime[,which(colnames(germtime)==cols[type])]==m] )   )))#
	gTxtxD[[5]] <-  sapply(matypes, function(m)  sapply(wosdgtM, function(w)  mean(germtimeMAT$isDelayOrExp[germtimeMAT$dummyWOSrelrank==w & germtimeMAT$mating2==m ])   ))#
	gTxtxDse[[5]] <-  sapply(matypes, function(m)  sapply(wosdgtM, function(w)  std.error(germtimeMAT$isDelayOrExp[germtimeMAT$dummyWOSrelrank==w & germtimeMAT$mating2==m ])   ))#
	germTD.m <- unlist(lapply(1:length(gTxtxD), function(type) colMeans(gTxtxD[[type]],na.rm=T)))#
	germTD.se <-unlist(lapply(1:length(gTxtxDse), function(type)  sapply(1:ncol(gTxtxDse[[type]]), function(m) mean(gTxtxDse[[type]][,m],na.rm=T))))#
	germTD.m <-  c(germTD.m, mean(germtime$isDelayOrExp))#
	germTD.se <-  c(germTD.se, std.error(germtime$isDelayOrExp))#
gPxtxD <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  mean(germprb$isDelayOrExp[germprb$dummyWOSrelrank==w & germprb[,which(colnames(germprb)==cols[type])]==m] )   )))#
gPxtxDse <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  std.error(germprb$isDelayOrExp[germprb$dummyWOSrelrank==w & germprb[,which(colnames(germprb)==cols[type])]==m] )   )))#
	gPxtxD[[5]] <-  sapply(matypes, function(m)  sapply(wosdgpM, function(w)  mean(germprbMAT$isDelayOrExp[germprbMAT$dummyWOSrelrank==w & germprbMAT$mating2==m ])   ))#
	gPxtxDse[[5]] <-  sapply(matypes, function(m)  sapply(wosdgpM, function(w)  std.error(germprbMAT$isDelayOrExp[germprbMAT$dummyWOSrelrank==w & germprbMAT$mating2==m ])   ))#
	germPD.m <- unlist(lapply(1:length(gPxtxD), function(type) colMeans(gPxtxD[[type]],na.rm=T)))#
	germPD.se <-unlist(lapply(1:length(gPxtxDse), function(type)  sapply(1:ncol(gPxtxDse[[type]]), function(m) mean(gPxtxDse[[type]][,m],na.rm=T))))#
	germPD.m <-  c(germPD.m, mean(germprb$isDelayOrExp))#
	germPD.se <-  c(germPD.se, std.error(germprb$isDelayOrExp))
xvals <- c(seq(from=0,to=1,length.out=c(4+3+2+3+5+1) ))#
xlab <- c("bacteria","myc fungi","mixed","other fungi","community","strain","strain mix","annual","both","perennial","root","seed","shoot","v. w/ reprod","v. w/o reprod","outcrosser","selfer","All")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(5,4,1,1))####NOTE THAT SOME OF THESE ARE ONLY SIG AT 0.9#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals,pch=16)#
	points(unlist(flwrD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=flwrE.m -flwrE.se, y1 = flwrE.m -flwrE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m -flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[16:17])/2, sum(xvals[17:18])/2 ),lty=3 )#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals,pch=16)#
	points(unlist(germTD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germTE.m -germTE.se, y1 = germTE.m -germTE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m -germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[16:17])/2, sum(xvals[17:18])/2 ),lty=3 )#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germPE.m -germPE.se, y1 = germPE.m -germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m -germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[16:17])/2, sum(xvals[17:18])/2 ),lty=3 )#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)
germTE.se
germPE.se
flwr.se
flwrE.se
xvals <- c(seq(from=0,to=1,length.out=c(4+3+2+3+5+1) ))#
xlab <- c("bacteria","myc fungi","mixed","other fungi","community","strain","strain mix","annual","both","perennial","root","seed","shoot","v. w/ reprod","v. w/o reprod","outcrosser","selfer","All")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(5,4,1,1))####NOTE THAT SOME OF THESE ARE ONLY SIG AT 0.9#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals,pch=16)#
	points(unlist(flwrD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=flwrE.m -flwrE.se, y1 = flwrE.m +flwrE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m +flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[16:17])/2, sum(xvals[17:18])/2 ),lty=3 )#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals,pch=16)#
	points(unlist(germTD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germTE.m -germTE.se, y1 = germTE.m +germTE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m +germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[16:17])/2, sum(xvals[17:18])/2 ),lty=3 )#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germPE.m -germPE.se, y1 = germPE.m +germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m +germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[16:17])/2, sum(xvals[17:18])/2 ),lty=3 )#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)
xvals <- c(seq(from=0,to=1,length.out=c(4+3+2+3+5+1) ))#
xlab <- c("bacteria","myc fungi","mixed","other fungi","community","strain","strain mix","annual","both","perennial","root","seed","shoot","v. w/ reprod","v. w/o reprod","outcrosser","selfer","All")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(5,4,1,1))####NOTE THAT SOME OF THESE ARE ONLY SIG AT 0.9#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals,pch=16)#
	points(unlist(flwrD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=flwrE.m -flwrE.se, y1 = flwrE.m +flwrE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m +flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[16:17])/2, sum(xvals[17:18])/2 ),lty=3 )#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals,pch=16)#
	points(unlist(germTD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germTE.m -germTE.se, y1 = germTE.m +germTE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m +germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[16:17])/2, sum(xvals[17:18])/2 ),lty=3 )#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germPE.m -germPE.se, y1 = germPE.m +germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m +germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[16:17])/2, sum(xvals[17:18])/2 ),lty=3 )#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)
xvals <- c(seq(from=0,to=1,length.out=c(4+3+2+3+5+1) ))#
xlab <- c("bacteria","myc fungi","mixed","other fungi","community","strain","strain mix","annual","both","perennial","root","seed","shoot","v. w/ reprod","v. w/o reprod","outcrosser","selfer","All")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(5,4,1,1))####NOTE THAT SOME OF THESE ARE ONLY SIG AT 0.9#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals,pch=16)#
	points(unlist(flwrD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=flwrE.m -flwrE.se, y1 = flwrE.m +flwrE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m +flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[16:17])/2, sum(xvals[17:18])/2 ),lty=3 )#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals,pch=16)#
	points(unlist(germTD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germTE.m -germTE.se, y1 = germTE.m +germTE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m +germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[16:17])/2, sum(xvals[17:18])/2 ),lty=3 )#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germPE.m -germPE.se, y1 = germPE.m +germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m +germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[15:16])/2, sum(xvals[17:18])/2 ),lty=3 )#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)
summary(flowerbitax)
summary(flowerbiscom)
summary(flowerbils)
summary(flowerbilh)
summary(flowerbiloc)
summary(flowerbimat)
summary(flowerDbitax)
summary(flowerDbiscom)
summary(flowerDbilh)
summary(flowerDbimat)
summary(flowerDbiloc)
summary(germtimebitax)
summary(floweringbitax)
summary(flowerbitax)
summary(flowerDbitax)
summary(germprbbitax)
summary(germprbDbitax)
split_recs_scr$micrtax.sim2[split_recs_scr$micrtax.sim2=="rhizobia"] <- "bacteria" #rhizobia not allowed in this category
table(split_recs_scr$micrtax.sim2)
##numbers for text#
split_recs_scr$anyeffnum <- as.numeric(as.factor(split_recs_scr$anyeffect))-1#
sum(   tapply(split_recs_scr$anyeffnum[split_recs_scr$micrtax.sim2=="MF"],split_recs_scr$WOS.relevance.rank[split_recs_scr$micrtax.sim2=="MF"],sum) ==0)#4#
length(tapply(split_recs_scr$anyeffnum[split_recs_scr$micrtax.sim2=="MF"],split_recs_scr$WOS.relevance.rank[split_recs_scr$micrtax.sim2=="MF"],sum))#17  17-4 = 13#
sum(   tapply(split_recs_scr$anyeffnum[split_recs_scr$micrtax.sim2=="bacteria"],split_recs_scr$WOS.relevance.rank[split_recs_scr$micrtax.sim2=="bacteria"],sum) ==0)#0#
length(tapply(split_recs_scr$anyeffnum[split_recs_scr$micrtax.sim2=="bacteria"],split_recs_scr$WOS.relevance.rank[split_recs_scr$micrtax.sim2=="bacteria"],sum))#13#
table(split_recs_scr$WOS.relevance.rank[split_recs_scr$micrloc3=="various incl reproductive"])#
length(unique(split_recs_scr$WOS.relevance.rank[split_recs_scr$phen.trait.2=="fruiting time"]))#
length(unique(split_recs_scr$WOS.relevance.rank[split_recs_scr$phen.trait.2=="senescence time"]))#
length(unique(split_recs_scr$WOS.relevance.rank[split_recs_scr$phen.trait.2 %in% c("phyllochron","budburst") ]))
flowering <- split_recs_scr[split_recs_scr$phen.trait.2=="flowering time",]#
	flowering <- flowering[flowering$micrtax.sim2!= "virus",] #subtract the one  record in this categories#
	flowering$dummyWOSrelrank <- flowering$WOS.relevance.rank#
	flowering$dummyWOSrelrank[flowering$dummyWOSrelran%in%names(table(flowering$WOS.relevance.rank)[table(flowering$WOS.relevance.rank)<13])] <- "binned"#
floweringMAT <- split_recs_scr[split_recs_scr$phen.trait.2=="flowering time" & split_recs_scr$mating2 != "unk" & split_recs_scr$mating2 != "s+o",]#
	floweringMAT$dummyWOSrelrank <- floweringMAT$WOS.relevance.rank#
	floweringMAT$dummyWOSrelrank[floweringMAT$dummyWOSrelran%in%names(table(floweringMAT$WOS.relevance.rank)[table(floweringMAT$WOS.relevance.rank)<13])] <- "binned"#
germtime <- split_recs_scr[split_recs_scr$phen.trait.2=="germination time",]#
	germtime <- germtime[germtime$micrtax.sim2!= "MF; fungi",] #subtract the one  record in this categories#
	germtime$dummyWOSrelrank <- germtime$WOS.relevance.rank#
	germtime$dummyWOSrelrank[germtime$dummyWOSrelran%in%names(table(germtime$WOS.relevance.rank)[table(germtime$WOS.relevance.rank)<13])] <- "binned"#
germtimeMAT <- split_recs_scr[split_recs_scr$phen.trait.2=="germination time" & split_recs_scr$mating2 != "unk" & split_recs_scr$mating2 != "s+o",]#
	germtimeMAT$dummyWOSrelrank <- germtimeMAT$WOS.relevance.rank#
	germtimeMAT$dummyWOSrelrank[germtimeMAT$dummyWOSrelran%in%names(table(germtimeMAT$WOS.relevance.rank)[table(germtimeMAT$WOS.relevance.rank)<13])] <- "binned"#
germprb <- split_recs_scr[split_recs_scr$phen.trait.2=="germination prb"& split_recs_scr$mating2 != "unk" & split_recs_scr$mating2 != "s+o",]#
	germprb <- germprb[germprb$micrtax.sim2!= "MF; fungi",] #subtract the one  records in this categories#
	germprb$dummyWOSrelrank <- germprb$WOS.relevance.rank#
	germprb$dummyWOSrelrank[germprb$dummyWOSrelran%in%names(table(germprb$WOS.relevance.rank)[table(germprb$WOS.relevance.rank)<13])] <- "binned"#
# 	germprb<- germprb[-which(germprb$culture.sim=="observed"),] #removing the sole record that is not manipulated#
#no longer need to remove the observed record; as not checking how this relates to results #
germprbMAT <- split_recs_scr[split_recs_scr$phen.trait.2=="germination prb" & split_recs_scr$mating2 != "unk" & split_recs_scr$mating2 != "s+o",]#
	germprbMAT$dummyWOSrelrank <- germprbMAT$WOS.relevance.rank#
	germprbMAT$dummyWOSrelrank[germprbMAT$dummyWOSrelran%in%names(table(germprbMAT$WOS.relevance.rank)[table(germprbMAT$WOS.relevance.rank)<13])] <- "binned"#
# 	germprbMAT<- germprbMAT[-which(germprbMAT$culture.sim=="observed"),] #removing the sole record that is not manipulated#
allphen <- split_recs_scr[!is.na(split_recs_scr$phen.trait.2),]#
	allphen$dummyWOSrelrank <- allphen$WOS.relevance.rank#
	allphen$dummyWOSrelrank[allphen$dummyWOSrelran%in%names(table(allphen$WOS.relevance.rank)[table(allphen$WOS.relevance.rank)<13])] <- "binned"#
###for numbers in text:#
flowering$anyeffnum <- as.numeric(as.factor(flowering$anyeffect))-1#
sum(tapply(flowering$anyeffnum,flowering$WOS.relevance.rank,sum) == 0) #6#
length(tapply(flowering$anyeffnum,flowering$WOS.relevance.rank,sum))#39#
germtime$anyeffnum <- as.numeric(as.factor(germtime$anyeffect))-1#
sum(tapply(germtime$anyeffnum,germtime$WOS.relevance.rank,sum) ==0)#1 -- note this record only appears in germtime, not germprb#
length(tapply(germtime$anyeffnum,germtime$WOS.relevance.rank,sum))#19#
germprb$anyeffnum <- as.numeric(as.factor(germprb$anyeffect))-1#
sum(tapply(germprb$anyeffnum,germprb$WOS.relevance.rank,sum) ==0)#0#
length(tapply(germprb$anyeffnum,germprb$WOS.relevance.rank,sum))#13#
length(unique(c(germprb$WOS.relevance.rank, germtime$WOS.relevance.rank)))#overlap
flowerbitax <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~micrtax.sim2,random = ~dummyWOSrelrank,data=flowering,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
flowerDbitax <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~micrtax.sim2,random = ~dummyWOSrelrank,data=flowering,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germtimebitax <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~micrtax.sim2,random = ~dummyWOSrelrank,data=germtime,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germtimeDbitax <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~micrtax.sim2,random = ~dummyWOSrelrank,data=germtime,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbbitax <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~micrtax.sim2,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbDbitax <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~micrtax.sim2,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)
summary(flowerbitax)
summary(flowerDbitax)
summary(germtimebitax)
HPDinterval(germtimebitax$Sol)
HPDinterval(germtimebitax$Sol,prb=0.9)
HPDinterval(germtimebitax$Sol,prob=0.9)
summary(germtimebiscom)
summary(germtimebilh)
summary(germtimebiloc)
summary(germtimebimat)
summary(germtimeDbitax)
summary(germtimeDscom)
summary(germtimeDbiscom)
summary(germtimeDbilh)
summary(germtimeDbiloc)
summary(germtimeDbimat)
summary(germprbbitax)
table(germprb$micrtax.sim2)
table(split_recs_scr$micrtax.sim2)
table(paste(split_recs_scr$micrtax.sim2,split_recs_scr$phen.trait.2))
germprb <- split_recs_scr[split_recs_scr$phen.trait.2=="germination prb",]#
	germprb <- germprb[germprb$micrtax.sim2!= "MF; fungi",] #subtract the one  records in this categories#
	germprb$dummyWOSrelrank <- germprb$WOS.relevance.rank#
	germprb$dummyWOSrelrank[germprb$dummyWOSrelran%in%names(table(germprb$WOS.relevance.rank)[table(germprb$WOS.relevance.rank)<13])] <- "binned"#
# 	germprb<- germprb[-which(germprb$culture.sim=="observed"),] #removing the sole record that is not manipulated#
#no longer need to remove the observed record; as not checking how this relates to results #
germprbMAT <- split_recs_scr[split_recs_scr$phen.trait.2=="germination prb" & split_recs_scr$mating2 != "unk" & split_recs_scr$mating2 != "s+o",]#
	germprbMAT$dummyWOSrelrank <- germprbMAT$WOS.relevance.rank#
	germprbMAT$dummyWOSrelrank[germprbMAT$dummyWOSrelran%in%names(table(germprbMAT$WOS.relevance.rank)[table(germprbMAT$WOS.relevance.rank)<13])] <- "binned"#
# 	germprbMAT<- germprbMAT[-which(germprbMAT$culture.sim=="observed"),] #removing the sole record that is not manipulated
table(germprb$micrtax.sim2)
which(split_recs_scr$micrtax.sim2 %in% c("virus","MF; fungi")
)
split_recs <- read.csv("trimmed RECORDS FOR SPLITTING v3.csv", #sep="\t",#
					stringsAsFactors=F,na.strings = c("NA","")) #
			#hand removed some columns, re-enforced the 5 options for direction of effect#
			#also re-enforced options for mating, microbe nutrient-pathogen-other; Micrloc.2; state.relative.too, incl 1 "sterilized soils" to "without focal microbe"#
			#also, there seem to be some extra rows still, perhaps those should be reomoved.#
			#there are a few notes about changes in how records are scored, might want to make sure those are reflected in the previous tab as well?#
			#Deleted a few effect directions to be blank because it seemed like they were a pooled version of split records? (e.g. still had two traits mixed --"flowering time; fruiting time" -- this might not be right)#
split_recs_scr <- split_recs[!is.na(split_recs$direction.effect.split),]
split_recs_scr <- split_recs_scr[-which(split_recs_scr$micrtax.sim2 %in% c("virus","MF; fungi")),]#
#
split_recs_scr$direction.effect.split[split_recs_scr$direction.effect.split== "later"] <- "delayed" #
split_recs_scr$direction.effect.split[split_recs_scr$direction.effect.split %in% c("decreased","reduced")] <- "narrowed" #
split_recs_scr$direction.effect.split[split_recs_scr$direction.effect.split %in% c("increased","extended")] <- "expanded" #
split_recs_scr$direction.effect.split[split_recs_scr$direction.effect.split== "none "] <- "none" #
#
split_recs_scr$culture.sim[split_recs_scr$culture.sim %in% c("culture; direct","cutlure")] <- "culture" # making a decision on Lu2018 #
split_recs_scr$micrtax.sim2[split_recs_scr$micrtax.sim2=="fungi"] <- "otherfungi" #changing alphabetical position for convenience#
split_recs_scr$micrtax.sim2[split_recs_scr$micrtax.sim2=="rhizobia"] <- "bacteria" #rhizobia not allowed in this category#
#
numeric.phen.eff <- rep(NA, length=nrow(split_recs_scr))#
numeric.phen.eff[split_recs_scr$direction.effect.split=="earlier"] <- -1#
numeric.phen.eff[split_recs_scr$direction.effect.split=="delayed"] <- 1#
numeric.phen.eff[split_recs_scr$direction.effect.split=="none"] <- 0#
numeric.phen.eff[split_recs_scr$direction.effect.split=="expanded"] <- 1#
numeric.phen.eff[split_recs_scr$direction.effect.split=="narrowed"] <- -1#
split_recs_scr$numeric.phen.eff <- numeric.phen.eff#
split_recs_scr$lifeform2 <- split_recs_scr$lifeform#
split_recs_scr$lifeform2[  split_recs_scr$lifeform %in% c("annual in cultivation (perennnial)","perennial; annual (both)","both") ] <-  "both"#
split_recs_scr$lifeform2[  split_recs_scr$lifeform =="perennial (biennial?)" ] <-  "perennial"#
split_recs_scr$mating2 <- split_recs_scr$mating#
split_recs_scr$mating2 [is.na(split_recs_scr$mating)] <- "unk"#
split_recs_scr$mating2 [split_recs_scr$mating=="outcross?"] <- "unk"#
split_recs_scr$mating2 [split_recs_scr$mating=="both"] <- "s+o"#
split_recs_scr$mating2 [split_recs_scr$mating %in% c("selfie","selifer","selfier")] <- "selfer" #correcting spelling errors#
split_recs_scr$phen.trait.2[split_recs_scr$phen.trait.2=='"budburst"'] <- "budburst" #correcting spelling errors#
split_recs_scr$micrloc3 <- split_recs_scr$Micrloc.2#
split_recs_scr$micrloc3 [split_recs_scr$Micrloc.2%in% c("reproductive; shoot","root; shoot; reproductive","root; shoot; reproductive; seed")] <- "various incl reproductive"#
split_recs_scr$micrloc3 [split_recs_scr$Micrloc.2%in% c("seed; shoot","root; shoot","root; seed","root; shoot; seed")] <- "various not incl reproductive"#
split_recs_scr$micrloc3 [split_recs_scr$Micrloc.2=="seed "] <- "seed"#
split_recs_scr$micrloc3 [split_recs_scr$Micrloc.2=="leaves"] <- "shoot"#
#
##variables for binomial versions#
split_recs_scr$isEarlyOrNrw <- ifelse(numeric.phen.eff=="-1",1,0)#
split_recs_scr$notEarlyOrNrw <- 1-split_recs_scr$isEarlyOrNrw#
split_recs_scr$isDelayOrExp <- ifelse(numeric.phen.eff=="1",1,0)#
split_recs_scr$notDelayOrExp <- 1-split_recs_scr$isDelayOrExp#
split_recs_scr$isSig <- ifelse(numeric.phen.eff=="1" | numeric.phen.eff=="-1",1,0)#
split_recs_scr$notSig <- 1- split_recs_scr$isSig #
##numbers for text#
split_recs_scr$anyeffnum <- as.numeric(as.factor(split_recs_scr$anyeffect))-1#
sum(   tapply(split_recs_scr$anyeffnum[split_recs_scr$micrtax.sim2=="MF"],split_recs_scr$WOS.relevance.rank[split_recs_scr$micrtax.sim2=="MF"],sum) ==0)#4#
length(tapply(split_recs_scr$anyeffnum[split_recs_scr$micrtax.sim2=="MF"],split_recs_scr$WOS.relevance.rank[split_recs_scr$micrtax.sim2=="MF"],sum))#17  17-4 = 13#
sum(   tapply(split_recs_scr$anyeffnum[split_recs_scr$micrtax.sim2=="bacteria"],split_recs_scr$WOS.relevance.rank[split_recs_scr$micrtax.sim2=="bacteria"],sum) ==0)#0#
length(tapply(split_recs_scr$anyeffnum[split_recs_scr$micrtax.sim2=="bacteria"],split_recs_scr$WOS.relevance.rank[split_recs_scr$micrtax.sim2=="bacteria"],sum))#13#
table(split_recs_scr$WOS.relevance.rank[split_recs_scr$micrloc3=="various incl reproductive"])#
length(unique(split_recs_scr$WOS.relevance.rank[split_recs_scr$phen.trait.2=="fruiting time"]))#
length(unique(split_recs_scr$WOS.relevance.rank[split_recs_scr$phen.trait.2=="senescence time"]))#
length(unique(split_recs_scr$WOS.relevance.rank[split_recs_scr$phen.trait.2 %in% c("phyllochron","budburst") ]))#
#
flowering <- split_recs_scr[split_recs_scr$phen.trait.2=="flowering time",]#
# 	flowering <- flowering[flowering$micrtax.sim2!= "virus",] #subtract the one  record in this categories#
	flowering$dummyWOSrelrank <- flowering$WOS.relevance.rank#
	flowering$dummyWOSrelrank[flowering$dummyWOSrelran%in%names(table(flowering$WOS.relevance.rank)[table(flowering$WOS.relevance.rank)<13])] <- "binned"#
floweringMAT <- split_recs_scr[split_recs_scr$phen.trait.2=="flowering time" & split_recs_scr$mating2 != "unk" & split_recs_scr$mating2 != "s+o",]#
	floweringMAT$dummyWOSrelrank <- floweringMAT$WOS.relevance.rank#
	floweringMAT$dummyWOSrelrank[floweringMAT$dummyWOSrelran%in%names(table(floweringMAT$WOS.relevance.rank)[table(floweringMAT$WOS.relevance.rank)<13])] <- "binned"#
germtime <- split_recs_scr[split_recs_scr$phen.trait.2=="germination time",]#
# 	germtime <- germtime[germtime$micrtax.sim2!= "MF; fungi",] #subtract the one  record in this categories#
	germtime$dummyWOSrelrank <- germtime$WOS.relevance.rank#
	germtime$dummyWOSrelrank[germtime$dummyWOSrelran%in%names(table(germtime$WOS.relevance.rank)[table(germtime$WOS.relevance.rank)<13])] <- "binned"#
germtimeMAT <- split_recs_scr[split_recs_scr$phen.trait.2=="germination time" & split_recs_scr$mating2 != "unk" & split_recs_scr$mating2 != "s+o",]#
	germtimeMAT$dummyWOSrelrank <- germtimeMAT$WOS.relevance.rank#
	germtimeMAT$dummyWOSrelrank[germtimeMAT$dummyWOSrelran%in%names(table(germtimeMAT$WOS.relevance.rank)[table(germtimeMAT$WOS.relevance.rank)<13])] <- "binned"#
germprb <- split_recs_scr[split_recs_scr$phen.trait.2=="germination prb",]#
# 	germprb <- germprb[germprb$micrtax.sim2!= "MF; fungi",] #subtract the one  records in this categories#
	germprb$dummyWOSrelrank <- germprb$WOS.relevance.rank#
	germprb$dummyWOSrelrank[germprb$dummyWOSrelran%in%names(table(germprb$WOS.relevance.rank)[table(germprb$WOS.relevance.rank)<13])] <- "binned"#
# 	germprb<- germprb[-which(germprb$culture.sim=="observed"),] #removing the sole record that is not manipulated#
#no longer need to remove the observed record; as not checking how this relates to results #
germprbMAT <- split_recs_scr[split_recs_scr$phen.trait.2=="germination prb" & split_recs_scr$mating2 != "unk" & split_recs_scr$mating2 != "s+o",]#
	germprbMAT$dummyWOSrelrank <- germprbMAT$WOS.relevance.rank#
	germprbMAT$dummyWOSrelrank[germprbMAT$dummyWOSrelran%in%names(table(germprbMAT$WOS.relevance.rank)[table(germprbMAT$WOS.relevance.rank)<13])] <- "binned"#
# 	germprbMAT<- germprbMAT[-which(germprbMAT$culture.sim=="observed"),] #removing the sole record that is not manipulated#
allphen <- split_recs_scr[!is.na(split_recs_scr$phen.trait.2),]#
	allphen$dummyWOSrelrank <- allphen$WOS.relevance.rank#
	allphen$dummyWOSrelrank[allphen$dummyWOSrelran%in%names(table(allphen$WOS.relevance.rank)[table(allphen$WOS.relevance.rank)<13])] <- "binned"
flowerbimat <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~mating2,random = ~dummyWOSrelrank,data=floweringMAT,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)
flowerbimat
summary(flowerbimat)
flowerDbimat <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~mating2,random = ~dummyWOSrelrank,data=floweringMAT,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germtimebimat <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~mating2,random = ~dummyWOSrelrank,data=germtimeMAT,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germtimeDbimat <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~mating2,random = ~dummyWOSrelrank,data=germtimeMAT,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)
summary(flowerDbimat)
summary(germtimebimat)
summary(germtimeDbimat)
germprbbitax <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~micrtax.sim2,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbbiscom <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~Strainvcomm.1,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbbimat <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~mating2,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbbilh <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~lifeform2,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbbiloc <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~micrloc3,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbDbitax <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~micrtax.sim2,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbDbiscom <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~Strainvcomm.1,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbDbimat <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~mating2,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbDbilh <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~lifeform2,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)#
germprbDbiloc <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~micrloc3,random = ~dummyWOSrelrank,data=germprb,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)
summary
summary(germprbbitax)
summary(germprbbiscom)
summary(germprbbilh)
summary(germprbbloc)
summary(germprbbiloc)
HPDinterval(germprbbiloc$Sol)
HPDinterval(germprbbiloc$Sol,prob=0.9)
summary(germprbbimat)
summary(germprbDbitax)
HPDinterval(germprbbiscom$Sol,prob=0.9)
HPDinterval(germprbbiscom$Sol)
summary(germprbDbiscom)
summary(germprbDbilh)
summary(germprbDbiloc)
summary(germprbDbimat)
summary(germprbbimat)
summary(germtimebimat)
summary(germtimeDbimat)
summary(floweringDbimat)
summary(flowerDbimat)
summary(flowerbimat)
germprbbimat <- MCMCglmm(cbind(isEarlyOrNrw, notEarlyOrNrw)~mating2,random = ~dummyWOSrelrank,data=germprbMAT,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)
summary(germprbbimat)
germprbDbimat <- MCMCglmm(cbind(isDelayOrExp, notDelayOrExp)~mating2,random = ~dummyWOSrelrank,data=germprbMAT,family="multinomial2",prior=priornuup,verbose=F,pr=T,nitt=1000000,thin=50,burnin=1000)
summary(germprbDbimat)
mtypes  <- c("bacteria","MF","mixed","otherfungi")#
ctypes <- c("community","strain","strain mix")#
lhtypes <- c("annual","both","perennial")#
loctypes <- c("root","seed","shoot","various incl reproductive","various not incl reproductive")#
typelist <- list(mtypes,ctypes,lhtypes,loctypes)#
cols <- c("micrtax.sim2","Strainvcomm.1","lifeform2","micrloc3")#
wosdf <- unique(flowering$dummyWOSrelrank)#
wosdgt <- unique(germtime$dummyWOSrelrank)#
wosdgp <- unique(germprb$dummyWOSrelrank)#
matypes <- c("selfer","outcross")#
wosdfM <- unique(floweringMAT$dummyWOSrelrank)#
wosdgtM <- unique(germtimeMAT$dummyWOSrelrank)#
wosdgpM <- unique(germprbMAT$dummyWOSrelrank)#
fxtxE <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  mean(flowering$isEarlyOrNrw[flowering$dummyWOSrelrank==w & flowering[,which(colnames(flowering)==cols[type])]==m] )   )))#
fxtxEse <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  std.error(flowering$isEarlyOrNrw[flowering$dummyWOSrelrank==w & flowering[,which(colnames(flowering)==cols[type])]==m] )   )))#
	fxtxE[[5]] <-  sapply(matypes, function(m)  sapply(wosdfM, function(w)  mean(floweringMAT$isEarlyOrNrw[floweringMAT$dummyWOSrelrank==w & floweringMAT$mating2==m ])   ))#
	fxtxEse[[5]] <-  sapply(matypes, function(m)  sapply(wosdfM, function(w)  std.error(floweringMAT$isEarlyOrNrw[floweringMAT$dummyWOSrelrank==w & floweringMAT$mating2==m ])   ))#
	flwrE.m <- unlist(lapply(1:length(fxtxE), function(type) colMeans(fxtxE[[type]],na.rm=T)))#
	flwrE.se <-unlist(lapply(1:length(fxtxEse), function(type)  sapply(1:ncol(fxtxEse[[type]]), function(m) mean(fxtxEse[[type]][,m],na.rm=T))))#
	flwrE.m <-  c(flwrE.m, mean(flowering$isEarlyOrNrw))#
	flwrE.se <-  c(flwrE.se, std.error(flowering$isEarlyOrNrw))#
gTxtxE <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  mean(germtime$isEarlyOrNrw[germtime$dummyWOSrelrank==w & germtime[,which(colnames(germtime)==cols[type])]==m] )   )))#
gTxtxEse <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  std.error(germtime$isEarlyOrNrw[germtime$dummyWOSrelrank==w & germtime[,which(colnames(germtime)==cols[type])]==m] )   )))#
	gTxtxE[[5]] <-  sapply(matypes, function(m)  sapply(wosdgtM, function(w)  mean(germtimeMAT$isEarlyOrNrw[germtimeMAT$dummyWOSrelrank==w & germtimeMAT$mating2==m ])   ))#
	gTxtxEse[[5]] <-  sapply(matypes, function(m)  sapply(wosdgtM, function(w)  std.error(germtimeMAT$isEarlyOrNrw[germtimeMAT$dummyWOSrelrank==w & germtimeMAT$mating2==m ])   ))#
	germTE.m <- unlist(lapply(1:length(gTxtxE), function(type) colMeans(gTxtxE[[type]],na.rm=T)))#
	germTE.se <-unlist(lapply(1:length(gTxtxEse), function(type)  sapply(1:ncol(gTxtxEse[[type]]), function(m) mean(gTxtxEse[[type]][,m],na.rm=T))))#
	germTE.m <-  c(germTE.m, mean(germtime$isEarlyOrNrw))#
	germTE.se <-  c(germTE.se, std.error(germtime$isEarlyOrNrw))#
gPxtxE <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  mean(germprb$isEarlyOrNrw[germprb$dummyWOSrelrank==w & germprb[,which(colnames(germprb)==cols[type])]==m] )   )))#
gPxtxEse <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  std.error(germprb$isEarlyOrNrw[germprb$dummyWOSrelrank==w & germprb[,which(colnames(germprb)==cols[type])]==m] )   )))#
	gPxtxE[[5]] <-  sapply(matypes, function(m)  sapply(wosdgpM, function(w)  mean(germprbMAT$isEarlyOrNrw[germprbMAT$dummyWOSrelrank==w & germprbMAT$mating2==m ])   ))#
	gPxtxEse[[5]] <-  sapply(matypes, function(m)  sapply(wosdgpM, function(w)  std.error(germprbMAT$isEarlyOrNrw[germprbMAT$dummyWOSrelrank==w & germprbMAT$mating2==m ])   ))#
	germPE.m <- unlist(lapply(1:length(gPxtxE), function(type) colMeans(gPxtxE[[type]],na.rm=T)))#
	germPE.se <-unlist(lapply(1:length(gPxtxEse), function(type)  sapply(1:ncol(gPxtxEse[[type]]), function(m) mean(gPxtxEse[[type]][,m],na.rm=T))))#
	germPE.m <-  c(germPE.m, mean(germprb$isEarlyOrNrw))#
	germPE.se <-  c(germPE.se, std.error(germprb$isEarlyOrNrw))#
fxtxD <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  mean(flowering$isDelayOrExp[flowering$dummyWOSrelrank==w & flowering[,which(colnames(flowering)==cols[type])]==m] )   )))#
fxtxDse <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  std.error(flowering$isDelayOrExp[flowering$dummyWOSrelrank==w & flowering[,which(colnames(flowering)==cols[type])]==m] )   )))#
	fxtxD[[5]] <-  sapply(matypes, function(m)  sapply(wosdfM, function(w)  mean(floweringMAT$isDelayOrExp[floweringMAT$dummyWOSrelrank==w & floweringMAT$mating2==m ])   ))#
	fxtxDse[[5]] <-  sapply(matypes, function(m)  sapply(wosdfM, function(w)  std.error(floweringMAT$isDelayOrExp[floweringMAT$dummyWOSrelrank==w & floweringMAT$mating2==m ])   ))#
	flwrD.m <- unlist(lapply(1:length(fxtxD), function(type) colMeans(fxtxD[[type]],na.rm=T)))#
	flwrD.se <-unlist(lapply(1:length(fxtxDse), function(type)  sapply(1:ncol(fxtxDse[[type]]), function(m) mean(fxtxDse[[type]][,m],na.rm=T))))#
	flwrD.m <-  c(flwrD.m, mean(flowering$isDelayOrExp))#
	flwrD.se <-  c(flwrD.se, std.error(flowering$isDelayOrExp))#
gTxtxD <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  mean(germtime$isDelayOrExp[germtime$dummyWOSrelrank==w & germtime[,which(colnames(germtime)==cols[type])]==m] )   )))#
gTxtxDse <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  std.error(germtime$isDelayOrExp[germtime$dummyWOSrelrank==w & germtime[,which(colnames(germtime)==cols[type])]==m] )   )))#
	gTxtxD[[5]] <-  sapply(matypes, function(m)  sapply(wosdgtM, function(w)  mean(germtimeMAT$isDelayOrExp[germtimeMAT$dummyWOSrelrank==w & germtimeMAT$mating2==m ])   ))#
	gTxtxDse[[5]] <-  sapply(matypes, function(m)  sapply(wosdgtM, function(w)  std.error(germtimeMAT$isDelayOrExp[germtimeMAT$dummyWOSrelrank==w & germtimeMAT$mating2==m ])   ))#
	germTD.m <- unlist(lapply(1:length(gTxtxD), function(type) colMeans(gTxtxD[[type]],na.rm=T)))#
	germTD.se <-unlist(lapply(1:length(gTxtxDse), function(type)  sapply(1:ncol(gTxtxDse[[type]]), function(m) mean(gTxtxDse[[type]][,m],na.rm=T))))#
	germTD.m <-  c(germTD.m, mean(germtime$isDelayOrExp))#
	germTD.se <-  c(germTD.se, std.error(germtime$isDelayOrExp))#
gPxtxD <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  mean(germprb$isDelayOrExp[germprb$dummyWOSrelrank==w & germprb[,which(colnames(germprb)==cols[type])]==m] )   )))#
gPxtxDse <- lapply(1:length(typelist), function(type) sapply(typelist[[type]], function(m)  sapply(wosdf, function(w)  std.error(germprb$isDelayOrExp[germprb$dummyWOSrelrank==w & germprb[,which(colnames(germprb)==cols[type])]==m] )   )))#
	gPxtxD[[5]] <-  sapply(matypes, function(m)  sapply(wosdgpM, function(w)  mean(germprbMAT$isDelayOrExp[germprbMAT$dummyWOSrelrank==w & germprbMAT$mating2==m ])   ))#
	gPxtxDse[[5]] <-  sapply(matypes, function(m)  sapply(wosdgpM, function(w)  std.error(germprbMAT$isDelayOrExp[germprbMAT$dummyWOSrelrank==w & germprbMAT$mating2==m ])   ))#
	germPD.m <- unlist(lapply(1:length(gPxtxD), function(type) colMeans(gPxtxD[[type]],na.rm=T)))#
	germPD.se <-unlist(lapply(1:length(gPxtxDse), function(type)  sapply(1:ncol(gPxtxDse[[type]]), function(m) mean(gPxtxDse[[type]][,m],na.rm=T))))#
	germPD.m <-  c(germPD.m, mean(germprb$isDelayOrExp))#
	germPD.se <-  c(germPD.se, std.error(germprb$isDelayOrExp))#
#
#fill in from model results#
siggroupsFE <- c( "a","ab","ab","b",#tax#
				"","","",#scom#
				"a","ab","b",#lh #all ns if 0.95#
				"a","b","b","ab","ab" #loc#
				"","", ""	) #mat#
siggroupsFD <- c("b","ab","b","ab",#tax#
				"a","b","b",#scom#
				"","","",#lh#
				"a","b","a","a","a", #loc#
				"","", ""	) #mat#
siggroupsGtE <- c( "b","a","c","b",#tax  #at .95; other fungi can'd be dist from mixed#
				"","","",#scom#
				"b","ab","a",#lh#
				"","","","","", #loc#
				"","", ""	) #mat#
siggroupsGtD <- c( "b","c","a","a",#tax#
				"a","b","b",#scom ##
				"","","",#lh#
				"a","a","b","a","b",#loc#
				"","", ""	) #mat#
siggroupsGpE <- c( "b","c","a","a",#tax#
				"a","ab","b",#
				"","","",#lh#
				"a","a","b","a","ab", #loc#
				"","", ""	) #mat#
siggroupsGpE <- c( "b","a","bc","c",#tax#
				"b","b","a",#scom#
				"","","",#lh#
				"a","a","b","a","a", #loc#
				"b","a", ""	) #mat & bonus
xvals <- c(seq(from=0,to=1,length.out=c(4+3+2+3+5+1) ))#
xlab <- c("bacteria","myc fungi","mixed","other fungi","community","strain","strain mix","annual","both","perennial","root","seed","shoot","v. w/ reprod","v. w/o reprod","outcrosser","selfer","All")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(5,4,1,1))####NOTE THAT SOME OF THESE ARE ONLY SIG AT 0.9#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals,pch=16)#
	points(unlist(flwrD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=flwrE.m -flwrE.se, y1 = flwrE.m +flwrE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m +flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[15:16])/2, sum(xvals[17:18])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsFE)#
	text(xvals,y=-0.2,siggroupsFD,col="gray")#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals,pch=16)#
	points(unlist(germTD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germTE.m -germTE.se, y1 = germTE.m +germTE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m +germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[15:16])/2, sum(xvals[17:18])/2 ),lty=3 )#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germPE.m -germPE.se, y1 = germPE.m +germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m +germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[15:16])/2, sum(xvals[17:18])/2 ),lty=3 )#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)
siggroupsFE <- c( "a","ab","ab","b",#tax#
				"","","",#scom#
				"a","ab","b",#lh #all ns if 0.95#
				"a","b","b","ab","ab", #loc#
				"","", ""	) #mat
xvals <- c(seq(from=0,to=1,length.out=c(4+3+2+3+5+1) ))#
xlab <- c("bacteria","myc fungi","mixed","other fungi","community","strain","strain mix","annual","both","perennial","root","seed","shoot","v. w/ reprod","v. w/o reprod","outcrosser","selfer","All")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(5,4,1,1))####NOTE THAT SOME OF THESE ARE ONLY SIG AT 0.9#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals,pch=16)#
	points(unlist(flwrD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=flwrE.m -flwrE.se, y1 = flwrE.m +flwrE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m +flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[15:16])/2, sum(xvals[17:18])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsFE)#
	text(xvals,y=-0.2,siggroupsFD,col="gray")#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals,pch=16)#
	points(unlist(germTD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germTE.m -germTE.se, y1 = germTE.m +germTE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m +germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[15:16])/2, sum(xvals[17:18])/2 ),lty=3 )#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germPE.m -germPE.se, y1 = germPE.m +germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m +germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[15:16])/2, sum(xvals[17:18])/2 ),lty=3 )#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)
summary(flowerbiscom)
summary(flowerDbiscom)
siggroupsGpE <- c( "b","c","a","a",#tax#
				"a","ab","b",#
				"","","",#lh#
				"a","a","b","a","ab", #loc#
				"","", ""	) #mat#
siggroupsGpD <- c( "b","a","bc","c",#tax#
				"b","b","a",#scom#
				"","","",#lh#
				"a","a","b","a","a", #loc#
				"b","a", ""	) #mat & bonus
xvals <- c(seq(from=0,to=1,length.out=c(4+3+2+3+5+1) ))#
xlab <- c("bacteria","myc fungi","mixed","other fungi","community","strain","strain mix","annual","both","perennial","root","seed","shoot","v. w/ reprod","v. w/o reprod","outcrosser","selfer","All")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(5,4,1,1))####NOTE THAT SOME OF THESE ARE ONLY SIG AT 0.9#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals,pch=16)#
	points(unlist(flwrD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=flwrE.m -flwrE.se, y1 = flwrE.m +flwrE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m +flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[15:16])/2, sum(xvals[17:18])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsFE)#
	text(xvals,y=-0.2,siggroupsFD,col="gray")#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals,pch=16)#
	points(unlist(germTD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germTE.m -germTE.se, y1 = germTE.m +germTE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m +germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[15:16])/2, sum(xvals[17:18])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsGtE)#
	text(xvals,y=-0.2,siggroupsGtD,col="gray")#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germPE.m -germPE.se, y1 = germPE.m +germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m +germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[15:16])/2, sum(xvals[17:18])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsGpE)#
	text(xvals,y=-0.2,siggroupsGpD,col="gray")#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)
summary(flowerDbitax)
summary(flowerDbilh)
summary(flowerbilh)
summary(germtimebilh)
summary(germtimebimat)
summary(germtimeDbimat)
summary(germprbDbilh)
summary(germprbbilh)
summary(germprbDbimat)
#fill in from model results#
siggroupsFE <- c( "a","ab","ab","b",#tax#
				"","","",#scom#
				"a","ab","b",#lh #all ns if 0.95#
				"a","b","b","ab","ab", #loc#
				"","", ""	) #mat#
siggroupsFD <- c("b","ab","a","ab",#tax#
				"a","b","b",#scom;  looks backwards!#
				"","","",#lh#
				"a","b","a","a","a", #loc#
				"","", ""	) #mat#
siggroupsGtE <- c( "b","a","c","b",#tax  #at .95; other fungi can'd be dist from mixed#
				"","","",#scom#
				"b","ab","a",#lh#
				"","","","","", #loc#
				"","", ""	) #mat#
siggroupsGtD <- c( "b","c","a","a",#tax#
				"a","b","b",#scom ##
				"","","",#lh#
				"a","a","b","a","b",#loc#
				"","", ""	) #mat#
siggroupsGpE <- c( "b","c","a","a",#tax#
				"a","ab","b",#
				"","","",#lh#
				"a","a","b","a","ab", #loc#
				"","", ""	) #mat#
siggroupsGpD <- c( "b","a","bc","c",#tax#
				"b","b","a",#scom#
				"","","",#lh#
				"a","a","b","a","a", #loc#
				"b","a", ""	) #mat & bonus; mat looks backwards#
#
pdf("means_ses_and prelim fitted diffs from binom.pdf",height=6,width=5)#
xvals <- c(seq(from=0,to=1,length.out=c(4+3+2+3+5+1) ))#
xlab <- c("bacteria","myc fungi","mixed","other fungi","community","strain","strain mix","annual","both","perennial","root","seed","shoot","v. w/ reprod","v. w/o reprod","outcrosser","selfer","All")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(5,4,1,1))####NOTE THAT SOME OF THESE ARE ONLY SIG AT 0.9#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals,pch=16)#
	points(unlist(flwrD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=flwrE.m -flwrE.se, y1 = flwrE.m +flwrE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m +flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[15:16])/2, sum(xvals[17:18])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsFE)#
	text(xvals,y=-0.2,siggroupsFD,col="gray")#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals,pch=16)#
	points(unlist(germTD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germTE.m -germTE.se, y1 = germTE.m +germTE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m +germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[15:16])/2, sum(xvals[17:18])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsGtE)#
	text(xvals,y=-0.2,siggroupsGtD,col="gray")#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germPE.m -germPE.se, y1 = germPE.m +germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m +germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[15:16])/2, sum(xvals[17:18])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsGpE)#
	text(xvals,y=-0.2,siggroupsGpD,col="gray")#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)#
dev.off()
#fill in from model results#
siggroupsFE <- c( "a","ab","ab","b",#tax#
				"","","",#scom#
				"a","ab","b",#lh #all ns if 0.95#
				"a","b","b","ab","ab", #loc#
				"","", ""	) #mat#
siggroupsFD <- c("b","ab","a","ab",#tax#
				"a","b","b",#scom;  looks backwards!#
				"","","",#lh#
				"a","b","a","a","a", #loc#
				"","", ""	) #mat#
siggroupsGtE <- c( "b","a","c","b",#tax  #at .95; other fungi can'd be dist from mixed#
				"","","",#scom#
				"b","ab","a",#lh#
				"","","","","", #loc#
				"","", ""	) #mat#
siggroupsGtD <- c( "b","c","a","a",#tax#
				"a","b","b",#scom ##
				"","","",#lh#
				"a","a","b","a","b",#loc#
				"","", ""	) #mat#
siggroupsGpE <- c( "b","c","a","a",#tax#
				"a","ab","b",#
				"","","",#lh#
				"a","a","b","a","ab", #loc#
				"","", ""	) #mat#
siggroupsGpD <- c( "b","a","bc","c",#tax#
				"b","b","a",#scom#
				"","","",#lh#
				"a","a","b","a","a", #loc#
				"b","a", ""	) #mat & bonus; mat looks backwards#
#
pdf("means_ses_and prelim fitted diffs from binom.pdf",height=6,width=5)#
xvals <- c(seq(from=0,to=1,length.out=c(4+3+2+3+5+1) ))#
xlab <- c("bacteria","myc fungi","mixed","other fungi","community","strain","strain mix","annual","both","perennial","root","seed","shoot","v. w/ reprod","v. w/o reprod","outcrosser","selfer","All")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(5,4,1,1))####NOTE THAT SOME OF THESE ARE ONLY SIG AT 0.9#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals,pch=16)#
	points(unlist(flwrD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=flwrE.m -flwrE.se, y1 = flwrE.m +flwrE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m +flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[15:16])/2, sum(xvals[17:18])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsFE)#
	text(xvals,y=-0.2,siggroupsFD,col="gray")#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals,pch=16)#
	points(unlist(germTD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germTE.m -germTE.se, y1 = germTE.m +germTE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m +germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[15:16])/2, sum(xvals[17:18])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsGtE)#
	text(xvals,y=-0.2,siggroupsGtD,col="gray")#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germPE.m -germPE.se, y1 = germPE.m +germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m +germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[15:16])/2, sum(xvals[17:18])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsGpE)#
	text(xvals,y=-0.2,siggroupsGpD,col="gray")#
	mtext(side=3,"germination probability")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[13],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)#
dev.off()
pdf("means_ses_and prelim fitted diffs from binom.pdf",height=6,width=5)#
xvals <- c(seq(from=0,to=1,length.out=c(4+3+2+3+5+1) ))#
xlab <- c("bacteria","myc fungi","mixed","other fungi","community","strain","strain mix","annual","both","perennial","root","seed","shoot","v. w/ reprod","v. w/o reprod","outcrosser","selfer","All")#
par(mfrow=c(3,1))#
par(mar=c(1,0,1,0))#
par(oma=c(5,4,1,1))####NOTE THAT SOME OF THESE ARE ONLY SIG AT 0.9#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(flwrE.m)~xvals,pch=16)#
	points(unlist(flwrD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=flwrE.m -flwrE.se, y1 = flwrE.m +flwrE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=flwrD.m -flwrD.se, y1 = flwrD.m +flwrD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[15:16])/2, sum(xvals[17:18])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsFE)#
	text(xvals,y=-0.2,siggroupsFD,col="gray")#
	mtext(side=3,"flowering time")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[12],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(germTE.m)~xvals,pch=16)#
	points(unlist(germTD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germTE.m -germTE.se, y1 = germTE.m +germTE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germTD.m -germTD.se, y1 = germTD.m +germTD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[15:16])/2, sum(xvals[17:18])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsGtE)#
	text(xvals,y=-0.2,siggroupsGtD,col="gray")#
	mtext(side=3,"germination time")#
	mtext(side=2,"Prb of observing Effect",line=2)#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[12],y=1.2,c("Earlier","Delay"),fill=c("black","gray"),bty="n")#
plot(c(0,1)~I(c(0,1)),pch=NA,xlab="",ylab="",bty="n",xaxt="n",ylim=c(-0.2,1.2),yaxt="n")#
	points(unlist(germPE.m)~xvals,pch=16)#
	points(unlist(germPD.m)~I(xvals+0.01),pch=16,col="gray")#
	arrows(x0=xvals , y0=germPE.m -germPE.se, y1 = germPE.m +germPE.se,length=0     )#
	arrows(x0=xvals+0.01 , y0=germPD.m -germPD.se, y1 = germPD.m +germPD.se,length=0  ,col="gray"   )#
	abline(v= c(sum(xvals[4:5])/2, sum(xvals[7:8])/2, sum(xvals[10:11])/2, #
				sum(xvals[15:16])/2, sum(xvals[17:18])/2 ),lty=3 )#
	text(xvals,y=1.2,siggroupsGpE)#
	text(xvals,y=-0.2,siggroupsGpD,col="gray")#
	mtext(side=3,"germination probability")#
	axis(side=2,at=c(0,0.25,0.5,0.75,1),labels=c(0," ",0.5, " ",1))#
legend(xvals[12],y=1.2,c("Narrowed","Expanded"),fill=c("black","gray"),bty="n")#
axis(side=1,at=xvals, labels=xlab,las=2)#
dev.off()
.75*.5
1-.75*.5
.76*.47
1-.76*.47
dim(split_recs)
